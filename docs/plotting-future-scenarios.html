<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 18 Plotting future scenarios | Tree phenology Analysis with R</title>
  <meta name="description" content="Chapter 18 Plotting future scenarios | Tree phenology Analysis with R" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 18 Plotting future scenarios | Tree phenology Analysis with R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 18 Plotting future scenarios | Tree phenology Analysis with R" />
  
  
  

<meta name="author" content="Jacqueline Wingen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="making-cmip5-scenarios-with-the-climatewizard.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tree phenology Analysis with R</a></li>
<li><a href="index.html"><img src="images/chillR_hexSticker.png" width="75%"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#learning-goals"><i class="fa fa-check"></i><b>1.1</b> Learning goals</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tools.html"><a href="tools.html"><i class="fa fa-check"></i><b>2</b> Tools</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tools.html"><a href="tools.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="tools.html"><a href="tools.html#git-and-github"><i class="fa fa-check"></i><b>2.2</b> Git and Github</a></li>
<li class="chapter" data-level="2.3" data-path="tools.html"><a href="tools.html#rmarkdown"><i class="fa fa-check"></i><b>2.3</b> Rmarkdown</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tree-dormancy.html"><a href="tree-dormancy.html"><i class="fa fa-check"></i><b>3</b> Tree dormancy</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tree-dormancy.html"><a href="tree-dormancy.html#learning-goals-1"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="tree-dormancy.html"><a href="tree-dormancy.html#introduction-to-dormancy"><i class="fa fa-check"></i><b>3.2</b> Introduction to dormancy</a></li>
<li class="chapter" data-level="3.3" data-path="tree-dormancy.html"><a href="tree-dormancy.html#dormancy-physiology"><i class="fa fa-check"></i><b>3.3</b> Dormancy physiology</a></li>
<li class="chapter" data-level="3.4" data-path="tree-dormancy.html"><a href="tree-dormancy.html#experimental-and-statistical-determination-of-chilling-and-forcing-periods"><i class="fa fa-check"></i><b>3.4</b> Experimental and statistical determination of chilling and forcing periods</a></li>
<li class="chapter" data-level="3.5" data-path="tree-dormancy.html"><a href="tree-dormancy.html#phenology-record-and-bbch-scale"><i class="fa fa-check"></i><b>3.5</b> Phenology record and BBCH scale</a></li>
<li class="chapter" data-level="3.6" data-path="tree-dormancy.html"><a href="tree-dormancy.html#excercises-on-tree-dormancy"><i class="fa fa-check"></i><b>3.6</b> <code>Excercises</code> on tree dormancy</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html"><i class="fa fa-check"></i><b>4</b> Climate change and impact projection</a>
<ul>
<li class="chapter" data-level="4.1" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#the-drivers-of-climate-change"><i class="fa fa-check"></i><b>4.1</b> The drivers of climate change</a></li>
<li class="chapter" data-level="4.2" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#whats-already-known"><i class="fa fa-check"></i><b>4.2</b> What’s already known</a></li>
<li class="chapter" data-level="4.3" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#future-scenarios"><i class="fa fa-check"></i><b>4.3</b> Future scenarios</a></li>
<li class="chapter" data-level="4.4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#impact-projections-approaches"><i class="fa fa-check"></i><b>4.4</b> Impact projections approaches</a></li>
<li class="chapter" data-level="4.5" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#exercises-on-climate-change"><i class="fa fa-check"></i><b>4.5</b> <code>Exercises</code> on climate change</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html"><i class="fa fa-check"></i><b>5</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="5.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-oman"><i class="fa fa-check"></i><b>5.2</b> Winter chill in Oman</a></li>
<li class="chapter" data-level="5.3" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-sensitivity"><i class="fa fa-check"></i><b>5.3</b> Chill model sensitivity</a></li>
<li class="chapter" data-level="5.4" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-california"><i class="fa fa-check"></i><b>5.4</b> Winter chill in California</a></li>
<li class="chapter" data-level="5.5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-ratios"><i class="fa fa-check"></i><b>5.5</b> Winter chill ratios</a></li>
<li class="chapter" data-level="5.6" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#a-global-projection-of-future-winter-chill"><i class="fa fa-check"></i><b>5.6</b> A global projection of future winter chill</a></li>
<li class="chapter" data-level="5.7" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-germany"><i class="fa fa-check"></i><b>5.7</b> Winter chill in Germany</a></li>
<li class="chapter" data-level="5.8" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-tunisia"><i class="fa fa-check"></i><b>5.8</b> Winter chill in Tunisia</a></li>
<li class="chapter" data-level="5.9" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-chile"><i class="fa fa-check"></i><b>5.9</b> Winter chill in Chile</a></li>
<li class="chapter" data-level="5.10" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-patagonia"><i class="fa fa-check"></i><b>5.10</b> Chill projection for Patagonia</a></li>
<li class="chapter" data-level="5.11" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-comparison"><i class="fa fa-check"></i><b>5.11</b> Chill model comparison</a></li>
<li class="chapter" data-level="5.12" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-all-of-tunisia"><i class="fa fa-check"></i><b>5.12</b> Chill projection for all of Tunisia</a></li>
<li class="chapter" data-level="5.13" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#revisiting-chill-accumulation-in-oman"><i class="fa fa-check"></i><b>5.13</b> Revisiting chill accumulation in Oman</a></li>
<li class="chapter" data-level="5.14" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#exercises-on-past-chill-projections"><i class="fa fa-check"></i><b>5.14</b> <code>Exercises</code> on past chill projections</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="manual-chill.html"><a href="manual-chill.html"><i class="fa fa-check"></i><b>6</b> Manual chill</a>
<ul>
<li class="chapter" data-level="6.1" data-path="manual-chill.html"><a href="manual-chill.html#learning-goals-3"><i class="fa fa-check"></i><b>6.1</b> Learning goals</a></li>
<li class="chapter" data-level="6.2" data-path="manual-chill.html"><a href="manual-chill.html#chilling-hours-calculation-using-chillr"><i class="fa fa-check"></i><b>6.2</b> Chilling hours calculation using chillR</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="manual-chill.html"><a href="manual-chill.html#data-requirements"><i class="fa fa-check"></i><b>6.2.1</b> <strong>Data Requirements</strong></a></li>
<li class="chapter" data-level="6.2.2" data-path="manual-chill.html"><a href="manual-chill.html#loading-and-preparing-data"><i class="fa fa-check"></i><b>6.2.2</b> Loading and Preparing Data</a></li>
<li class="chapter" data-level="6.2.3" data-path="manual-chill.html"><a href="manual-chill.html#manual-calculation-of-chilling-hours"><i class="fa fa-check"></i><b>6.2.3</b> <strong>Manual Calculation of Chilling Hours</strong></a></li>
<li class="chapter" data-level="6.2.4" data-path="manual-chill.html"><a href="manual-chill.html#automation-with-functions"><i class="fa fa-check"></i><b>6.2.4</b> Automation with Functions</a></li>
<li class="chapter" data-level="6.2.5" data-path="manual-chill.html"><a href="manual-chill.html#application-example"><i class="fa fa-check"></i><b>6.2.5</b> Application Example</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="manual-chill.html"><a href="manual-chill.html#exercises-on-basic-chill-modeling"><i class="fa fa-check"></i><b>6.3</b> <code>Exercises</code> on basic chill modeling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chill.html"><a href="chill.html"><i class="fa fa-check"></i><b>7</b> Chill</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chill.html"><a href="chill.html#learning-goals-4"><i class="fa fa-check"></i><b>7.1</b> Learning goals</a></li>
<li class="chapter" data-level="7.2" data-path="chill.html"><a href="chill.html#chilling_hours-function"><i class="fa fa-check"></i><b>7.2</b> <code>Chilling_Hours()</code> function</a></li>
<li class="chapter" data-level="7.3" data-path="chill.html"><a href="chill.html#utah-model"><i class="fa fa-check"></i><b>7.3</b> Utah Model</a></li>
<li class="chapter" data-level="7.4" data-path="chill.html"><a href="chill.html#creating-custom-chill-models-with-step_model"><i class="fa fa-check"></i><b>7.4</b> Creating Custom Chill Models with <code>step_model()</code></a></li>
<li class="chapter" data-level="7.5" data-path="chill.html"><a href="chill.html#dynamic-model"><i class="fa fa-check"></i><b>7.5</b> Dynamic model</a></li>
<li class="chapter" data-level="7.6" data-path="chill.html"><a href="chill.html#chilling-and-tempresponse-functions"><i class="fa fa-check"></i><b>7.6</b> <code>Chilling</code> and <code>tempResponse</code> functions</a></li>
<li class="chapter" data-level="7.7" data-path="chill.html"><a href="chill.html#exercises-on-chill-models"><i class="fa fa-check"></i><b>7.7</b> <code>Exercises</code> on chill models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html"><i class="fa fa-check"></i><b>8</b> Making hourly temperatures</a>
<ul>
<li class="chapter" data-level="8.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#learning-goals-5"><i class="fa fa-check"></i><b>8.1</b> Learning goals</a></li>
<li class="chapter" data-level="8.2" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#generating-hourly-temperatures"><i class="fa fa-check"></i><b>8.2</b> Generating hourly temperatures</a></li>
<li class="chapter" data-level="8.3" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#idealized-daily-temperature-curves"><i class="fa fa-check"></i><b>8.3</b> Idealized daily temperature curves</a></li>
<li class="chapter" data-level="8.4" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#empirical-daily-temperature-curves"><i class="fa fa-check"></i><b>8.4</b> Empirical daily temperature curves</a></li>
<li class="chapter" data-level="8.5" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#exercises-on-hourly-temperatures"><i class="fa fa-check"></i><b>8.5</b> <code>Exercises</code> on hourly temperatures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html"><i class="fa fa-check"></i><b>9</b> Some useful tools in R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#learning-goals-6"><i class="fa fa-check"></i><b>9.1</b> Learning goals</a></li>
<li class="chapter" data-level="9.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#an-evolving-language---and-a-lifelong-learning-process"><i class="fa fa-check"></i><b>9.2</b> An evolving language - and a lifelong learning process</a></li>
<li class="chapter" data-level="9.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyverse"><i class="fa fa-check"></i><b>9.3</b> The <code>tidyverse</code></a></li>
<li class="chapter" data-level="9.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-ggplot2-package"><i class="fa fa-check"></i><b>9.4</b> The <code>ggplot2</code> package</a></li>
<li class="chapter" data-level="9.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tibble-package"><i class="fa fa-check"></i><b>9.5</b> The <code>tibble</code> package</a></li>
<li class="chapter" data-level="9.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-magrittr-package---pipes"><i class="fa fa-check"></i><b>9.6</b> The <code>magrittr</code> package - pipes</a></li>
<li class="chapter" data-level="9.7" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyr-package"><i class="fa fa-check"></i><b>9.7</b> The <code>tidyr</code> package</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_longer"><i class="fa fa-check"></i><b>9.7.1</b> <code>pivot_longer</code></a></li>
<li class="chapter" data-level="9.7.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_wider"><i class="fa fa-check"></i><b>9.7.2</b> <code>pivot_wider</code></a></li>
<li class="chapter" data-level="9.7.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#select"><i class="fa fa-check"></i><b>9.7.3</b> <code>select</code></a></li>
<li class="chapter" data-level="9.7.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#filter"><i class="fa fa-check"></i><b>9.7.4</b> <code>filter</code></a></li>
<li class="chapter" data-level="9.7.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#mutate"><i class="fa fa-check"></i><b>9.7.5</b> <code>mutate</code></a></li>
<li class="chapter" data-level="9.7.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#arrange"><i class="fa fa-check"></i><b>9.7.6</b> <code>arrange</code></a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#loops"><i class="fa fa-check"></i><b>9.8</b> Loops</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#for-loops"><i class="fa fa-check"></i><b>9.8.1</b> <em>For</em> loops</a></li>
<li class="chapter" data-level="9.8.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#while-loops"><i class="fa fa-check"></i><b>9.8.2</b> <em>While</em> loops</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply-functions"><i class="fa fa-check"></i><b>9.9</b> <code>apply</code> functions</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#sapply"><i class="fa fa-check"></i><b>9.9.1</b> <code>sapply</code></a></li>
<li class="chapter" data-level="9.9.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#lapply"><i class="fa fa-check"></i><b>9.9.2</b> <code>lapply</code></a></li>
<li class="chapter" data-level="9.9.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply"><i class="fa fa-check"></i><b>9.9.3</b> <code>apply</code></a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#exercises-on-useful-r-tools"><i class="fa fa-check"></i><b>9.10</b> <code>Exercises</code> on useful R tools</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html"><i class="fa fa-check"></i><b>10</b> Getting temperature data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#learning-goals-for-this-lesson"><i class="fa fa-check"></i><b>10.1</b> Learning goals for this lesson</a></li>
<li class="chapter" data-level="10.2" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#temperature-data-needs"><i class="fa fa-check"></i><b>10.2</b> Temperature data needs</a></li>
<li class="chapter" data-level="10.3" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#the-global-summary-of-the-day-database"><i class="fa fa-check"></i><b>10.3</b> The Global Summary of the Day database</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#actionlist_stations"><i class="fa fa-check"></i><b>10.3.1</b> <code>action=list_stations</code></a></li>
<li class="chapter" data-level="10.3.2" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#actiondownload_weather"><i class="fa fa-check"></i><b>10.3.2</b> <code>action="download_weather"</code></a></li>
<li class="chapter" data-level="10.3.3" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#downloaded-weather-as-action-argument"><i class="fa fa-check"></i><b>10.3.3</b> downloaded weather as <code>action</code> argument</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#exercises-on-getting-temperature-data"><i class="fa fa-check"></i><b>10.4</b> <code>Exercises</code> on getting temperature data</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tree phenology Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-future-scenarios" class="section level1 hasAnchor" number="18">
<h1><span class="header-section-number">Chapter 18</span> Plotting future scenarios<a href="plotting-future-scenarios.html#plotting-future-scenarios" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-goals-for-this-lesson-4" class="section level2 hasAnchor" number="18.1">
<h2><span class="header-section-number">18.1</span> Learning goals for this lesson<a href="plotting-future-scenarios.html#learning-goals-for-this-lesson-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Learn how we can use the <code>ggplot2</code> package to make an appealing illustrations of the chill projection results</li>
</ul>
</div>
<div id="making-attractive-plots" class="section level2 hasAnchor" number="18.2">
<h2><span class="header-section-number">18.2</span> Making attractive plots<a href="plotting-future-scenarios.html#making-attractive-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The default function in <code>chillR</code> can generate plots for climate impact projections, but its design may not always meet user preferences. The current version of the <code>plot_climate_scenarios</code> function offers limited options for customizing the plot’s appearance. This limitation is primarily due to the function being written before extensive use of <code>ggplot2</code>.</p>
<p>In this chapter, a similar figure will be recreated using <code>ggplot</code>, offering greater flexibility and customization. <a href="https://scholar.google.de/citations?hl=de&amp;user=ibSma_AAAAAJ">Eduardo Fernandez</a> has already developed a function for this, which is included in <code>chillR</code>. However, the process will be built up gradually here to demonstrate how complex plots can be constructed using <code>ggplot</code>. Eduardo’s code has been slightly modified for clarity, but the core ideas remain his.</p>
<p>First, all necessary packages will be installed and loaded. New packages introduced here are <code>ggpmisc</code> and <code>patchwork</code>.</p>
<p>Building on prior work, the outputs produced in the chapters <strong><em>Historic Temperature Scenarios</em></strong> and <strong><em>Making CMIP6 Scenarios</em></strong> will also need to be loaded.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="plotting-future-scenarios.html#cb281-1" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb281-2"><a href="plotting-future-scenarios.html#cb281-2" tabindex="-1"></a><span class="fu">library</span>(chillR)</span>
<span id="cb281-3"><a href="plotting-future-scenarios.html#cb281-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb281-4"><a href="plotting-future-scenarios.html#cb281-4" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span>
<span id="cb281-5"><a href="plotting-future-scenarios.html#cb281-5" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb281-6"><a href="plotting-future-scenarios.html#cb281-6" tabindex="-1"></a></span>
<span id="cb281-7"><a href="plotting-future-scenarios.html#cb281-7" tabindex="-1"></a>chill_hist_scenario_list <span class="ot">&lt;-</span> <span class="fu">load_temperature_scenarios</span>(<span class="st">&quot;data&quot;</span>,</span>
<span id="cb281-8"><a href="plotting-future-scenarios.html#cb281-8" tabindex="-1"></a>                                                       <span class="st">&quot;Bonn_hist_chill_305_59&quot;</span>)</span>
<span id="cb281-9"><a href="plotting-future-scenarios.html#cb281-9" tabindex="-1"></a>actual_chill <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;data/Bonn_observed_chill_305_59.csv&quot;</span>)</span>
<span id="cb281-10"><a href="plotting-future-scenarios.html#cb281-10" tabindex="-1"></a></span>
<span id="cb281-11"><a href="plotting-future-scenarios.html#cb281-11" tabindex="-1"></a>chill_future_scenario_list <span class="ot">&lt;-</span> <span class="fu">load_temperature_scenarios</span>(<span class="st">&quot;data/future_climate&quot;</span>,<span class="st">&quot;Bonn_futurechill_305_59&quot;</span>)</span>
<span id="cb281-12"><a href="plotting-future-scenarios.html#cb281-12" tabindex="-1"></a></span>
<span id="cb281-13"><a href="plotting-future-scenarios.html#cb281-13" tabindex="-1"></a>chills <span class="ot">&lt;-</span> <span class="fu">make_climate_scenario</span>(</span>
<span id="cb281-14"><a href="plotting-future-scenarios.html#cb281-14" tabindex="-1"></a>  chill_hist_scenario_list,</span>
<span id="cb281-15"><a href="plotting-future-scenarios.html#cb281-15" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">&quot;Historic&quot;</span>,</span>
<span id="cb281-16"><a href="plotting-future-scenarios.html#cb281-16" tabindex="-1"></a>  <span class="at">historic_data =</span> actual_chill,</span>
<span id="cb281-17"><a href="plotting-future-scenarios.html#cb281-17" tabindex="-1"></a>  <span class="at">time_series =</span> <span class="cn">TRUE</span>)</span>
<span id="cb281-18"><a href="plotting-future-scenarios.html#cb281-18" tabindex="-1"></a></span>
<span id="cb281-19"><a href="plotting-future-scenarios.html#cb281-19" tabindex="-1"></a>SSPs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssp126&quot;</span>, <span class="st">&quot;ssp245&quot;</span>, <span class="st">&quot;ssp370&quot;</span>, <span class="st">&quot;ssp585&quot;</span>)</span>
<span id="cb281-20"><a href="plotting-future-scenarios.html#cb281-20" tabindex="-1"></a>Times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>)</span>
<span id="cb281-21"><a href="plotting-future-scenarios.html#cb281-21" tabindex="-1"></a></span>
<span id="cb281-22"><a href="plotting-future-scenarios.html#cb281-22" tabindex="-1"></a>list_ssp <span class="ot">&lt;-</span> </span>
<span id="cb281-23"><a href="plotting-future-scenarios.html#cb281-23" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="fu">names</span>(chill_future_scenario_list), <span class="st">&#39;</span><span class="sc">\\</span><span class="st">.&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb281-24"><a href="plotting-future-scenarios.html#cb281-24" tabindex="-1"></a>  <span class="fu">map</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb281-25"><a href="plotting-future-scenarios.html#cb281-25" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb281-26"><a href="plotting-future-scenarios.html#cb281-26" tabindex="-1"></a></span>
<span id="cb281-27"><a href="plotting-future-scenarios.html#cb281-27" tabindex="-1"></a>list_gcm <span class="ot">&lt;-</span></span>
<span id="cb281-28"><a href="plotting-future-scenarios.html#cb281-28" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="fu">names</span>(chill_future_scenario_list), <span class="st">&#39;</span><span class="sc">\\</span><span class="st">.&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb281-29"><a href="plotting-future-scenarios.html#cb281-29" tabindex="-1"></a>  <span class="fu">map</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb281-30"><a href="plotting-future-scenarios.html#cb281-30" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb281-31"><a href="plotting-future-scenarios.html#cb281-31" tabindex="-1"></a></span>
<span id="cb281-32"><a href="plotting-future-scenarios.html#cb281-32" tabindex="-1"></a>list_time <span class="ot">&lt;-</span></span>
<span id="cb281-33"><a href="plotting-future-scenarios.html#cb281-33" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="fu">names</span>(chill_future_scenario_list), <span class="st">&#39;</span><span class="sc">\\</span><span class="st">.&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb281-34"><a href="plotting-future-scenarios.html#cb281-34" tabindex="-1"></a>  <span class="fu">map</span>(<span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb281-35"><a href="plotting-future-scenarios.html#cb281-35" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb281-36"><a href="plotting-future-scenarios.html#cb281-36" tabindex="-1"></a></span>
<span id="cb281-37"><a href="plotting-future-scenarios.html#cb281-37" tabindex="-1"></a></span>
<span id="cb281-38"><a href="plotting-future-scenarios.html#cb281-38" tabindex="-1"></a><span class="cf">for</span>(SSP <span class="cf">in</span> SSPs)</span>
<span id="cb281-39"><a href="plotting-future-scenarios.html#cb281-39" tabindex="-1"></a>  <span class="cf">for</span>(Time <span class="cf">in</span> Times)</span>
<span id="cb281-40"><a href="plotting-future-scenarios.html#cb281-40" tabindex="-1"></a>    {</span>
<span id="cb281-41"><a href="plotting-future-scenarios.html#cb281-41" tabindex="-1"></a>    </span>
<span id="cb281-42"><a href="plotting-future-scenarios.html#cb281-42" tabindex="-1"></a>    <span class="co"># find all scenarios for the ssp and time</span></span>
<span id="cb281-43"><a href="plotting-future-scenarios.html#cb281-43" tabindex="-1"></a>    chill <span class="ot">&lt;-</span> chill_future_scenario_list[list_ssp <span class="sc">==</span> SSP <span class="sc">&amp;</span> list_time <span class="sc">==</span> Time]</span>
<span id="cb281-44"><a href="plotting-future-scenarios.html#cb281-44" tabindex="-1"></a>    <span class="fu">names</span>(chill) <span class="ot">&lt;-</span> list_gcm[list_ssp <span class="sc">==</span> SSP <span class="sc">&amp;</span> list_time <span class="sc">==</span> Time]</span>
<span id="cb281-45"><a href="plotting-future-scenarios.html#cb281-45" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">&quot;ssp126&quot;</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">&quot;SSP1&quot;</span></span>
<span id="cb281-46"><a href="plotting-future-scenarios.html#cb281-46" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">&quot;ssp245&quot;</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">&quot;SSP2&quot;</span></span>
<span id="cb281-47"><a href="plotting-future-scenarios.html#cb281-47" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">&quot;ssp370&quot;</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">&quot;SSP3&quot;</span></span>
<span id="cb281-48"><a href="plotting-future-scenarios.html#cb281-48" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">&quot;ssp585&quot;</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">&quot;SSP5&quot;</span>    </span>
<span id="cb281-49"><a href="plotting-future-scenarios.html#cb281-49" tabindex="-1"></a>    <span class="cf">if</span>(Time <span class="sc">==</span> <span class="st">&quot;2050&quot;</span>) Time_caption <span class="ot">&lt;-</span> <span class="st">&quot;2050&quot;</span></span>
<span id="cb281-50"><a href="plotting-future-scenarios.html#cb281-50" tabindex="-1"></a>    <span class="cf">if</span>(Time <span class="sc">==</span> <span class="st">&quot;2085&quot;</span>) Time_caption <span class="ot">&lt;-</span> <span class="st">&quot;2085&quot;</span></span>
<span id="cb281-51"><a href="plotting-future-scenarios.html#cb281-51" tabindex="-1"></a>    chills <span class="ot">&lt;-</span> chill <span class="sc">%&gt;%</span> </span>
<span id="cb281-52"><a href="plotting-future-scenarios.html#cb281-52" tabindex="-1"></a>      <span class="fu">make_climate_scenario</span>(</span>
<span id="cb281-53"><a href="plotting-future-scenarios.html#cb281-53" tabindex="-1"></a>        <span class="at">caption =</span> <span class="fu">c</span>(SSPcaption,</span>
<span id="cb281-54"><a href="plotting-future-scenarios.html#cb281-54" tabindex="-1"></a>                    Time_caption),</span>
<span id="cb281-55"><a href="plotting-future-scenarios.html#cb281-55" tabindex="-1"></a>        <span class="at">add_to =</span> chills)</span>
<span id="cb281-56"><a href="plotting-future-scenarios.html#cb281-56" tabindex="-1"></a>}</span></code></pre></div>
<p>To work effectively with <code>ggplot</code>, data needs to be arranged in a single <code>data.frame</code> rather than the list format currently used for storing projection data. Each row of the <code>data.frame</code> should include details such as the GCM, SSP, and Year. The most straightforward way to achieve this is by iterating through the elements of the chill projection list, extracting the necessary information, and combining it into a new, long-format <code>data.frame</code>.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="plotting-future-scenarios.html#cb282-1" tabindex="-1"></a><span class="co"># We&#39;ll first process the past scenarios (element 1 of the chills list).</span></span>
<span id="cb282-2"><a href="plotting-future-scenarios.html#cb282-2" tabindex="-1"></a><span class="co"># Within the data element, we have a list of multiple data.frames for</span></span>
<span id="cb282-3"><a href="plotting-future-scenarios.html#cb282-3" tabindex="-1"></a><span class="co"># the various past scenarios.</span></span>
<span id="cb282-4"><a href="plotting-future-scenarios.html#cb282-4" tabindex="-1"></a><span class="co"># Using a &#39;for&#39; loop, we cycle through all these data.frames.</span></span>
<span id="cb282-5"><a href="plotting-future-scenarios.html#cb282-5" tabindex="-1"></a></span>
<span id="cb282-6"><a href="plotting-future-scenarios.html#cb282-6" tabindex="-1"></a><span class="cf">for</span>(nam <span class="cf">in</span> <span class="fu">names</span>(chills[[<span class="dv">1</span>]]<span class="sc">$</span>data))</span>
<span id="cb282-7"><a href="plotting-future-scenarios.html#cb282-7" tabindex="-1"></a>  {</span>
<span id="cb282-8"><a href="plotting-future-scenarios.html#cb282-8" tabindex="-1"></a>   <span class="co"># Extract the data frame.</span></span>
<span id="cb282-9"><a href="plotting-future-scenarios.html#cb282-9" tabindex="-1"></a>   ch <span class="ot">&lt;-</span> chills[[<span class="dv">1</span>]]<span class="sc">$</span>data[[nam]]</span>
<span id="cb282-10"><a href="plotting-future-scenarios.html#cb282-10" tabindex="-1"></a>   <span class="co"># Add columns for the new information we have to add and fill them.</span></span>
<span id="cb282-11"><a href="plotting-future-scenarios.html#cb282-11" tabindex="-1"></a>   ch[,<span class="st">&quot;GCM&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb282-12"><a href="plotting-future-scenarios.html#cb282-12" tabindex="-1"></a>   ch[,<span class="st">&quot;SSP&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb282-13"><a href="plotting-future-scenarios.html#cb282-13" tabindex="-1"></a>   ch[,<span class="st">&quot;Year&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(nam)</span>
<span id="cb282-14"><a href="plotting-future-scenarios.html#cb282-14" tabindex="-1"></a>   </span>
<span id="cb282-15"><a href="plotting-future-scenarios.html#cb282-15" tabindex="-1"></a>   <span class="co"># Now check if this is the first time we&#39;ve gone through this loop.</span></span>
<span id="cb282-16"><a href="plotting-future-scenarios.html#cb282-16" tabindex="-1"></a>   <span class="co"># If this is the first time, the ch data.frame becomes the output</span></span>
<span id="cb282-17"><a href="plotting-future-scenarios.html#cb282-17" tabindex="-1"></a>   <span class="co"># object (past_simulated).</span></span>
<span id="cb282-18"><a href="plotting-future-scenarios.html#cb282-18" tabindex="-1"></a>   <span class="co"># If it is not the first time (&#39;else&#39;), we add the current data.frame</span></span>
<span id="cb282-19"><a href="plotting-future-scenarios.html#cb282-19" tabindex="-1"></a>   <span class="co"># to the &#39;past_simulated&#39; object</span></span>
<span id="cb282-20"><a href="plotting-future-scenarios.html#cb282-20" tabindex="-1"></a>  <span class="cf">if</span>(nam <span class="sc">==</span> <span class="fu">names</span>(chills[[<span class="dv">1</span>]]<span class="sc">$</span>data)[<span class="dv">1</span>])</span>
<span id="cb282-21"><a href="plotting-future-scenarios.html#cb282-21" tabindex="-1"></a>    past_simulated <span class="ot">&lt;-</span> ch <span class="cf">else</span></span>
<span id="cb282-22"><a href="plotting-future-scenarios.html#cb282-22" tabindex="-1"></a>      past_simulated <span class="ot">&lt;-</span> <span class="fu">rbind</span>(past_simulated,</span>
<span id="cb282-23"><a href="plotting-future-scenarios.html#cb282-23" tabindex="-1"></a>                              ch)</span>
<span id="cb282-24"><a href="plotting-future-scenarios.html#cb282-24" tabindex="-1"></a>  }</span>
<span id="cb282-25"><a href="plotting-future-scenarios.html#cb282-25" tabindex="-1"></a></span>
<span id="cb282-26"><a href="plotting-future-scenarios.html#cb282-26" tabindex="-1"></a><span class="co"># We add another column called &#39;Scenario&#39; and label all rows as &#39;Historical&#39; </span></span>
<span id="cb282-27"><a href="plotting-future-scenarios.html#cb282-27" tabindex="-1"></a>past_simulated[<span class="st">&quot;Scenario&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Historical&quot;</span></span>
<span id="cb282-28"><a href="plotting-future-scenarios.html#cb282-28" tabindex="-1"></a></span>
<span id="cb282-29"><a href="plotting-future-scenarios.html#cb282-29" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(past_simulated))  <span class="sc">%&gt;%</span></span>
<span id="cb282-30"><a href="plotting-future-scenarios.html#cb282-30" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="st">&quot;striped&quot;</span>, <span class="at">position =</span> <span class="st">&quot;left&quot;</span>,<span class="at">font_size =</span> <span class="dv">14</span>)</span></code></pre></div>
<table class="table table-striped" style="font-size: 14px; color: black; ">
<thead>
<tr>
<th style="text-align:left;">
Season
</th>
<th style="text-align:right;">
End_year
</th>
<th style="text-align:right;">
Season_days
</th>
<th style="text-align:right;">
Data_days
</th>
<th style="text-align:right;">
Perc_complete
</th>
<th style="text-align:right;">
Chill_Portions
</th>
<th style="text-align:right;">
GDH
</th>
<th style="text-align:right;">
Frost_H
</th>
<th style="text-align:left;">
GCM
</th>
<th style="text-align:left;">
SSP
</th>
<th style="text-align:right;">
Year
</th>
<th style="text-align:left;">
Scenario
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2001/2002
</td>
<td style="text-align:right;">
2002
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
81.77681
</td>
<td style="text-align:right;">
3099.912
</td>
<td style="text-align:right;">
728
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:right;">
1980
</td>
<td style="text-align:left;">
Historical
</td>
</tr>
<tr>
<td style="text-align:left;">
2002/2003
</td>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
78.92166
</td>
<td style="text-align:right;">
2626.071
</td>
<td style="text-align:right;">
749
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:right;">
1980
</td>
<td style="text-align:left;">
Historical
</td>
</tr>
<tr>
<td style="text-align:left;">
2003/2004
</td>
<td style="text-align:right;">
2004
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
77.04512
</td>
<td style="text-align:right;">
1126.760
</td>
<td style="text-align:right;">
1035
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:right;">
1980
</td>
<td style="text-align:left;">
Historical
</td>
</tr>
<tr>
<td style="text-align:left;">
2004/2005
</td>
<td style="text-align:right;">
2005
</td>
<td style="text-align:right;">
121
</td>
<td style="text-align:right;">
121
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
81.69922
</td>
<td style="text-align:right;">
1754.188
</td>
<td style="text-align:right;">
734
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:right;">
1980
</td>
<td style="text-align:left;">
Historical
</td>
</tr>
<tr>
<td style="text-align:left;">
2005/2006
</td>
<td style="text-align:right;">
2006
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
85.73869
</td>
<td style="text-align:right;">
2712.910
</td>
<td style="text-align:right;">
549
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:right;">
1980
</td>
<td style="text-align:left;">
Historical
</td>
</tr>
<tr>
<td style="text-align:left;">
2006/2007
</td>
<td style="text-align:right;">
2007
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
80.83104
</td>
<td style="text-align:right;">
2254.430
</td>
<td style="text-align:right;">
727
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:right;">
1980
</td>
<td style="text-align:left;">
Historical
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="plotting-future-scenarios.html#cb283-1" tabindex="-1"></a><span class="co"># We&#39;ll want to add the historic observation too, so let&#39;s simplify the</span></span>
<span id="cb283-2"><a href="plotting-future-scenarios.html#cb283-2" tabindex="-1"></a><span class="co"># pointer to this information for easier use later</span></span>
<span id="cb283-3"><a href="plotting-future-scenarios.html#cb283-3" tabindex="-1"></a></span>
<span id="cb283-4"><a href="plotting-future-scenarios.html#cb283-4" tabindex="-1"></a>past_observed <span class="ot">&lt;-</span> chills[[<span class="dv">1</span>]][[<span class="st">&quot;historic_data&quot;</span>]]</span></code></pre></div>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="plotting-future-scenarios.html#cb284-1" tabindex="-1"></a><span class="fu">head</span>(past_observed)</span></code></pre></div>
<table class="table table-striped" style="font-size: 14px; color: black; ">
<thead>
<tr>
<th style="text-align:left;">
Season
</th>
<th style="text-align:right;">
End_year
</th>
<th style="text-align:right;">
Season_days
</th>
<th style="text-align:right;">
Data_days
</th>
<th style="text-align:right;">
Interpolated_days
</th>
<th style="text-align:right;">
Perc_complete
</th>
<th style="text-align:right;">
Chill_Portions
</th>
<th style="text-align:right;">
GDH
</th>
<th style="text-align:right;">
Frost_H
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1973/1974
</td>
<td style="text-align:right;">
1974
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
85.34065
</td>
<td style="text-align:right;">
2166.376
</td>
<td style="text-align:right;">
498
</td>
</tr>
<tr>
<td style="text-align:left;">
1975/1976
</td>
<td style="text-align:right;">
1976
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
81.50011
</td>
<td style="text-align:right;">
1831.580
</td>
<td style="text-align:right;">
711
</td>
</tr>
<tr>
<td style="text-align:left;">
1976/1977
</td>
<td style="text-align:right;">
1977
</td>
<td style="text-align:right;">
121
</td>
<td style="text-align:right;">
121
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
83.37374
</td>
<td style="text-align:right;">
1892.026
</td>
<td style="text-align:right;">
741
</td>
</tr>
<tr>
<td style="text-align:left;">
1977/1978
</td>
<td style="text-align:right;">
1978
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
78.15125
</td>
<td style="text-align:right;">
2653.059
</td>
<td style="text-align:right;">
830
</td>
</tr>
<tr>
<td style="text-align:left;">
1978/1979
</td>
<td style="text-align:right;">
1979
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
67.29434
</td>
<td style="text-align:right;">
1428.630
</td>
<td style="text-align:right;">
1376
</td>
</tr>
<tr>
<td style="text-align:left;">
1979/1980
</td>
<td style="text-align:right;">
1980
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
82.00353
</td>
<td style="text-align:right;">
2356.143
</td>
<td style="text-align:right;">
702
</td>
</tr>
</tbody>
</table>
<p>The same process is now applied to the future data, transforming it into a long-format <code>data.frame</code> for further analysis and visualization.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="plotting-future-scenarios.html#cb285-1" tabindex="-1"></a><span class="co"># Extract future data</span></span>
<span id="cb285-2"><a href="plotting-future-scenarios.html#cb285-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(chills))</span>
<span id="cb285-3"><a href="plotting-future-scenarios.html#cb285-3" tabindex="-1"></a>  <span class="cf">for</span>(nam <span class="cf">in</span> <span class="fu">names</span>(chills[[i]]<span class="sc">$</span>data))</span>
<span id="cb285-4"><a href="plotting-future-scenarios.html#cb285-4" tabindex="-1"></a>    {ch <span class="ot">&lt;-</span> chills[[i]]<span class="sc">$</span>data[[nam]]</span>
<span id="cb285-5"><a href="plotting-future-scenarios.html#cb285-5" tabindex="-1"></a>     ch[,<span class="st">&quot;GCM&quot;</span>] <span class="ot">&lt;-</span> nam</span>
<span id="cb285-6"><a href="plotting-future-scenarios.html#cb285-6" tabindex="-1"></a>     ch[,<span class="st">&quot;SSP&quot;</span>] <span class="ot">&lt;-</span> chills[[i]]<span class="sc">$</span>caption[<span class="dv">1</span>]</span>
<span id="cb285-7"><a href="plotting-future-scenarios.html#cb285-7" tabindex="-1"></a>     ch[,<span class="st">&quot;Year&quot;</span>] <span class="ot">&lt;-</span> chills[[i]]<span class="sc">$</span>caption[<span class="dv">2</span>]</span>
<span id="cb285-8"><a href="plotting-future-scenarios.html#cb285-8" tabindex="-1"></a>     <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> nam <span class="sc">==</span> <span class="fu">names</span>(chills[[i]]<span class="sc">$</span>data)[<span class="dv">1</span>])</span>
<span id="cb285-9"><a href="plotting-future-scenarios.html#cb285-9" tabindex="-1"></a>       future_data <span class="ot">&lt;-</span> ch <span class="cf">else</span></span>
<span id="cb285-10"><a href="plotting-future-scenarios.html#cb285-10" tabindex="-1"></a>         future_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(future_data,ch)</span>
<span id="cb285-11"><a href="plotting-future-scenarios.html#cb285-11" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="plotting-future-scenarios.html#cb286-1" tabindex="-1"></a><span class="fu">head</span>(future_data)</span></code></pre></div>
<table class="table table-striped" style="font-size: 14px; color: black; ">
<thead>
<tr>
<th style="text-align:left;">
Season
</th>
<th style="text-align:right;">
End_year
</th>
<th style="text-align:right;">
Season_days
</th>
<th style="text-align:right;">
Data_days
</th>
<th style="text-align:right;">
Perc_complete
</th>
<th style="text-align:right;">
Chill_Portions
</th>
<th style="text-align:right;">
GDH
</th>
<th style="text-align:right;">
Frost_H
</th>
<th style="text-align:left;">
GCM
</th>
<th style="text-align:left;">
SSP
</th>
<th style="text-align:left;">
Year
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2001/2002
</td>
<td style="text-align:right;">
2002
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
82.40300
</td>
<td style="text-align:right;">
6711.915
</td>
<td style="text-align:right;">
350
</td>
<td style="text-align:left;">
CMCC-ESM2
</td>
<td style="text-align:left;">
SSP1
</td>
<td style="text-align:left;">
2050
</td>
</tr>
<tr>
<td style="text-align:left;">
2002/2003
</td>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
82.26671
</td>
<td style="text-align:right;">
5935.780
</td>
<td style="text-align:right;">
443
</td>
<td style="text-align:left;">
CMCC-ESM2
</td>
<td style="text-align:left;">
SSP1
</td>
<td style="text-align:left;">
2050
</td>
</tr>
<tr>
<td style="text-align:left;">
2003/2004
</td>
<td style="text-align:right;">
2004
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
85.07761
</td>
<td style="text-align:right;">
3366.613
</td>
<td style="text-align:right;">
599
</td>
<td style="text-align:left;">
CMCC-ESM2
</td>
<td style="text-align:left;">
SSP1
</td>
<td style="text-align:left;">
2050
</td>
</tr>
<tr>
<td style="text-align:left;">
2004/2005
</td>
<td style="text-align:right;">
2005
</td>
<td style="text-align:right;">
121
</td>
<td style="text-align:right;">
121
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
89.65584
</td>
<td style="text-align:right;">
4391.204
</td>
<td style="text-align:right;">
293
</td>
<td style="text-align:left;">
CMCC-ESM2
</td>
<td style="text-align:left;">
SSP1
</td>
<td style="text-align:left;">
2050
</td>
</tr>
<tr>
<td style="text-align:left;">
2005/2006
</td>
<td style="text-align:right;">
2006
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
89.75666
</td>
<td style="text-align:right;">
5904.127
</td>
<td style="text-align:right;">
133
</td>
<td style="text-align:left;">
CMCC-ESM2
</td>
<td style="text-align:left;">
SSP1
</td>
<td style="text-align:left;">
2050
</td>
</tr>
<tr>
<td style="text-align:left;">
2006/2007
</td>
<td style="text-align:right;">
2007
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
84.41638
</td>
<td style="text-align:right;">
4938.089
</td>
<td style="text-align:right;">
413
</td>
<td style="text-align:left;">
CMCC-ESM2
</td>
<td style="text-align:left;">
SSP1
</td>
<td style="text-align:left;">
2050
</td>
</tr>
</tbody>
</table>
<p>The data is now formatted for use with <code>ggplot</code> and includes three metrics: <em>Chill_Portions</em>, <em>GDH</em>, and <em>Frost_H</em>. While a function could be written to handle this process, the current approach focuses on making the code flexible enough to plot all three metrics without significant modifications. This is achieved by defining variables for the metric (<code>metric</code>) and its axis label (<code>axis_label</code>) to allow easy adjustments.</p>
<p>The complex plot to be created cannot be produced as a single <code>ggplot</code> plot. However, this is manageable since multiple plots can be combined into a compound figure using the <code>plot_layout</code> function from the <code>patchwork</code> package.</p>
<p>A challenge when combining plots with shared axes, such as a common y-axis, is that the axes may vary due to differing data ranges across plots. To address this, the <code>range</code> function is used to determine axis extents that are consistent and reasonable for all plots.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="plotting-future-scenarios.html#cb287-1" tabindex="-1"></a>metric <span class="ot">&lt;-</span> <span class="st">&quot;GDH&quot;</span></span>
<span id="cb287-2"><a href="plotting-future-scenarios.html#cb287-2" tabindex="-1"></a>axis_label <span class="ot">&lt;-</span> <span class="st">&quot;Heat (in GDH)&quot;</span></span>
<span id="cb287-3"><a href="plotting-future-scenarios.html#cb287-3" tabindex="-1"></a></span>
<span id="cb287-4"><a href="plotting-future-scenarios.html#cb287-4" tabindex="-1"></a><span class="co"># get extreme values for the axis scale</span></span>
<span id="cb287-5"><a href="plotting-future-scenarios.html#cb287-5" tabindex="-1"></a></span>
<span id="cb287-6"><a href="plotting-future-scenarios.html#cb287-6" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(past_observed[[metric]],</span>
<span id="cb287-7"><a href="plotting-future-scenarios.html#cb287-7" tabindex="-1"></a>             past_simulated[[metric]],</span>
<span id="cb287-8"><a href="plotting-future-scenarios.html#cb287-8" tabindex="-1"></a>             future_data[[metric]])  </span>
<span id="cb287-9"><a href="plotting-future-scenarios.html#cb287-9" tabindex="-1"></a>rng</span></code></pre></div>
<pre><code>## [1]   747.5324 21090.1451</code></pre>
<p>The first plot can now be created, focusing on the past scenarios. This serves as the starting point for visualizing the data:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="plotting-future-scenarios.html#cb289-1" tabindex="-1"></a>past_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb289-2"><a href="plotting-future-scenarios.html#cb289-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">data =</span> past_simulated,</span>
<span id="cb289-3"><a href="plotting-future-scenarios.html#cb289-3" tabindex="-1"></a>               <span class="fu">aes_string</span>(<span class="st">&quot;as.numeric(Year)&quot;</span>,</span>
<span id="cb289-4"><a href="plotting-future-scenarios.html#cb289-4" tabindex="-1"></a>                          metric,<span class="at">group=</span><span class="st">&quot;Year&quot;</span>),</span>
<span id="cb289-5"><a href="plotting-future-scenarios.html#cb289-5" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="plotting-future-scenarios.html#cb290-1" tabindex="-1"></a>past_plot</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-312-1.png" width="672" /></p>
<p>The general layout of this <code>ggplot</code> command should now be familiar. However, a specific detail requires attention: in many <code>ggplot</code> commands, variable names can be written directly (e.g., <code>group = Year</code>) without quotation marks, which is uncommon in R. Normally, strings must be quoted; otherwise, R interprets them as variable names and raises an error if the variable is undefined.</p>
<p>The developers of <code>ggplot2</code>, led by <a href="https://scholar.google.de/citations?hl=en&amp;user=YA43PbsAAAAJ">Hadley Wickham</a>, have removed this requirement, simplifying code in many cases. However, this convenience can cause issues when actual variable names are needed in <strong>ggplot2</strong> calls. To address this, the <code>aes_string</code> function can be used instead of <code>aes</code>, as demonstrated in the example.</p>
<p>Additionally, the y-axis must accommodate not only the data from this plot but also the data from all future scenarios. This is achieved using the <code>range</code> (<code>rng</code>) determined earlier. The axis labels will also be customized, with the y-axis label set using the previously defined <code>axis_label</code>.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="plotting-future-scenarios.html#cb291-1" tabindex="-1"></a>past_plot <span class="ot">&lt;-</span> past_plot <span class="sc">+</span></span>
<span id="cb291-2"><a href="plotting-future-scenarios.html#cb291-2" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb291-3"><a href="plotting-future-scenarios.html#cb291-3" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, </span>
<span id="cb291-4"><a href="plotting-future-scenarios.html#cb291-4" tabindex="-1"></a>               <span class="fu">round</span>(rng[<span class="dv">2</span>] <span class="sc">+</span> rng[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">10</span>))) <span class="sc">+</span></span>
<span id="cb291-5"><a href="plotting-future-scenarios.html#cb291-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, </span>
<span id="cb291-6"><a href="plotting-future-scenarios.html#cb291-6" tabindex="-1"></a>       <span class="at">y =</span> axis_label)</span>
<span id="cb291-7"><a href="plotting-future-scenarios.html#cb291-7" tabindex="-1"></a></span>
<span id="cb291-8"><a href="plotting-future-scenarios.html#cb291-8" tabindex="-1"></a>past_plot</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-313-1.png" width="672" /></p>
<p>The plot for the past scenarios is now complete, but adjustments are needed to ensure consistent formatting with the future data. While the past scenarios involve only one plot, the future scenarios will include multiple plots, created using the <code>facet_wrap</code> function. This function automatically adds design elements to the plots.</p>
<p>To maintain a uniform layout across the entire figure, the single plot for the past scenarios will also be converted into a facet layout. Additionally, the black-and-white theme will be applied for consistency.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="plotting-future-scenarios.html#cb292-1" tabindex="-1"></a>past_plot <span class="ot">&lt;-</span> past_plot <span class="sc">+</span></span>
<span id="cb292-2"><a href="plotting-future-scenarios.html#cb292-2" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> Scenario) <span class="sc">+</span></span>
<span id="cb292-3"><a href="plotting-future-scenarios.html#cb292-3" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) </span>
<span id="cb292-4"><a href="plotting-future-scenarios.html#cb292-4" tabindex="-1"></a>  </span>
<span id="cb292-5"><a href="plotting-future-scenarios.html#cb292-5" tabindex="-1"></a>past_plot</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-314-1.png" width="672" /></p>
<p>The final adjustments involve modifying the facet title and x-axis text. The facet title’s background will be removed, and its text will be set to bold for clarity. The x-axis text will be angled to ensure proper display of all year labels, even if the text size is adjusted.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="plotting-future-scenarios.html#cb293-1" tabindex="-1"></a>past_plot <span class="ot">&lt;-</span> past_plot <span class="sc">+</span>  </span>
<span id="cb293-2"><a href="plotting-future-scenarios.html#cb293-2" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb293-3"><a href="plotting-future-scenarios.html#cb293-3" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb293-4"><a href="plotting-future-scenarios.html#cb293-4" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">45</span>,</span>
<span id="cb293-5"><a href="plotting-future-scenarios.html#cb293-5" tabindex="-1"></a>                                   <span class="at">hjust=</span><span class="dv">1</span>)) </span>
<span id="cb293-6"><a href="plotting-future-scenarios.html#cb293-6" tabindex="-1"></a></span>
<span id="cb293-7"><a href="plotting-future-scenarios.html#cb293-7" tabindex="-1"></a>past_plot</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-315-1.png" width="672" /></p>
<p>The plot of past scenarios is now complete. Next, actual observations will be added to the plot. To distinguish them from the outliers in the box plots, the observations will be colored blue. This step is straightforward and will enhance the clarity of the visualization.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="plotting-future-scenarios.html#cb294-1" tabindex="-1"></a><span class="co"># add historic data</span></span>
<span id="cb294-2"><a href="plotting-future-scenarios.html#cb294-2" tabindex="-1"></a>past_plot <span class="ot">&lt;-</span> past_plot <span class="sc">+</span></span>
<span id="cb294-3"><a href="plotting-future-scenarios.html#cb294-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> past_observed,</span>
<span id="cb294-4"><a href="plotting-future-scenarios.html#cb294-4" tabindex="-1"></a>             <span class="fu">aes_string</span>(<span class="st">&quot;End_year&quot;</span>,</span>
<span id="cb294-5"><a href="plotting-future-scenarios.html#cb294-5" tabindex="-1"></a>                        metric),</span>
<span id="cb294-6"><a href="plotting-future-scenarios.html#cb294-6" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb294-7"><a href="plotting-future-scenarios.html#cb294-7" tabindex="-1"></a></span>
<span id="cb294-8"><a href="plotting-future-scenarios.html#cb294-8" tabindex="-1"></a>past_plot</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-316-1.png" width="672" /></p>
<p>With the past scenarios complete, attention shifts to the future scenarios. These will be organized into two plots: one for the two scenarios in 2050 and another for 2085. These plots will later be displayed as two groups of two plots each.</p>
<p>To maintain an organized structure and allow for potential expansion with additional scenarios, the two plots will be stored in a list. While not strictly necessary for this case, this approach provides flexibility for future modifications.</p>
<p>Before constructing the plots within the list, one will be assembled first as an example, starting with the year 2050.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="plotting-future-scenarios.html#cb295-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2050</span></span>
<span id="cb295-2"><a href="plotting-future-scenarios.html#cb295-2" tabindex="-1"></a></span>
<span id="cb295-3"><a href="plotting-future-scenarios.html#cb295-3" tabindex="-1"></a>future_2050 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span> future_data[<span class="fu">which</span>(future_data<span class="sc">$</span>Year<span class="sc">==</span>y),]) <span class="sc">+</span></span>
<span id="cb295-4"><a href="plotting-future-scenarios.html#cb295-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes_string</span>(<span class="st">&quot;GCM&quot;</span>, </span>
<span id="cb295-5"><a href="plotting-future-scenarios.html#cb295-5" tabindex="-1"></a>                          metric, </span>
<span id="cb295-6"><a href="plotting-future-scenarios.html#cb295-6" tabindex="-1"></a>                          <span class="at">fill =</span> <span class="st">&quot;GCM&quot;</span>))</span>
<span id="cb295-7"><a href="plotting-future-scenarios.html#cb295-7" tabindex="-1"></a></span>
<span id="cb295-8"><a href="plotting-future-scenarios.html#cb295-8" tabindex="-1"></a>future_2050</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-317-1.png" width="672" /></p>
<p>At this point, all SSPs are mixed together, and the y-axis is not easily readable. While the information is conveyed through the color scheme, the plot appears cluttered. To improve its appearance, padding will be added to the sides of the plots using the <code>expand</code> parameter, ensuring the plot doesn’t look too crowded and enhancing its overall readability.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="plotting-future-scenarios.html#cb296-1" tabindex="-1"></a>future_2050 <span class="ot">&lt;-</span> future_2050 <span class="sc">+</span></span>
<span id="cb296-2"><a href="plotting-future-scenarios.html#cb296-2" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(SSP), <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb296-3"><a href="plotting-future-scenarios.html#cb296-3" tabindex="-1"></a>   <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="cn">NULL</span>,</span>
<span id="cb296-4"><a href="plotting-future-scenarios.html#cb296-4" tabindex="-1"></a>                    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="dv">1</span>)) </span></code></pre></div>
<p>In this case, the axis limits also need to be adjusted to ensure consistency between the future and past plots. Additionally, the scenario year will be added to the plots for clarity. This is accomplished using the <code>geom_text_npc</code> function from the <code>ggpmisc</code> package. This will help in placing the year label appropriately on the plot.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="plotting-future-scenarios.html#cb297-1" tabindex="-1"></a>future_2050 <span class="ot">&lt;-</span> future_2050 <span class="sc">+</span></span>
<span id="cb297-2"><a href="plotting-future-scenarios.html#cb297-2" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, </span>
<span id="cb297-3"><a href="plotting-future-scenarios.html#cb297-3" tabindex="-1"></a>                                <span class="fu">round</span>(<span class="fu">round</span>(<span class="fl">1.1</span><span class="sc">*</span>rng[<span class="dv">2</span>])))) <span class="sc">+</span></span>
<span id="cb297-4"><a href="plotting-future-scenarios.html#cb297-4" tabindex="-1"></a>    <span class="fu">geom_text_npc</span>(<span class="fu">aes</span>(<span class="at">npcx =</span> <span class="st">&quot;center&quot;</span>, </span>
<span id="cb297-5"><a href="plotting-future-scenarios.html#cb297-5" tabindex="-1"></a>                      <span class="at">npcy =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb297-6"><a href="plotting-future-scenarios.html#cb297-6" tabindex="-1"></a>                      <span class="at">label =</span> Year),</span>
<span id="cb297-7"><a href="plotting-future-scenarios.html#cb297-7" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb297-8"><a href="plotting-future-scenarios.html#cb297-8" tabindex="-1"></a></span>
<span id="cb297-9"><a href="plotting-future-scenarios.html#cb297-9" tabindex="-1"></a>future_2050</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-319-1.png" width="672" /></p>
<p>For the final adjustments, the black-and-white theme will be applied once again. To reduce clutter, all axis text and titles will be removed, as they don’t add significant value. The y-axis ticks will also be removed. The legend will be placed at the bottom, and the facet title will be formatted in the same way as in the past plot to maintain visual consistency.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="plotting-future-scenarios.html#cb298-1" tabindex="-1"></a>future_2050 <span class="ot">&lt;-</span> future_2050 <span class="sc">+</span></span>
<span id="cb298-2"><a href="plotting-future-scenarios.html#cb298-2" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb298-3"><a href="plotting-future-scenarios.html#cb298-3" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb298-4"><a href="plotting-future-scenarios.html#cb298-4" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb298-5"><a href="plotting-future-scenarios.html#cb298-5" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb298-6"><a href="plotting-future-scenarios.html#cb298-6" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb298-7"><a href="plotting-future-scenarios.html#cb298-7" tabindex="-1"></a>        <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>,</span>
<span id="cb298-8"><a href="plotting-future-scenarios.html#cb298-8" tabindex="-1"></a>                               <span class="dv">0</span>,</span>
<span id="cb298-9"><a href="plotting-future-scenarios.html#cb298-9" tabindex="-1"></a>                               <span class="dv">0</span>,</span>
<span id="cb298-10"><a href="plotting-future-scenarios.html#cb298-10" tabindex="-1"></a>                               <span class="dv">0</span>,</span>
<span id="cb298-11"><a href="plotting-future-scenarios.html#cb298-11" tabindex="-1"></a>                               <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb298-12"><a href="plotting-future-scenarios.html#cb298-12" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(),</span>
<span id="cb298-13"><a href="plotting-future-scenarios.html#cb298-13" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb298-14"><a href="plotting-future-scenarios.html#cb298-14" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb298-15"><a href="plotting-future-scenarios.html#cb298-15" tabindex="-1"></a>        <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb298-16"><a href="plotting-future-scenarios.html#cb298-16" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb298-17"><a href="plotting-future-scenarios.html#cb298-17" tabindex="-1"></a>                                     <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb298-18"><a href="plotting-future-scenarios.html#cb298-18" tabindex="-1"></a>                                     <span class="at">size =</span> <span class="dv">15</span> <span class="sc">*</span> <span class="fl">1.05</span>,</span>
<span id="cb298-19"><a href="plotting-future-scenarios.html#cb298-19" tabindex="-1"></a>                                     <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)) </span>
<span id="cb298-20"><a href="plotting-future-scenarios.html#cb298-20" tabindex="-1"></a></span>
<span id="cb298-21"><a href="plotting-future-scenarios.html#cb298-21" tabindex="-1"></a>future_2050</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-320-1.png" width="672" /></p>
<p>The legend is currently too large, but it can be adjusted later.</p>
<p>Next, the procedure will be implemented in a loop to create a list of two plots: one for 2050 and one for 2085. This approach will allow for consistent plotting while maintaining flexibility for future adjustments.</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="plotting-future-scenarios.html#cb299-1" tabindex="-1"></a>future_plot_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb299-2"><a href="plotting-future-scenarios.html#cb299-2" tabindex="-1"></a></span>
<span id="cb299-3"><a href="plotting-future-scenarios.html#cb299-3" tabindex="-1"></a>time_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>)</span>
<span id="cb299-4"><a href="plotting-future-scenarios.html#cb299-4" tabindex="-1"></a></span>
<span id="cb299-5"><a href="plotting-future-scenarios.html#cb299-5" tabindex="-1"></a><span class="cf">for</span>(y <span class="cf">in</span> time_points)</span>
<span id="cb299-6"><a href="plotting-future-scenarios.html#cb299-6" tabindex="-1"></a>{</span>
<span id="cb299-7"><a href="plotting-future-scenarios.html#cb299-7" tabindex="-1"></a>  future_plot_list[[<span class="fu">which</span>(y <span class="sc">==</span> time_points)]] <span class="ot">&lt;-</span></span>
<span id="cb299-8"><a href="plotting-future-scenarios.html#cb299-8" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="at">data =</span> future_data[<span class="fu">which</span>(future_data<span class="sc">$</span>Year<span class="sc">==</span>y),]) <span class="sc">+</span></span>
<span id="cb299-9"><a href="plotting-future-scenarios.html#cb299-9" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="fu">aes_string</span>(<span class="st">&quot;GCM&quot;</span>,</span>
<span id="cb299-10"><a href="plotting-future-scenarios.html#cb299-10" tabindex="-1"></a>                            metric,</span>
<span id="cb299-11"><a href="plotting-future-scenarios.html#cb299-11" tabindex="-1"></a>                            <span class="at">fill=</span><span class="st">&quot;GCM&quot;</span>)) <span class="sc">+</span></span>
<span id="cb299-12"><a href="plotting-future-scenarios.html#cb299-12" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(SSP), <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb299-13"><a href="plotting-future-scenarios.html#cb299-13" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="cn">NULL</span>,</span>
<span id="cb299-14"><a href="plotting-future-scenarios.html#cb299-14" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb299-15"><a href="plotting-future-scenarios.html#cb299-15" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, </span>
<span id="cb299-16"><a href="plotting-future-scenarios.html#cb299-16" tabindex="-1"></a>                                  <span class="fu">round</span>(<span class="fu">round</span>(<span class="fl">1.1</span><span class="sc">*</span>rng[<span class="dv">2</span>])))) <span class="sc">+</span></span>
<span id="cb299-17"><a href="plotting-future-scenarios.html#cb299-17" tabindex="-1"></a>    <span class="fu">geom_text_npc</span>(<span class="fu">aes</span>(<span class="at">npcx =</span> <span class="st">&quot;center&quot;</span>,</span>
<span id="cb299-18"><a href="plotting-future-scenarios.html#cb299-18" tabindex="-1"></a>                      <span class="at">npcy =</span> <span class="st">&quot;top&quot;</span>, </span>
<span id="cb299-19"><a href="plotting-future-scenarios.html#cb299-19" tabindex="-1"></a>                      <span class="at">label =</span> Year),</span>
<span id="cb299-20"><a href="plotting-future-scenarios.html#cb299-20" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb299-21"><a href="plotting-future-scenarios.html#cb299-21" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb299-22"><a href="plotting-future-scenarios.html#cb299-22" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-23"><a href="plotting-future-scenarios.html#cb299-23" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-24"><a href="plotting-future-scenarios.html#cb299-24" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-25"><a href="plotting-future-scenarios.html#cb299-25" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb299-26"><a href="plotting-future-scenarios.html#cb299-26" tabindex="-1"></a>          <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, </span>
<span id="cb299-27"><a href="plotting-future-scenarios.html#cb299-27" tabindex="-1"></a>                                 <span class="dv">0</span>, </span>
<span id="cb299-28"><a href="plotting-future-scenarios.html#cb299-28" tabindex="-1"></a>                                 <span class="dv">0</span>, </span>
<span id="cb299-29"><a href="plotting-future-scenarios.html#cb299-29" tabindex="-1"></a>                                 <span class="dv">0</span>, </span>
<span id="cb299-30"><a href="plotting-future-scenarios.html#cb299-30" tabindex="-1"></a>                                 <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb299-31"><a href="plotting-future-scenarios.html#cb299-31" tabindex="-1"></a>          <span class="at">legend.background =</span> <span class="fu">element_rect</span>(),</span>
<span id="cb299-32"><a href="plotting-future-scenarios.html#cb299-32" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb299-33"><a href="plotting-future-scenarios.html#cb299-33" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb299-34"><a href="plotting-future-scenarios.html#cb299-34" tabindex="-1"></a>          <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb299-35"><a href="plotting-future-scenarios.html#cb299-35" tabindex="-1"></a>          <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(</span>
<span id="cb299-36"><a href="plotting-future-scenarios.html#cb299-36" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb299-37"><a href="plotting-future-scenarios.html#cb299-37" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb299-38"><a href="plotting-future-scenarios.html#cb299-38" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">15</span> <span class="sc">*</span> <span class="fl">1.05</span>,</span>
<span id="cb299-39"><a href="plotting-future-scenarios.html#cb299-39" tabindex="-1"></a>            <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)) </span>
<span id="cb299-40"><a href="plotting-future-scenarios.html#cb299-40" tabindex="-1"></a>}</span>
<span id="cb299-41"><a href="plotting-future-scenarios.html#cb299-41" tabindex="-1"></a></span>
<span id="cb299-42"><a href="plotting-future-scenarios.html#cb299-42" tabindex="-1"></a>future_plot_list</span></code></pre></div>
<pre><code>## [[1]]</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-321-1.png" width="672" /></p>
<pre><code>## 
## [[2]]</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-321-2.png" width="672" /></p>
<p>Combining the plots is straightforward. The plots can be joined using the <code>+</code> sign, which allows for easy layering and combination into a single cohesive figure.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="plotting-future-scenarios.html#cb302-1" tabindex="-1"></a>both_plots <span class="ot">&lt;-</span> past_plot <span class="sc">+</span> future_plot_list</span>
<span id="cb302-2"><a href="plotting-future-scenarios.html#cb302-2" tabindex="-1"></a></span>
<span id="cb302-3"><a href="plotting-future-scenarios.html#cb302-3" tabindex="-1"></a>both_plots</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-322-1.png" width="672" /></p>
<p>The basic structure of the plots is in place, but a few adjustments are needed, particularly for the legend. The <code>plot_layout</code> function from the <code>patchwork</code> package is used for this purpose. It allows for the creation of patchwork figures by collecting all legends and removing duplicates, ensuring that only one version of the legend is displayed. Additionally, the width of the individual plots can be adjusted. To achieve this, a vector <code>c(1, 1.8, 1.8)</code> is used, specifying that each set of future plots should be 1.8 times the width of the past scenario plot. This provides a more balanced layout.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="plotting-future-scenarios.html#cb303-1" tabindex="-1"></a>plot <span class="ot">&lt;-</span> both_plots <span class="sc">+</span></span>
<span id="cb303-2"><a href="plotting-future-scenarios.html#cb303-2" tabindex="-1"></a>           <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>,</span>
<span id="cb303-3"><a href="plotting-future-scenarios.html#cb303-3" tabindex="-1"></a>                       <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">rep</span>(<span class="dv">2</span>,<span class="fu">length</span>(future_plot_list))))</span></code></pre></div>
<p>With the previous adjustments, the plot is no longer clearly visible, so the legend will be moved to the bottom for better visibility. Due to how the <code>patchwork</code> package works, the corresponding theme call must be added after an <code>&amp;</code> symbol to ensure the legend is positioned correctly at the bottom. This adjustment ensures the plot remains clear and the layout is consistent.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="plotting-future-scenarios.html#cb304-1" tabindex="-1"></a>plot <span class="ot">&lt;-</span> plot <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb304-2"><a href="plotting-future-scenarios.html#cb304-2" tabindex="-1"></a>                     <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),</span>
<span id="cb304-3"><a href="plotting-future-scenarios.html#cb304-3" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb304-4"><a href="plotting-future-scenarios.html#cb304-4" tabindex="-1"></a>                     <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
</div>
<div id="the-results" class="section level2 hasAnchor" number="18.3">
<h2><span class="header-section-number">18.3</span> The results<a href="plotting-future-scenarios.html#the-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The adjustments have resulted in clear and consistent <code>ggplot</code> figures displaying a heat analysis for Bonn. The figures are well-organized, with properly placed legends and axis labels, making them ready for presentation.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="plotting-future-scenarios.html#cb305-1" tabindex="-1"></a>plot</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-325-1.png" width="672" /></p>
<p>The process is now complete. The same procedure can be applied to the other metrics. By simply changing the <code>metric</code> and <code>axis_label</code> variables and running the code again, the same steps can be followed for the other metrics. The full code will not be shown here, but the approach should work seamlessly for these adjustments.</p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-326-1.png" width="672" /></p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-327-1.png" width="672" /></p>
<p>To create a generally applicable function for the entire processing workflow, some additional effort is required. This involves ensuring that the function produces appropriate warnings or errors when given incorrect inputs, and making it flexible enough to handle different types of data. However, if the function is only intended for use with data structured in the same way as the current dataset, it can be simplified. In this case, all the steps performed so far can be wrapped into a function call, streamlining the process.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="plotting-future-scenarios.html#cb306-1" tabindex="-1"></a>plot_scenarios_gg <span class="ot">&lt;-</span> <span class="cf">function</span>(past_observed,</span>
<span id="cb306-2"><a href="plotting-future-scenarios.html#cb306-2" tabindex="-1"></a>                              past_simulated,</span>
<span id="cb306-3"><a href="plotting-future-scenarios.html#cb306-3" tabindex="-1"></a>                              future_data,</span>
<span id="cb306-4"><a href="plotting-future-scenarios.html#cb306-4" tabindex="-1"></a>                              metric,</span>
<span id="cb306-5"><a href="plotting-future-scenarios.html#cb306-5" tabindex="-1"></a>                              axis_label,</span>
<span id="cb306-6"><a href="plotting-future-scenarios.html#cb306-6" tabindex="-1"></a>                              time_points)</span>
<span id="cb306-7"><a href="plotting-future-scenarios.html#cb306-7" tabindex="-1"></a>{</span>
<span id="cb306-8"><a href="plotting-future-scenarios.html#cb306-8" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(past_observed[[metric]],</span>
<span id="cb306-9"><a href="plotting-future-scenarios.html#cb306-9" tabindex="-1"></a>               past_simulated[[metric]],</span>
<span id="cb306-10"><a href="plotting-future-scenarios.html#cb306-10" tabindex="-1"></a>               future_data[[metric]])  </span>
<span id="cb306-11"><a href="plotting-future-scenarios.html#cb306-11" tabindex="-1"></a>  past_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb306-12"><a href="plotting-future-scenarios.html#cb306-12" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">data =</span> past_simulated,</span>
<span id="cb306-13"><a href="plotting-future-scenarios.html#cb306-13" tabindex="-1"></a>                 <span class="fu">aes_string</span>(<span class="st">&quot;as.numeric(Year)&quot;</span>,</span>
<span id="cb306-14"><a href="plotting-future-scenarios.html#cb306-14" tabindex="-1"></a>                            metric,</span>
<span id="cb306-15"><a href="plotting-future-scenarios.html#cb306-15" tabindex="-1"></a>                            <span class="at">group=</span><span class="st">&quot;Year&quot;</span>),</span>
<span id="cb306-16"><a href="plotting-future-scenarios.html#cb306-16" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb306-17"><a href="plotting-future-scenarios.html#cb306-17" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, </span>
<span id="cb306-18"><a href="plotting-future-scenarios.html#cb306-18" tabindex="-1"></a>                                  <span class="fu">round</span>(<span class="fu">round</span>(<span class="fl">1.1</span><span class="sc">*</span>rng[<span class="dv">2</span>])))) <span class="sc">+</span></span>
<span id="cb306-19"><a href="plotting-future-scenarios.html#cb306-19" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="at">y =</span> axis_label) <span class="sc">+</span></span>
<span id="cb306-20"><a href="plotting-future-scenarios.html#cb306-20" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span> Scenario) <span class="sc">+</span></span>
<span id="cb306-21"><a href="plotting-future-scenarios.html#cb306-21" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span>  </span>
<span id="cb306-22"><a href="plotting-future-scenarios.html#cb306-22" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb306-23"><a href="plotting-future-scenarios.html#cb306-23" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb306-24"><a href="plotting-future-scenarios.html#cb306-24" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">45</span>, </span>
<span id="cb306-25"><a href="plotting-future-scenarios.html#cb306-25" tabindex="-1"></a>                                     <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb306-26"><a href="plotting-future-scenarios.html#cb306-26" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> past_observed,</span>
<span id="cb306-27"><a href="plotting-future-scenarios.html#cb306-27" tabindex="-1"></a>               <span class="fu">aes_string</span>(<span class="st">&quot;End_year&quot;</span>,</span>
<span id="cb306-28"><a href="plotting-future-scenarios.html#cb306-28" tabindex="-1"></a>                          metric),</span>
<span id="cb306-29"><a href="plotting-future-scenarios.html#cb306-29" tabindex="-1"></a>               <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb306-30"><a href="plotting-future-scenarios.html#cb306-30" tabindex="-1"></a>  </span>
<span id="cb306-31"><a href="plotting-future-scenarios.html#cb306-31" tabindex="-1"></a>  future_plot_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb306-32"><a href="plotting-future-scenarios.html#cb306-32" tabindex="-1"></a>  </span>
<span id="cb306-33"><a href="plotting-future-scenarios.html#cb306-33" tabindex="-1"></a>  <span class="cf">for</span>(y <span class="cf">in</span> time_points)</span>
<span id="cb306-34"><a href="plotting-future-scenarios.html#cb306-34" tabindex="-1"></a>  {</span>
<span id="cb306-35"><a href="plotting-future-scenarios.html#cb306-35" tabindex="-1"></a>    future_plot_list[[<span class="fu">which</span>(y <span class="sc">==</span> time_points)]] <span class="ot">&lt;-</span></span>
<span id="cb306-36"><a href="plotting-future-scenarios.html#cb306-36" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="at">data =</span> future_data[<span class="fu">which</span>(future_data<span class="sc">$</span>Year<span class="sc">==</span>y),]) <span class="sc">+</span></span>
<span id="cb306-37"><a href="plotting-future-scenarios.html#cb306-37" tabindex="-1"></a>      <span class="fu">geom_boxplot</span>(<span class="fu">aes_string</span>(<span class="st">&quot;GCM&quot;</span>, </span>
<span id="cb306-38"><a href="plotting-future-scenarios.html#cb306-38" tabindex="-1"></a>                              metric, </span>
<span id="cb306-39"><a href="plotting-future-scenarios.html#cb306-39" tabindex="-1"></a>                              <span class="at">fill=</span><span class="st">&quot;GCM&quot;</span>)) <span class="sc">+</span></span>
<span id="cb306-40"><a href="plotting-future-scenarios.html#cb306-40" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(SSP), <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb306-41"><a href="plotting-future-scenarios.html#cb306-41" tabindex="-1"></a>      <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="cn">NULL</span>,</span>
<span id="cb306-42"><a href="plotting-future-scenarios.html#cb306-42" tabindex="-1"></a>                       <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb306-43"><a href="plotting-future-scenarios.html#cb306-43" tabindex="-1"></a>      <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, </span>
<span id="cb306-44"><a href="plotting-future-scenarios.html#cb306-44" tabindex="-1"></a>                                    <span class="fu">round</span>(<span class="fu">round</span>(<span class="fl">1.1</span><span class="sc">*</span>rng[<span class="dv">2</span>])))) <span class="sc">+</span></span>
<span id="cb306-45"><a href="plotting-future-scenarios.html#cb306-45" tabindex="-1"></a>      <span class="fu">geom_text_npc</span>(<span class="fu">aes</span>(<span class="at">npcx =</span> <span class="st">&quot;center&quot;</span>,</span>
<span id="cb306-46"><a href="plotting-future-scenarios.html#cb306-46" tabindex="-1"></a>                        <span class="at">npcy =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb306-47"><a href="plotting-future-scenarios.html#cb306-47" tabindex="-1"></a>                        <span class="at">label =</span> Year),</span>
<span id="cb306-48"><a href="plotting-future-scenarios.html#cb306-48" tabindex="-1"></a>                    <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb306-49"><a href="plotting-future-scenarios.html#cb306-49" tabindex="-1"></a>      <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb306-50"><a href="plotting-future-scenarios.html#cb306-50" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb306-51"><a href="plotting-future-scenarios.html#cb306-51" tabindex="-1"></a>            <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb306-52"><a href="plotting-future-scenarios.html#cb306-52" tabindex="-1"></a>            <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb306-53"><a href="plotting-future-scenarios.html#cb306-53" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb306-54"><a href="plotting-future-scenarios.html#cb306-54" tabindex="-1"></a>            <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>,</span>
<span id="cb306-55"><a href="plotting-future-scenarios.html#cb306-55" tabindex="-1"></a>                                   <span class="dv">0</span>, </span>
<span id="cb306-56"><a href="plotting-future-scenarios.html#cb306-56" tabindex="-1"></a>                                   <span class="dv">0</span>, </span>
<span id="cb306-57"><a href="plotting-future-scenarios.html#cb306-57" tabindex="-1"></a>                                   <span class="dv">0</span>, </span>
<span id="cb306-58"><a href="plotting-future-scenarios.html#cb306-58" tabindex="-1"></a>                                   <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb306-59"><a href="plotting-future-scenarios.html#cb306-59" tabindex="-1"></a>            <span class="at">legend.background =</span> <span class="fu">element_rect</span>(),</span>
<span id="cb306-60"><a href="plotting-future-scenarios.html#cb306-60" tabindex="-1"></a>            <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb306-61"><a href="plotting-future-scenarios.html#cb306-61" tabindex="-1"></a>            <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb306-62"><a href="plotting-future-scenarios.html#cb306-62" tabindex="-1"></a>            <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb306-63"><a href="plotting-future-scenarios.html#cb306-63" tabindex="-1"></a>            <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb306-64"><a href="plotting-future-scenarios.html#cb306-64" tabindex="-1"></a>                                         <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb306-65"><a href="plotting-future-scenarios.html#cb306-65" tabindex="-1"></a>                                         <span class="at">size =</span> <span class="dv">15</span> <span class="sc">*</span> <span class="fl">1.05</span>,</span>
<span id="cb306-66"><a href="plotting-future-scenarios.html#cb306-66" tabindex="-1"></a>                                         <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)) </span>
<span id="cb306-67"><a href="plotting-future-scenarios.html#cb306-67" tabindex="-1"></a>  }</span>
<span id="cb306-68"><a href="plotting-future-scenarios.html#cb306-68" tabindex="-1"></a>  </span>
<span id="cb306-69"><a href="plotting-future-scenarios.html#cb306-69" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> (past_plot <span class="sc">+</span></span>
<span id="cb306-70"><a href="plotting-future-scenarios.html#cb306-70" tabindex="-1"></a>             future_plot_list <span class="sc">+</span></span>
<span id="cb306-71"><a href="plotting-future-scenarios.html#cb306-71" tabindex="-1"></a>             <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>,</span>
<span id="cb306-72"><a href="plotting-future-scenarios.html#cb306-72" tabindex="-1"></a>                         <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fu">rep</span>(<span class="dv">2</span>,<span class="fu">length</span>(future_plot_list))))</span>
<span id="cb306-73"><a href="plotting-future-scenarios.html#cb306-73" tabindex="-1"></a>           ) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb306-74"><a href="plotting-future-scenarios.html#cb306-74" tabindex="-1"></a>                     <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb306-75"><a href="plotting-future-scenarios.html#cb306-75" tabindex="-1"></a>                     <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb306-76"><a href="plotting-future-scenarios.html#cb306-76" tabindex="-1"></a>                     <span class="at">axis.title.x=</span><span class="fu">element_blank</span>())</span>
<span id="cb306-77"><a href="plotting-future-scenarios.html#cb306-77" tabindex="-1"></a>  plot</span>
<span id="cb306-78"><a href="plotting-future-scenarios.html#cb306-78" tabindex="-1"></a>  </span>
<span id="cb306-79"><a href="plotting-future-scenarios.html#cb306-79" tabindex="-1"></a>}</span></code></pre></div>
<p>By wrapping all the steps into a function, the same outputs can now be generated more quickly. This approach simplifies the process and allows for efficient reuse of the code without repeating all the individual commands.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="plotting-future-scenarios.html#cb307-1" tabindex="-1"></a><span class="fu">plot_scenarios_gg</span>(<span class="at">past_observed =</span> past_observed,</span>
<span id="cb307-2"><a href="plotting-future-scenarios.html#cb307-2" tabindex="-1"></a>                  <span class="at">past_simulated =</span> past_simulated,</span>
<span id="cb307-3"><a href="plotting-future-scenarios.html#cb307-3" tabindex="-1"></a>                  <span class="at">future_data =</span> future_data,</span>
<span id="cb307-4"><a href="plotting-future-scenarios.html#cb307-4" tabindex="-1"></a>                  <span class="at">metric =</span> <span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb307-5"><a href="plotting-future-scenarios.html#cb307-5" tabindex="-1"></a>                  <span class="at">axis_label =</span> <span class="st">&quot;Heat (in Growing Degree Hours)&quot;</span>,</span>
<span id="cb307-6"><a href="plotting-future-scenarios.html#cb307-6" tabindex="-1"></a>                  <span class="at">time_points =</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-329-1.png" width="672" /></p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="plotting-future-scenarios.html#cb308-1" tabindex="-1"></a><span class="fu">plot_scenarios_gg</span>(<span class="at">past_observed =</span> past_observed,</span>
<span id="cb308-2"><a href="plotting-future-scenarios.html#cb308-2" tabindex="-1"></a>                  <span class="at">past_simulated =</span> past_simulated,</span>
<span id="cb308-3"><a href="plotting-future-scenarios.html#cb308-3" tabindex="-1"></a>                  <span class="at">future_data =</span> future_data,</span>
<span id="cb308-4"><a href="plotting-future-scenarios.html#cb308-4" tabindex="-1"></a>                  <span class="at">metric =</span> <span class="st">&quot;Chill_Portions&quot;</span>,</span>
<span id="cb308-5"><a href="plotting-future-scenarios.html#cb308-5" tabindex="-1"></a>                  <span class="at">axis_label =</span> <span class="st">&quot;Chill (in Chill Portions)&quot;</span>,</span>
<span id="cb308-6"><a href="plotting-future-scenarios.html#cb308-6" tabindex="-1"></a>                  <span class="at">time_points =</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-330-1.png" width="672" /></p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="plotting-future-scenarios.html#cb309-1" tabindex="-1"></a><span class="fu">plot_scenarios_gg</span>(<span class="at">past_observed =</span> past_observed,</span>
<span id="cb309-2"><a href="plotting-future-scenarios.html#cb309-2" tabindex="-1"></a>                  <span class="at">past_simulated =</span> past_simulated,</span>
<span id="cb309-3"><a href="plotting-future-scenarios.html#cb309-3" tabindex="-1"></a>                  <span class="at">future_data =</span> future_data,</span>
<span id="cb309-4"><a href="plotting-future-scenarios.html#cb309-4" tabindex="-1"></a>                  <span class="at">metric =</span> <span class="st">&quot;Frost_H&quot;</span>,</span>
<span id="cb309-5"><a href="plotting-future-scenarios.html#cb309-5" tabindex="-1"></a>                  <span class="at">axis_label =</span> <span class="st">&quot;Frost duration (in hours)&quot;</span>,</span>
<span id="cb309-6"><a href="plotting-future-scenarios.html#cb309-6" tabindex="-1"></a>                  <span class="at">time_points =</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-331-1.png" width="672" /></p>
</div>
<div id="exercises-on-plotting-future-projections" class="section level2 hasAnchor" number="18.4">
<h2><span class="header-section-number">18.4</span> <code>Exercises</code> on plotting future projections<a href="plotting-future-scenarios.html#exercises-on-plotting-future-projections" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Produce similar plots for the weather station you selected for earlier exercises.</li>
</ol>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="plotting-future-scenarios.html#cb310-1" tabindex="-1"></a>chill_hist_scenario_list <span class="ot">&lt;-</span> <span class="fu">load_temperature_scenarios</span>(<span class="st">&quot;Yakima&quot;</span>,</span>
<span id="cb310-2"><a href="plotting-future-scenarios.html#cb310-2" tabindex="-1"></a>                                                       <span class="st">&quot;Yakima_hist_chill_305_59&quot;</span>)</span>
<span id="cb310-3"><a href="plotting-future-scenarios.html#cb310-3" tabindex="-1"></a>actual_chill <span class="ot">&lt;-</span> <span class="fu">read_tab</span>(<span class="st">&quot;Yakima/Yakima_observed_chill_305_59.csv&quot;</span>)</span>
<span id="cb310-4"><a href="plotting-future-scenarios.html#cb310-4" tabindex="-1"></a></span>
<span id="cb310-5"><a href="plotting-future-scenarios.html#cb310-5" tabindex="-1"></a>chill_future_scenario_list <span class="ot">&lt;-</span> <span class="fu">load_temperature_scenarios</span>(<span class="st">&quot;Yakima/future_climate&quot;</span>,<span class="st">&quot;Yakima_futurechill_305_59&quot;</span>)</span>
<span id="cb310-6"><a href="plotting-future-scenarios.html#cb310-6" tabindex="-1"></a></span>
<span id="cb310-7"><a href="plotting-future-scenarios.html#cb310-7" tabindex="-1"></a>chills <span class="ot">&lt;-</span> <span class="fu">make_climate_scenario</span>(</span>
<span id="cb310-8"><a href="plotting-future-scenarios.html#cb310-8" tabindex="-1"></a>  chill_hist_scenario_list,</span>
<span id="cb310-9"><a href="plotting-future-scenarios.html#cb310-9" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">&quot;Historic&quot;</span>,</span>
<span id="cb310-10"><a href="plotting-future-scenarios.html#cb310-10" tabindex="-1"></a>  <span class="at">historic_data =</span> actual_chill,</span>
<span id="cb310-11"><a href="plotting-future-scenarios.html#cb310-11" tabindex="-1"></a>  <span class="at">time_series =</span> <span class="cn">TRUE</span>)</span>
<span id="cb310-12"><a href="plotting-future-scenarios.html#cb310-12" tabindex="-1"></a></span>
<span id="cb310-13"><a href="plotting-future-scenarios.html#cb310-13" tabindex="-1"></a>SSPs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ssp126&quot;</span>, <span class="st">&quot;ssp245&quot;</span>, <span class="st">&quot;ssp370&quot;</span>, <span class="st">&quot;ssp585&quot;</span>)</span>
<span id="cb310-14"><a href="plotting-future-scenarios.html#cb310-14" tabindex="-1"></a>Times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>)</span>
<span id="cb310-15"><a href="plotting-future-scenarios.html#cb310-15" tabindex="-1"></a></span>
<span id="cb310-16"><a href="plotting-future-scenarios.html#cb310-16" tabindex="-1"></a>list_ssp <span class="ot">&lt;-</span> </span>
<span id="cb310-17"><a href="plotting-future-scenarios.html#cb310-17" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="fu">names</span>(chill_future_scenario_list), <span class="st">&#39;</span><span class="sc">\\</span><span class="st">.&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb310-18"><a href="plotting-future-scenarios.html#cb310-18" tabindex="-1"></a>  <span class="fu">map</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb310-19"><a href="plotting-future-scenarios.html#cb310-19" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb310-20"><a href="plotting-future-scenarios.html#cb310-20" tabindex="-1"></a></span>
<span id="cb310-21"><a href="plotting-future-scenarios.html#cb310-21" tabindex="-1"></a>list_gcm <span class="ot">&lt;-</span></span>
<span id="cb310-22"><a href="plotting-future-scenarios.html#cb310-22" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="fu">names</span>(chill_future_scenario_list), <span class="st">&#39;</span><span class="sc">\\</span><span class="st">.&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb310-23"><a href="plotting-future-scenarios.html#cb310-23" tabindex="-1"></a>  <span class="fu">map</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb310-24"><a href="plotting-future-scenarios.html#cb310-24" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb310-25"><a href="plotting-future-scenarios.html#cb310-25" tabindex="-1"></a></span>
<span id="cb310-26"><a href="plotting-future-scenarios.html#cb310-26" tabindex="-1"></a>list_time <span class="ot">&lt;-</span></span>
<span id="cb310-27"><a href="plotting-future-scenarios.html#cb310-27" tabindex="-1"></a>  <span class="fu">strsplit</span>(<span class="fu">names</span>(chill_future_scenario_list), <span class="st">&#39;</span><span class="sc">\\</span><span class="st">.&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb310-28"><a href="plotting-future-scenarios.html#cb310-28" tabindex="-1"></a>  <span class="fu">map</span>(<span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb310-29"><a href="plotting-future-scenarios.html#cb310-29" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb310-30"><a href="plotting-future-scenarios.html#cb310-30" tabindex="-1"></a></span>
<span id="cb310-31"><a href="plotting-future-scenarios.html#cb310-31" tabindex="-1"></a></span>
<span id="cb310-32"><a href="plotting-future-scenarios.html#cb310-32" tabindex="-1"></a><span class="cf">for</span>(SSP <span class="cf">in</span> SSPs)</span>
<span id="cb310-33"><a href="plotting-future-scenarios.html#cb310-33" tabindex="-1"></a>  <span class="cf">for</span>(Time <span class="cf">in</span> Times)</span>
<span id="cb310-34"><a href="plotting-future-scenarios.html#cb310-34" tabindex="-1"></a>    {</span>
<span id="cb310-35"><a href="plotting-future-scenarios.html#cb310-35" tabindex="-1"></a>    </span>
<span id="cb310-36"><a href="plotting-future-scenarios.html#cb310-36" tabindex="-1"></a>    <span class="co"># find all scenarios for the ssp and time</span></span>
<span id="cb310-37"><a href="plotting-future-scenarios.html#cb310-37" tabindex="-1"></a>    chill <span class="ot">&lt;-</span> chill_future_scenario_list[list_ssp <span class="sc">==</span> SSP <span class="sc">&amp;</span> list_time <span class="sc">==</span> Time]</span>
<span id="cb310-38"><a href="plotting-future-scenarios.html#cb310-38" tabindex="-1"></a>    <span class="fu">names</span>(chill) <span class="ot">&lt;-</span> list_gcm[list_ssp <span class="sc">==</span> SSP <span class="sc">&amp;</span> list_time <span class="sc">==</span> Time]</span>
<span id="cb310-39"><a href="plotting-future-scenarios.html#cb310-39" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">&quot;ssp126&quot;</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">&quot;SSP1&quot;</span></span>
<span id="cb310-40"><a href="plotting-future-scenarios.html#cb310-40" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">&quot;ssp245&quot;</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">&quot;SSP2&quot;</span></span>
<span id="cb310-41"><a href="plotting-future-scenarios.html#cb310-41" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">&quot;ssp370&quot;</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">&quot;SSP3&quot;</span></span>
<span id="cb310-42"><a href="plotting-future-scenarios.html#cb310-42" tabindex="-1"></a>    <span class="cf">if</span>(SSP <span class="sc">==</span> <span class="st">&quot;ssp585&quot;</span>) SSPcaption <span class="ot">&lt;-</span> <span class="st">&quot;SSP5&quot;</span>    </span>
<span id="cb310-43"><a href="plotting-future-scenarios.html#cb310-43" tabindex="-1"></a>    <span class="cf">if</span>(Time <span class="sc">==</span> <span class="st">&quot;2050&quot;</span>) Time_caption <span class="ot">&lt;-</span> <span class="st">&quot;2050&quot;</span></span>
<span id="cb310-44"><a href="plotting-future-scenarios.html#cb310-44" tabindex="-1"></a>    <span class="cf">if</span>(Time <span class="sc">==</span> <span class="st">&quot;2085&quot;</span>) Time_caption <span class="ot">&lt;-</span> <span class="st">&quot;2085&quot;</span></span>
<span id="cb310-45"><a href="plotting-future-scenarios.html#cb310-45" tabindex="-1"></a>    chills <span class="ot">&lt;-</span> chill <span class="sc">%&gt;%</span> </span>
<span id="cb310-46"><a href="plotting-future-scenarios.html#cb310-46" tabindex="-1"></a>      <span class="fu">make_climate_scenario</span>(</span>
<span id="cb310-47"><a href="plotting-future-scenarios.html#cb310-47" tabindex="-1"></a>        <span class="at">caption =</span> <span class="fu">c</span>(SSPcaption,</span>
<span id="cb310-48"><a href="plotting-future-scenarios.html#cb310-48" tabindex="-1"></a>                    Time_caption),</span>
<span id="cb310-49"><a href="plotting-future-scenarios.html#cb310-49" tabindex="-1"></a>        <span class="at">add_to =</span> chills)</span>
<span id="cb310-50"><a href="plotting-future-scenarios.html#cb310-50" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="plotting-future-scenarios.html#cb311-1" tabindex="-1"></a><span class="cf">for</span>(nam <span class="cf">in</span> <span class="fu">names</span>(chills[[<span class="dv">1</span>]]<span class="sc">$</span>data))</span>
<span id="cb311-2"><a href="plotting-future-scenarios.html#cb311-2" tabindex="-1"></a>  {</span>
<span id="cb311-3"><a href="plotting-future-scenarios.html#cb311-3" tabindex="-1"></a>   <span class="co"># Extract the data frame.</span></span>
<span id="cb311-4"><a href="plotting-future-scenarios.html#cb311-4" tabindex="-1"></a>   ch <span class="ot">&lt;-</span> chills[[<span class="dv">1</span>]]<span class="sc">$</span>data[[nam]]</span>
<span id="cb311-5"><a href="plotting-future-scenarios.html#cb311-5" tabindex="-1"></a>   <span class="co"># Add columns for the new information we have to add and fill them.</span></span>
<span id="cb311-6"><a href="plotting-future-scenarios.html#cb311-6" tabindex="-1"></a>   ch[,<span class="st">&quot;GCM&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb311-7"><a href="plotting-future-scenarios.html#cb311-7" tabindex="-1"></a>   ch[,<span class="st">&quot;SSP&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb311-8"><a href="plotting-future-scenarios.html#cb311-8" tabindex="-1"></a>   ch[,<span class="st">&quot;Year&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(nam)</span>
<span id="cb311-9"><a href="plotting-future-scenarios.html#cb311-9" tabindex="-1"></a>   </span>
<span id="cb311-10"><a href="plotting-future-scenarios.html#cb311-10" tabindex="-1"></a>   <span class="co"># Now check if this is the first time we&#39;ve gone through this loop.</span></span>
<span id="cb311-11"><a href="plotting-future-scenarios.html#cb311-11" tabindex="-1"></a>   <span class="co"># If this is the first time, the ch data.frame becomes the output</span></span>
<span id="cb311-12"><a href="plotting-future-scenarios.html#cb311-12" tabindex="-1"></a>   <span class="co"># object (past_simulated).</span></span>
<span id="cb311-13"><a href="plotting-future-scenarios.html#cb311-13" tabindex="-1"></a>   <span class="co"># If it is not the first time (&#39;else&#39;), we add the current data.frame</span></span>
<span id="cb311-14"><a href="plotting-future-scenarios.html#cb311-14" tabindex="-1"></a>   <span class="co"># to the &#39;past_simulated&#39; object</span></span>
<span id="cb311-15"><a href="plotting-future-scenarios.html#cb311-15" tabindex="-1"></a>  <span class="cf">if</span>(nam <span class="sc">==</span> <span class="fu">names</span>(chills[[<span class="dv">1</span>]]<span class="sc">$</span>data)[<span class="dv">1</span>])</span>
<span id="cb311-16"><a href="plotting-future-scenarios.html#cb311-16" tabindex="-1"></a>    past_simulated <span class="ot">&lt;-</span> ch <span class="cf">else</span></span>
<span id="cb311-17"><a href="plotting-future-scenarios.html#cb311-17" tabindex="-1"></a>      past_simulated <span class="ot">&lt;-</span> <span class="fu">rbind</span>(past_simulated,</span>
<span id="cb311-18"><a href="plotting-future-scenarios.html#cb311-18" tabindex="-1"></a>                              ch)</span>
<span id="cb311-19"><a href="plotting-future-scenarios.html#cb311-19" tabindex="-1"></a>  }</span>
<span id="cb311-20"><a href="plotting-future-scenarios.html#cb311-20" tabindex="-1"></a></span>
<span id="cb311-21"><a href="plotting-future-scenarios.html#cb311-21" tabindex="-1"></a><span class="co"># We add another column called &#39;Scenario&#39; and label all rows as &#39;Historical&#39; </span></span>
<span id="cb311-22"><a href="plotting-future-scenarios.html#cb311-22" tabindex="-1"></a>past_simulated[<span class="st">&quot;Scenario&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Historical&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="plotting-future-scenarios.html#cb312-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(chills))</span>
<span id="cb312-2"><a href="plotting-future-scenarios.html#cb312-2" tabindex="-1"></a>  <span class="cf">for</span>(nam <span class="cf">in</span> <span class="fu">names</span>(chills[[i]]<span class="sc">$</span>data))</span>
<span id="cb312-3"><a href="plotting-future-scenarios.html#cb312-3" tabindex="-1"></a>    {ch <span class="ot">&lt;-</span> chills[[i]]<span class="sc">$</span>data[[nam]]</span>
<span id="cb312-4"><a href="plotting-future-scenarios.html#cb312-4" tabindex="-1"></a>     ch[,<span class="st">&quot;GCM&quot;</span>] <span class="ot">&lt;-</span> nam</span>
<span id="cb312-5"><a href="plotting-future-scenarios.html#cb312-5" tabindex="-1"></a>     ch[,<span class="st">&quot;SSP&quot;</span>] <span class="ot">&lt;-</span> chills[[i]]<span class="sc">$</span>caption[<span class="dv">1</span>]</span>
<span id="cb312-6"><a href="plotting-future-scenarios.html#cb312-6" tabindex="-1"></a>     ch[,<span class="st">&quot;Year&quot;</span>] <span class="ot">&lt;-</span> chills[[i]]<span class="sc">$</span>caption[<span class="dv">2</span>]</span>
<span id="cb312-7"><a href="plotting-future-scenarios.html#cb312-7" tabindex="-1"></a>     <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> nam <span class="sc">==</span> <span class="fu">names</span>(chills[[i]]<span class="sc">$</span>data)[<span class="dv">1</span>])</span>
<span id="cb312-8"><a href="plotting-future-scenarios.html#cb312-8" tabindex="-1"></a>       future_data <span class="ot">&lt;-</span> ch <span class="cf">else</span></span>
<span id="cb312-9"><a href="plotting-future-scenarios.html#cb312-9" tabindex="-1"></a>         future_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(future_data,ch)</span>
<span id="cb312-10"><a href="plotting-future-scenarios.html#cb312-10" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="plotting-future-scenarios.html#cb313-1" tabindex="-1"></a><span class="fu">plot_scenarios_gg</span>(<span class="at">past_observed =</span> past_observed,</span>
<span id="cb313-2"><a href="plotting-future-scenarios.html#cb313-2" tabindex="-1"></a>                  <span class="at">past_simulated =</span> past_simulated,</span>
<span id="cb313-3"><a href="plotting-future-scenarios.html#cb313-3" tabindex="-1"></a>                  <span class="at">future_data =</span> future_data,</span>
<span id="cb313-4"><a href="plotting-future-scenarios.html#cb313-4" tabindex="-1"></a>                  <span class="at">metric =</span> <span class="st">&quot;Frost_H&quot;</span>,</span>
<span id="cb313-5"><a href="plotting-future-scenarios.html#cb313-5" tabindex="-1"></a>                  <span class="at">axis_label =</span> <span class="st">&quot;Frost duration (in hours)&quot;</span>,</span>
<span id="cb313-6"><a href="plotting-future-scenarios.html#cb313-6" tabindex="-1"></a>                  <span class="at">time_points =</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-335-1.png" width="672" /></p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="plotting-future-scenarios.html#cb314-1" tabindex="-1"></a><span class="fu">plot_scenarios_gg</span>(<span class="at">past_observed =</span> past_observed,</span>
<span id="cb314-2"><a href="plotting-future-scenarios.html#cb314-2" tabindex="-1"></a>                  <span class="at">past_simulated =</span> past_simulated,</span>
<span id="cb314-3"><a href="plotting-future-scenarios.html#cb314-3" tabindex="-1"></a>                  <span class="at">future_data =</span> future_data,</span>
<span id="cb314-4"><a href="plotting-future-scenarios.html#cb314-4" tabindex="-1"></a>                  <span class="at">metric =</span> <span class="st">&quot;Chill_Portions&quot;</span>,</span>
<span id="cb314-5"><a href="plotting-future-scenarios.html#cb314-5" tabindex="-1"></a>                  <span class="at">axis_label =</span> <span class="st">&quot;Chill (in Chill Portions)&quot;</span>,</span>
<span id="cb314-6"><a href="plotting-future-scenarios.html#cb314-6" tabindex="-1"></a>                  <span class="at">time_points =</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-336-1.png" width="672" /></p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="plotting-future-scenarios.html#cb315-1" tabindex="-1"></a><span class="fu">plot_scenarios_gg</span>(<span class="at">past_observed =</span> past_observed,</span>
<span id="cb315-2"><a href="plotting-future-scenarios.html#cb315-2" tabindex="-1"></a>                  <span class="at">past_simulated =</span> past_simulated,</span>
<span id="cb315-3"><a href="plotting-future-scenarios.html#cb315-3" tabindex="-1"></a>                  <span class="at">future_data =</span> future_data,</span>
<span id="cb315-4"><a href="plotting-future-scenarios.html#cb315-4" tabindex="-1"></a>                  <span class="at">metric =</span> <span class="st">&quot;GDH&quot;</span>,</span>
<span id="cb315-5"><a href="plotting-future-scenarios.html#cb315-5" tabindex="-1"></a>                  <span class="at">axis_label =</span> <span class="st">&quot;Heat (in Growing Degree Hours)&quot;</span>,</span>
<span id="cb315-6"><a href="plotting-future-scenarios.html#cb315-6" tabindex="-1"></a>                  <span class="at">time_points =</span> <span class="fu">c</span>(<span class="dv">2050</span>, <span class="dv">2085</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-337-1.png" width="672" /></p>

</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="making-cmip5-scenarios-with-the-climatewizard.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jacqwng/Logbook/edit/main/18-plotting.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jacqwng/Logbook/blob/main/18-plotting.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
