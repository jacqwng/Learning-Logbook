<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Historic temperature scenarios | Tree phenology Analysis with R</title>
  <meta name="description" content="Chapter 14 Historic temperature scenarios | Tree phenology Analysis with R" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Historic temperature scenarios | Tree phenology Analysis with R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Historic temperature scenarios | Tree phenology Analysis with R" />
  
  
  

<meta name="author" content="Jacqueline Wingen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="saving-and-loading-data-and-hiding-this-in-markdown.html"/>
<link rel="next" href="future-temperature-scenarios.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tree phenology Analysis with R</a></li>
<li><a href="index.html"><img src="images/chillR_hexSticker.png" width="75%"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#learning-goals"><i class="fa fa-check"></i><b>1.1</b> Learning goals</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tools.html"><a href="tools.html"><i class="fa fa-check"></i><b>2</b> Tools</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tools.html"><a href="tools.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="tools.html"><a href="tools.html#git-and-github"><i class="fa fa-check"></i><b>2.2</b> Git and Github</a></li>
<li class="chapter" data-level="2.3" data-path="tools.html"><a href="tools.html#rmarkdown"><i class="fa fa-check"></i><b>2.3</b> Rmarkdown</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tree-dormancy.html"><a href="tree-dormancy.html"><i class="fa fa-check"></i><b>3</b> Tree dormancy</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tree-dormancy.html"><a href="tree-dormancy.html#learning-goals-1"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="tree-dormancy.html"><a href="tree-dormancy.html#introduction-to-dormancy"><i class="fa fa-check"></i><b>3.2</b> Introduction to dormancy</a></li>
<li class="chapter" data-level="3.3" data-path="tree-dormancy.html"><a href="tree-dormancy.html#dormancy-physiology"><i class="fa fa-check"></i><b>3.3</b> Dormancy physiology</a></li>
<li class="chapter" data-level="3.4" data-path="tree-dormancy.html"><a href="tree-dormancy.html#experimental-and-statistical-determination-of-chilling-and-forcing-periods"><i class="fa fa-check"></i><b>3.4</b> Experimental and statistical determination of chilling and forcing periods</a></li>
<li class="chapter" data-level="3.5" data-path="tree-dormancy.html"><a href="tree-dormancy.html#phenology-record-and-bbch-scale"><i class="fa fa-check"></i><b>3.5</b> Phenology record and BBCH scale</a></li>
<li class="chapter" data-level="3.6" data-path="tree-dormancy.html"><a href="tree-dormancy.html#excercises-on-tree-dormancy"><i class="fa fa-check"></i><b>3.6</b> <code>Excercises</code> on tree dormancy</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html"><i class="fa fa-check"></i><b>4</b> Climate change and impact projection</a>
<ul>
<li class="chapter" data-level="4.1" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#the-drivers-of-climate-change"><i class="fa fa-check"></i><b>4.1</b> The drivers of climate change</a></li>
<li class="chapter" data-level="4.2" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#whats-already-known"><i class="fa fa-check"></i><b>4.2</b> What’s already known</a></li>
<li class="chapter" data-level="4.3" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#future-scenarios"><i class="fa fa-check"></i><b>4.3</b> Future scenarios</a></li>
<li class="chapter" data-level="4.4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#impact-projections-approaches"><i class="fa fa-check"></i><b>4.4</b> Impact projections approaches</a></li>
<li class="chapter" data-level="4.5" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#exercises-on-climate-change"><i class="fa fa-check"></i><b>4.5</b> <code>Exercises</code> on climate change</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html"><i class="fa fa-check"></i><b>5</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="5.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-oman"><i class="fa fa-check"></i><b>5.2</b> Winter chill in Oman</a></li>
<li class="chapter" data-level="5.3" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-sensitivity"><i class="fa fa-check"></i><b>5.3</b> Chill model sensitivity</a></li>
<li class="chapter" data-level="5.4" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-california"><i class="fa fa-check"></i><b>5.4</b> Winter chill in California</a></li>
<li class="chapter" data-level="5.5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-ratios"><i class="fa fa-check"></i><b>5.5</b> Winter chill ratios</a></li>
<li class="chapter" data-level="5.6" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#a-global-projection-of-future-winter-chill"><i class="fa fa-check"></i><b>5.6</b> A global projection of future winter chill</a></li>
<li class="chapter" data-level="5.7" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-germany"><i class="fa fa-check"></i><b>5.7</b> Winter chill in Germany</a></li>
<li class="chapter" data-level="5.8" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-tunisia"><i class="fa fa-check"></i><b>5.8</b> Winter chill in Tunisia</a></li>
<li class="chapter" data-level="5.9" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-chile"><i class="fa fa-check"></i><b>5.9</b> Winter chill in Chile</a></li>
<li class="chapter" data-level="5.10" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-patagonia"><i class="fa fa-check"></i><b>5.10</b> Chill projection for Patagonia</a></li>
<li class="chapter" data-level="5.11" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-comparison"><i class="fa fa-check"></i><b>5.11</b> Chill model comparison</a></li>
<li class="chapter" data-level="5.12" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-all-of-tunisia"><i class="fa fa-check"></i><b>5.12</b> Chill projection for all of Tunisia</a></li>
<li class="chapter" data-level="5.13" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#revisiting-chill-accumulation-in-oman"><i class="fa fa-check"></i><b>5.13</b> Revisiting chill accumulation in Oman</a></li>
<li class="chapter" data-level="5.14" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#exercises-on-past-chill-projections"><i class="fa fa-check"></i><b>5.14</b> <code>Exercises</code> on past chill projections</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="manual-chill.html"><a href="manual-chill.html"><i class="fa fa-check"></i><b>6</b> Manual chill</a>
<ul>
<li class="chapter" data-level="6.1" data-path="manual-chill.html"><a href="manual-chill.html#learning-goals-3"><i class="fa fa-check"></i><b>6.1</b> Learning goals</a></li>
<li class="chapter" data-level="6.2" data-path="manual-chill.html"><a href="manual-chill.html#chilling-hours-calculation-using-chillr"><i class="fa fa-check"></i><b>6.2</b> Chilling hours calculation using chillR</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="manual-chill.html"><a href="manual-chill.html#data-requirements"><i class="fa fa-check"></i><b>6.2.1</b> <strong>Data Requirements</strong></a></li>
<li class="chapter" data-level="6.2.2" data-path="manual-chill.html"><a href="manual-chill.html#loading-and-preparing-data"><i class="fa fa-check"></i><b>6.2.2</b> Loading and Preparing Data</a></li>
<li class="chapter" data-level="6.2.3" data-path="manual-chill.html"><a href="manual-chill.html#manual-calculation-of-chilling-hours"><i class="fa fa-check"></i><b>6.2.3</b> <strong>Manual Calculation of Chilling Hours</strong></a></li>
<li class="chapter" data-level="6.2.4" data-path="manual-chill.html"><a href="manual-chill.html#automation-with-functions"><i class="fa fa-check"></i><b>6.2.4</b> Automation with Functions</a></li>
<li class="chapter" data-level="6.2.5" data-path="manual-chill.html"><a href="manual-chill.html#application-example"><i class="fa fa-check"></i><b>6.2.5</b> Application Example</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="manual-chill.html"><a href="manual-chill.html#exercises-on-basic-chill-modeling"><i class="fa fa-check"></i><b>6.3</b> <code>Exercises</code> on basic chill modeling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chill.html"><a href="chill.html"><i class="fa fa-check"></i><b>7</b> Chill</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chill.html"><a href="chill.html#learning-goals-4"><i class="fa fa-check"></i><b>7.1</b> Learning goals</a></li>
<li class="chapter" data-level="7.2" data-path="chill.html"><a href="chill.html#chilling_hours-function"><i class="fa fa-check"></i><b>7.2</b> <code>Chilling_Hours()</code> function</a></li>
<li class="chapter" data-level="7.3" data-path="chill.html"><a href="chill.html#utah-model"><i class="fa fa-check"></i><b>7.3</b> Utah Model</a></li>
<li class="chapter" data-level="7.4" data-path="chill.html"><a href="chill.html#creating-custom-chill-models-with-step_model"><i class="fa fa-check"></i><b>7.4</b> Creating Custom Chill Models with <code>step_model()</code></a></li>
<li class="chapter" data-level="7.5" data-path="chill.html"><a href="chill.html#dynamic-model"><i class="fa fa-check"></i><b>7.5</b> Dynamic model</a></li>
<li class="chapter" data-level="7.6" data-path="chill.html"><a href="chill.html#chilling-and-tempresponse-functions"><i class="fa fa-check"></i><b>7.6</b> <code>Chilling</code> and <code>tempResponse</code> functions</a></li>
<li class="chapter" data-level="7.7" data-path="chill.html"><a href="chill.html#exercises-on-chill-models"><i class="fa fa-check"></i><b>7.7</b> <code>Exercises</code> on chill models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html"><i class="fa fa-check"></i><b>8</b> Making hourly temperatures</a>
<ul>
<li class="chapter" data-level="8.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#learning-goals-5"><i class="fa fa-check"></i><b>8.1</b> Learning goals</a></li>
<li class="chapter" data-level="8.2" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#generating-hourly-temperatures"><i class="fa fa-check"></i><b>8.2</b> Generating hourly temperatures</a></li>
<li class="chapter" data-level="8.3" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#idealized-daily-temperature-curves"><i class="fa fa-check"></i><b>8.3</b> Idealized daily temperature curves</a></li>
<li class="chapter" data-level="8.4" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#empirical-daily-temperature-curves"><i class="fa fa-check"></i><b>8.4</b> Empirical daily temperature curves</a></li>
<li class="chapter" data-level="8.5" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#exercises-on-hourly-temperatures"><i class="fa fa-check"></i><b>8.5</b> <code>Exercises</code> on hourly temperatures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html"><i class="fa fa-check"></i><b>9</b> Some useful tools in R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#learning-goals-6"><i class="fa fa-check"></i><b>9.1</b> Learning goals</a></li>
<li class="chapter" data-level="9.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#an-evolving-language---and-a-lifelong-learning-process"><i class="fa fa-check"></i><b>9.2</b> An evolving language - and a lifelong learning process</a></li>
<li class="chapter" data-level="9.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyverse"><i class="fa fa-check"></i><b>9.3</b> The <code>tidyverse</code></a></li>
<li class="chapter" data-level="9.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-ggplot2-package"><i class="fa fa-check"></i><b>9.4</b> The <code>ggplot2</code> package</a></li>
<li class="chapter" data-level="9.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tibble-package"><i class="fa fa-check"></i><b>9.5</b> The <code>tibble</code> package</a></li>
<li class="chapter" data-level="9.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-magrittr-package---pipes"><i class="fa fa-check"></i><b>9.6</b> The <code>magrittr</code> package - pipes</a></li>
<li class="chapter" data-level="9.7" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyr-package"><i class="fa fa-check"></i><b>9.7</b> The <code>tidyr</code> package</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_longer"><i class="fa fa-check"></i><b>9.7.1</b> <code>pivot_longer</code></a></li>
<li class="chapter" data-level="9.7.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_wider"><i class="fa fa-check"></i><b>9.7.2</b> <code>pivot_wider</code></a></li>
<li class="chapter" data-level="9.7.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#select"><i class="fa fa-check"></i><b>9.7.3</b> <code>select</code></a></li>
<li class="chapter" data-level="9.7.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#filter"><i class="fa fa-check"></i><b>9.7.4</b> <code>filter</code></a></li>
<li class="chapter" data-level="9.7.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#mutate"><i class="fa fa-check"></i><b>9.7.5</b> <code>mutate</code></a></li>
<li class="chapter" data-level="9.7.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#arrange"><i class="fa fa-check"></i><b>9.7.6</b> <code>arrange</code></a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#loops"><i class="fa fa-check"></i><b>9.8</b> Loops</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#for-loops"><i class="fa fa-check"></i><b>9.8.1</b> <em>For</em> loops</a></li>
<li class="chapter" data-level="9.8.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#while-loops"><i class="fa fa-check"></i><b>9.8.2</b> <em>While</em> loops</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply-functions"><i class="fa fa-check"></i><b>9.9</b> <code>apply</code> functions</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#sapply"><i class="fa fa-check"></i><b>9.9.1</b> <code>sapply</code></a></li>
<li class="chapter" data-level="9.9.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#lapply"><i class="fa fa-check"></i><b>9.9.2</b> <code>lapply</code></a></li>
<li class="chapter" data-level="9.9.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply"><i class="fa fa-check"></i><b>9.9.3</b> <code>apply</code></a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#exercises-on-useful-r-tools"><i class="fa fa-check"></i><b>9.10</b> <code>Exercises</code> on useful R tools</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html"><i class="fa fa-check"></i><b>10</b> Getting temperature data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#learning-goals-for-this-lesson"><i class="fa fa-check"></i><b>10.1</b> Learning goals for this lesson</a></li>
<li class="chapter" data-level="10.2" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#temperature-data-needs"><i class="fa fa-check"></i><b>10.2</b> Temperature data needs</a></li>
<li class="chapter" data-level="10.3" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#the-global-summary-of-the-day-database"><i class="fa fa-check"></i><b>10.3</b> The Global Summary of the Day database</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#actionlist_stations"><i class="fa fa-check"></i><b>10.3.1</b> <code>action=list_stations</code></a></li>
<li class="chapter" data-level="10.3.2" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#actiondownload_weather"><i class="fa fa-check"></i><b>10.3.2</b> <code>action="download_weather"</code></a></li>
<li class="chapter" data-level="10.3.3" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#downloaded-weather-as-action-argument"><i class="fa fa-check"></i><b>10.3.3</b> downloaded weather as <code>action</code> argument</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#exercises-on-getting-temperature-data"><i class="fa fa-check"></i><b>10.4</b> <code>Exercises</code> on getting temperature data</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tree phenology Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="historic-temperature-scenarios" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">Chapter 14</span> Historic temperature scenarios<a href="historic-temperature-scenarios.html#historic-temperature-scenarios" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-goals-for-this-lesson-1" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> Learning goals for this lesson<a href="historic-temperature-scenarios.html#learning-goals-for-this-lesson-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Understand how we can include temperature scenarios while generating synthetic weather</li>
<li>Be able to produce temperature scenarios with arbitrary change scenarios imposed</li>
<li>Understand the difference between absolute and relative temperature scenarios and the importance of baselines (for relative scenarios)</li>
<li>Learn how to produce temperature scenarios that represent past points in time from historic temperature records</li>
<li>Learn how to produce synthetic temperature scenarios for past points in time and efficiently compute agroclimatic metrics for them</li>
</ul>
</div>
<div id="climate-change-scenarios" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">14.2</span> Climate change scenarios<a href="historic-temperature-scenarios.html#climate-change-scenarios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A weather generator accessed through <code>chillR</code> can produce agroclimatic profiles for specific locations. Calibration with historical temperature data makes the generated profile representative of the climate during the calibration period. This weather generator can also simulate various climate scenarios using the <code>temperature_scenario</code> parameter in the <code>temperature_generation</code> function.</p>
<p>The <code>temperature_scenario</code> parameter requires a <code>data.frame</code> with columns <code>Tmin</code> and <code>Tmax</code>, each containing 12 values that specify monthly adjustments to the mean minimum and maximum temperatures. Without this parameter, the function defaults to a <code>data.frame</code> with zero adjustments, indicating no change.</p>
<p>A simple climate change scenario can be created by adding arbitrary values to each month’s <code>Tmin</code> and <code>Tmax:</code></p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="historic-temperature-scenarios.html#cb196-1" tabindex="-1"></a><span class="co"># Here&#39;s the call from the earlier lesson. We don&#39;t have to run this again.</span></span>
<span id="cb196-2"><a href="historic-temperature-scenarios.html#cb196-2" tabindex="-1"></a>Temp <span class="ot">&lt;-</span> <span class="fu">temperature_generation</span>(KA_weather,</span>
<span id="cb196-3"><a href="historic-temperature-scenarios.html#cb196-3" tabindex="-1"></a>                               <span class="at">years =</span> <span class="fu">c</span>(<span class="dv">1998</span>,<span class="dv">2005</span>),</span>
<span id="cb196-4"><a href="historic-temperature-scenarios.html#cb196-4" tabindex="-1"></a>                               <span class="at">sim_years =</span> <span class="fu">c</span>(<span class="dv">2001</span>,<span class="dv">2100</span>))</span>
<span id="cb196-5"><a href="historic-temperature-scenarios.html#cb196-5" tabindex="-1"></a> </span>
<span id="cb196-6"><a href="historic-temperature-scenarios.html#cb196-6" tabindex="-1"></a><span class="co"># Now we make a temperature scenario that raises all temperatures by 2°C</span></span></code></pre></div>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="historic-temperature-scenarios.html#cb197-1" tabindex="-1"></a>change_scenario <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Tmin =</span> <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">12</span>),</span>
<span id="cb197-2"><a href="historic-temperature-scenarios.html#cb197-2" tabindex="-1"></a>                              <span class="at">Tmax =</span> <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">12</span>))</span>
<span id="cb197-3"><a href="historic-temperature-scenarios.html#cb197-3" tabindex="-1"></a></span>
<span id="cb197-4"><a href="historic-temperature-scenarios.html#cb197-4" tabindex="-1"></a>change_scenario</span></code></pre></div>
<table class="table table-striped" style="font-size: 14px; color: black; ">
<thead>
<tr>
<th style="text-align:center;">
Tmin
</th>
<th style="text-align:center;">
Tmax
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="historic-temperature-scenarios.html#cb198-1" tabindex="-1"></a>Temp_2 <span class="ot">&lt;-</span> <span class="fu">temperature_generation</span>(KA_weather,</span>
<span id="cb198-2"><a href="historic-temperature-scenarios.html#cb198-2" tabindex="-1"></a>                                 <span class="at">years =</span> <span class="fu">c</span>(<span class="dv">1998</span>,<span class="dv">2005</span>),</span>
<span id="cb198-3"><a href="historic-temperature-scenarios.html#cb198-3" tabindex="-1"></a>                                 <span class="at">sim_years =</span> <span class="fu">c</span>(<span class="dv">2001</span>,<span class="dv">2100</span>),</span>
<span id="cb198-4"><a href="historic-temperature-scenarios.html#cb198-4" tabindex="-1"></a>                                 <span class="at">temperature_scenario =</span> change_scenario)</span>
<span id="cb198-5"><a href="historic-temperature-scenarios.html#cb198-5" tabindex="-1"></a></span>
<span id="cb198-6"><a href="historic-temperature-scenarios.html#cb198-6" tabindex="-1"></a>Temperature_scenarios <span class="ot">&lt;-</span> KA_weather <span class="sc">%&gt;%</span></span>
<span id="cb198-7"><a href="historic-temperature-scenarios.html#cb198-7" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">%in%</span> <span class="dv">1998</span><span class="sc">:</span><span class="dv">2005</span>) <span class="sc">%&gt;%</span></span>
<span id="cb198-8"><a href="historic-temperature-scenarios.html#cb198-8" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">Data_source =</span> <span class="st">&quot;observed&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb198-9"><a href="historic-temperature-scenarios.html#cb198-9" tabindex="-1"></a>  <span class="fu">rbind</span>(Temp[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb198-10"><a href="historic-temperature-scenarios.html#cb198-10" tabindex="-1"></a>          <span class="fu">select</span>(<span class="fu">c</span>(Year, Month, Day, Tmin, Tmax)) <span class="sc">%&gt;%</span> </span>
<span id="cb198-11"><a href="historic-temperature-scenarios.html#cb198-11" tabindex="-1"></a>          <span class="fu">cbind</span>(<span class="at">Data_source =</span> <span class="st">&quot;simulated&quot;</span>)</span>
<span id="cb198-12"><a href="historic-temperature-scenarios.html#cb198-12" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb198-13"><a href="historic-temperature-scenarios.html#cb198-13" tabindex="-1"></a>  <span class="fu">rbind</span>(Temp_2[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb198-14"><a href="historic-temperature-scenarios.html#cb198-14" tabindex="-1"></a>          <span class="fu">select</span>(<span class="fu">c</span>(Year, Month, Day, Tmin, Tmax)) <span class="sc">%&gt;%</span> </span>
<span id="cb198-15"><a href="historic-temperature-scenarios.html#cb198-15" tabindex="-1"></a>          <span class="fu">cbind</span>(<span class="at">Data_source =</span> <span class="st">&quot;Warming_2C&quot;</span>)</span>
<span id="cb198-16"><a href="historic-temperature-scenarios.html#cb198-16" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb198-17"><a href="historic-temperature-scenarios.html#cb198-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">ISOdate</span>(<span class="dv">2000</span>,</span>
<span id="cb198-18"><a href="historic-temperature-scenarios.html#cb198-18" tabindex="-1"></a>                                Month,</span>
<span id="cb198-19"><a href="historic-temperature-scenarios.html#cb198-19" tabindex="-1"></a>                                Day)))</span></code></pre></div>
<p>Due to the identical structure of this dataset to the one used in the previous lesson, the same code can be applied with only the <code>data.frame</code> name needing adjustment:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="historic-temperature-scenarios.html#cb199-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Temperature_scenarios, </span>
<span id="cb199-2"><a href="historic-temperature-scenarios.html#cb199-2" tabindex="-1"></a>       <span class="fu">aes</span>(Date,Tmin)) <span class="sc">+</span></span>
<span id="cb199-3"><a href="historic-temperature-scenarios.html#cb199-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(Year))) <span class="sc">+</span></span>
<span id="cb199-4"><a href="historic-temperature-scenarios.html#cb199-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Data_source)) <span class="sc">+</span></span>
<span id="cb199-5"><a href="historic-temperature-scenarios.html#cb199-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb199-6"><a href="historic-temperature-scenarios.html#cb199-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb199-7"><a href="historic-temperature-scenarios.html#cb199-7" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">&quot;%b&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/weather_generator_set_up_plot_scenarios-1.png" width="672" /></p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="historic-temperature-scenarios.html#cb200-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Temperature_scenarios,</span>
<span id="cb200-2"><a href="historic-temperature-scenarios.html#cb200-2" tabindex="-1"></a>       <span class="fu">aes</span>(Date,Tmax)) <span class="sc">+</span></span>
<span id="cb200-3"><a href="historic-temperature-scenarios.html#cb200-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(Year))) <span class="sc">+</span></span>
<span id="cb200-4"><a href="historic-temperature-scenarios.html#cb200-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Data_source)) <span class="sc">+</span></span>
<span id="cb200-5"><a href="historic-temperature-scenarios.html#cb200-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb200-6"><a href="historic-temperature-scenarios.html#cb200-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb200-7"><a href="historic-temperature-scenarios.html#cb200-7" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">&quot;%b&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/weather_generator_set_up_plot_scenarios-2.png" width="672" /></p>
<p>The scenario is simplified, with future changes uniformly distributed across all months—an approach that doesn’t reflect historical patterns and is unlikely for the future. However, this method closely resembles an early attempt at modeling climate change scenarios, as illustrated in the figure from the initial publication on chilling.</p>
<p>![Chill scenarios for a mountain oasis in Oman according (<a href="https://link.springer.com/article/10.1007/s10584-009-9581-7">Luedeling et al., 2009b)</a>(images/Luedeling_JPG_Figure_10_Future_chilling (1).jpg)</p>
<p>To create more realistic scenarios, specific years from historical records are used, considering both the expected typical temperature conditions of the time and actual recorded data. This approach clarifies historical climate trends by focusing on gradual climate shifts, avoiding distortions from random annual variations or extreme outliers that might obscure trend analysis.</p>
</div>
<div id="making-historic-temperature-scenarios" class="section level2 hasAnchor" number="14.3">
<h2><span class="header-section-number">14.3</span> Making historic temperature scenarios<a href="historic-temperature-scenarios.html#making-historic-temperature-scenarios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A long-term dataset is essential for this exercise, and the process of obtaining and preparing this data for use in <code>chillR</code> has already been covered.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="historic-temperature-scenarios.html#cb201-1" tabindex="-1"></a><span class="co"># download weather station list for the vicinity of Bonn</span></span>
<span id="cb201-2"><a href="historic-temperature-scenarios.html#cb201-2" tabindex="-1"></a>station_list <span class="ot">&lt;-</span> <span class="fu">handle_gsod</span>(<span class="at">action =</span> <span class="st">&quot;list_stations&quot;</span>,</span>
<span id="cb201-3"><a href="historic-temperature-scenarios.html#cb201-3" tabindex="-1"></a>                            <span class="at">location=</span><span class="fu">c</span>(<span class="fl">7.1</span>,<span class="fl">50.8</span>))</span>
<span id="cb201-4"><a href="historic-temperature-scenarios.html#cb201-4" tabindex="-1"></a></span>
<span id="cb201-5"><a href="historic-temperature-scenarios.html#cb201-5" tabindex="-1"></a><span class="co"># download weather data for Cologne/Bonn airport and convert it to chillR format</span></span>
<span id="cb201-6"><a href="historic-temperature-scenarios.html#cb201-6" tabindex="-1"></a>Bonn_weather <span class="ot">&lt;-</span> <span class="fu">handle_gsod</span>(<span class="at">action =</span> <span class="st">&quot;download_weather&quot;</span>,</span>
<span id="cb201-7"><a href="historic-temperature-scenarios.html#cb201-7" tabindex="-1"></a>                            <span class="at">location =</span> station_list<span class="sc">$</span>chillR_code[<span class="dv">1</span>],</span>
<span id="cb201-8"><a href="historic-temperature-scenarios.html#cb201-8" tabindex="-1"></a>                            <span class="at">time_interval =</span> <span class="fu">c</span>(<span class="dv">1973</span>,<span class="dv">2019</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb201-9"><a href="historic-temperature-scenarios.html#cb201-9" tabindex="-1"></a>  <span class="fu">handle_gsod</span>()</span>
<span id="cb201-10"><a href="historic-temperature-scenarios.html#cb201-10" tabindex="-1"></a></span>
<span id="cb201-11"><a href="historic-temperature-scenarios.html#cb201-11" tabindex="-1"></a><span class="co"># check record for missing data</span></span>
<span id="cb201-12"><a href="historic-temperature-scenarios.html#cb201-12" tabindex="-1"></a><span class="fu">fix_weather</span>(Bonn_weather<span class="sc">$</span><span class="st">`</span><span class="at">KOLN BONN</span><span class="st">`</span>)<span class="sc">$</span>QC</span>
<span id="cb201-13"><a href="historic-temperature-scenarios.html#cb201-13" tabindex="-1"></a></span>
<span id="cb201-14"><a href="historic-temperature-scenarios.html#cb201-14" tabindex="-1"></a><span class="co"># (incidentally almost all gaps are for years covered by the KA_weather dataset)</span></span>
<span id="cb201-15"><a href="historic-temperature-scenarios.html#cb201-15" tabindex="-1"></a>Bonn_patched <span class="ot">&lt;-</span> <span class="fu">patch_daily_temperatures</span>(</span>
<span id="cb201-16"><a href="historic-temperature-scenarios.html#cb201-16" tabindex="-1"></a>  <span class="at">weather =</span> Bonn_weather<span class="sc">$</span><span class="st">`</span><span class="at">KOLN BONN</span><span class="st">`</span>,</span>
<span id="cb201-17"><a href="historic-temperature-scenarios.html#cb201-17" tabindex="-1"></a>  <span class="at">patch_weather =</span> <span class="fu">list</span>(KA_weather))</span>
<span id="cb201-18"><a href="historic-temperature-scenarios.html#cb201-18" tabindex="-1"></a></span>
<span id="cb201-19"><a href="historic-temperature-scenarios.html#cb201-19" tabindex="-1"></a><span class="fu">fix_weather</span>(Bonn_patched)<span class="sc">$</span>QC</span>
<span id="cb201-20"><a href="historic-temperature-scenarios.html#cb201-20" tabindex="-1"></a></span>
<span id="cb201-21"><a href="historic-temperature-scenarios.html#cb201-21" tabindex="-1"></a><span class="co"># There are still 4 days missing here, out of 47 years -</span></span>
<span id="cb201-22"><a href="historic-temperature-scenarios.html#cb201-22" tabindex="-1"></a><span class="co"># let&#39;s simply interpolate these gaps now</span></span>
<span id="cb201-23"><a href="historic-temperature-scenarios.html#cb201-23" tabindex="-1"></a></span>
<span id="cb201-24"><a href="historic-temperature-scenarios.html#cb201-24" tabindex="-1"></a>Bonn <span class="ot">&lt;-</span> <span class="fu">fix_weather</span>(Bonn_patched)</span>
<span id="cb201-25"><a href="historic-temperature-scenarios.html#cb201-25" tabindex="-1"></a></span>
<span id="cb201-26"><a href="historic-temperature-scenarios.html#cb201-26" tabindex="-1"></a>Bonn_temps <span class="ot">&lt;-</span> Bonn<span class="sc">$</span>weather</span></code></pre></div>
<p>To create weather scenarios representing specific years like 1980, 1990, 2000, and 2010, despite using data centered around the median year of 1996 (due to gradual temperature increases from 1973 to 2019), adjustments must be made to account for historical changes. The process involves analyzing the historical temperature record to quantify shifts between the <strong>baseline</strong> year (the reference year of the dataset) and each target <strong>simulation year</strong>.</p>
<p>The <code>chillR</code> package provides a function, <code>temperature_scenario_from_records</code>, designed for this purpose. This function allows for the creation of temperature scenarios based on past records, facilitating the generation of simulations that accurately reflect historical conditions for specified years:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="historic-temperature-scenarios.html#cb202-1" tabindex="-1"></a>scenario_1980 <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_from_records</span>(<span class="at">weather =</span> Bonn_temps,</span>
<span id="cb202-2"><a href="historic-temperature-scenarios.html#cb202-2" tabindex="-1"></a>                                                   <span class="at">year =</span> <span class="dv">1980</span>)</span></code></pre></div>
<p>This scenario involves several components:</p>
<ul>
<li><p><code>data</code>: A data frame containing the minimum (<code>Tmin</code>) and maximum (<code>Tmax</code>) temperatures that are representative of the year of interest.</p></li>
<li><p><code>scenario_year</code>: The specific year for which the scenario is being created.</p></li>
<li><p><code>reference_year</code>: This would be used if the scenario involved temperature changes relative to another year, but in this case, it is set to NA since we are working with absolute temperatures.</p></li>
<li><p><code>scenario_type</code>: Indicates whether the scenario presents absolute temperatures for the year of interest (true in this case) or changes relative to another year.</p></li>
<li><p><code>labels</code>: Additional information attached to the scenario, such as “running mean scenario,” which provides further context or explanation about the nature of the scenario.</p></li>
</ul>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="historic-temperature-scenarios.html#cb203-1" tabindex="-1"></a>scenario_1980<span class="sc">$</span><span class="st">&#39;1980&#39;</span><span class="sc">$</span>data</span></code></pre></div>
<table class="table table-striped" style="font-size: 14px; color: black; ">
<thead>
<tr>
<th style="text-align:center;">
Tmin
</th>
<th style="text-align:center;">
Tmax
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
-1.6792086
</td>
<td style="text-align:center;">
4.374077
</td>
</tr>
<tr>
<td style="text-align:center;">
-2.3167936
</td>
<td style="text-align:center;">
5.580554
</td>
</tr>
<tr>
<td style="text-align:center;">
0.8537656
</td>
<td style="text-align:center;">
9.763557
</td>
</tr>
<tr>
<td style="text-align:center;">
2.8043289
</td>
<td style="text-align:center;">
13.474438
</td>
</tr>
<tr>
<td style="text-align:center;">
6.8980925
</td>
<td style="text-align:center;">
18.016243
</td>
</tr>
<tr>
<td style="text-align:center;">
10.4950644
</td>
<td style="text-align:center;">
21.370489
</td>
</tr>
<tr>
<td style="text-align:center;">
12.3964194
</td>
<td style="text-align:center;">
23.175626
</td>
</tr>
<tr>
<td style="text-align:center;">
11.8548366
</td>
<td style="text-align:center;">
23.186135
</td>
</tr>
<tr>
<td style="text-align:center;">
9.2693867
</td>
<td style="text-align:center;">
19.827527
</td>
</tr>
<tr>
<td style="text-align:center;">
5.8487484
</td>
<td style="text-align:center;">
14.443617
</td>
</tr>
<tr>
<td style="text-align:center;">
2.2375311
</td>
<td style="text-align:center;">
9.076796
</td>
</tr>
<tr>
<td style="text-align:center;">
0.1126710
</td>
<td style="text-align:center;">
6.024129
</td>
</tr>
</tbody>
</table>
<p>The warning message received when first running the weather generator highlighted a few important points:</p>
<ul>
<li><p><em>scenario doesn’t contain named elements - consider using the following element names: ‘data’, ‘reference_year’,‘scenario_type’,‘labels’</em></p></li>
<li><p><em>setting scenario_type to ‘relative’</em></p></li>
<li><p><em>Reference year missing - can’t check if relative temperature scenario is valid</em></p></li>
</ul>
<p>The warning message previously encountered highlighted the missing elements in the input data frame. Scenarios require more information, and when this is absent, the temperature generation function makes assumptions about how to proceed. Specifically, the <strong>scenario_type</strong> was automatically set to <strong>‘relative’</strong>, as the function had to determine whether the scenario represented absolute or relative temperatures. Additionally, the absence of a <strong>reference_year</strong> meant the function couldn’t identify the baseline for the relative temperature scenario.</p>
<p>With the updated scenario, which now includes all necessary information - such as <strong>data</strong>, <strong>scenario_year</strong>, <strong>reference_year</strong>, <strong>scenario_type</strong>, and <strong>labels</strong> - these warnings should no longer occur. The temperature generation function can now be run correctly with this complete set of details:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="historic-temperature-scenarios.html#cb204-1" tabindex="-1"></a>temps_1980 <span class="ot">&lt;-</span> <span class="fu">temperature_generation</span>(<span class="at">weather =</span> Bonn_temps,</span>
<span id="cb204-2"><a href="historic-temperature-scenarios.html#cb204-2" tabindex="-1"></a>                                     <span class="at">years =</span> <span class="fu">c</span>(<span class="dv">1973</span>,<span class="dv">2019</span>),</span>
<span id="cb204-3"><a href="historic-temperature-scenarios.html#cb204-3" tabindex="-1"></a>                                     <span class="at">sim_years =</span> <span class="fu">c</span>(<span class="dv">2001</span>,<span class="dv">2100</span>),</span>
<span id="cb204-4"><a href="historic-temperature-scenarios.html#cb204-4" tabindex="-1"></a>                                     <span class="at">temperature_scenario =</span> scenario_1980)</span></code></pre></div>
<p>Despite providing all the necessary information in the updated scenario, a warning message was still encountered:</p>
<p>“Absolute temperature scenario specified - calibration weather record only used for simulating temperature variation, but not for the means”</p>
<p>The weather generator evaluated the calibration dataset by considering the variation of temperatures around the mean values. It then produced a new dataset with mean temperatures (for both <strong>Tmin</strong> and <strong>Tmax</strong>) for each month that correspond to the absolute temperature scenario provided. The variation in this generated dataset was similar to the observed temperature variation, which was the intended outcome.</p>
<p>To convert this absolute temperature scenario into a relative one, a baseline scenario needs to be specified for comparison. In this case, 1996 is chosen as the baseline year, since it represents the median year of the observed record. A scenario for that year can now be created as the reference for comparison:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="historic-temperature-scenarios.html#cb205-1" tabindex="-1"></a>scenario_1996 <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_from_records</span>(<span class="at">weather =</span> Bonn_temps,</span>
<span id="cb205-2"><a href="historic-temperature-scenarios.html#cb205-2" tabindex="-1"></a>                                                   <span class="at">year =</span> <span class="dv">1996</span>)</span></code></pre></div>
<p>The 1996 scenario is an absolute temperature scenario. To convert it to a relative change scenario, the <code>temperature_scenario_baseline_adjustment</code> function is used, which adjusts the temperatures based on the baseline scenario.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="historic-temperature-scenarios.html#cb206-1" tabindex="-1"></a>relative_scenario <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_baseline_adjustment</span>(</span>
<span id="cb206-2"><a href="historic-temperature-scenarios.html#cb206-2" tabindex="-1"></a>  <span class="at">baseline =</span> scenario_1996,</span>
<span id="cb206-3"><a href="historic-temperature-scenarios.html#cb206-3" tabindex="-1"></a>  <span class="at">temperature_scenario =</span> scenario_1980)</span></code></pre></div>
<p>Now, a relative change scenario has been created, which contains the following elements:</p>
<ul>
<li><p><code>data</code>: A data frame with <strong>Tmin</strong> and <strong>Tmax</strong> columns, representing the relative changes in temperatures between 1996 and 1980 (all negative values, as 1980 was cooler than 1996).</p></li>
<li><p><code>scenario_year</code>: 1980</p></li>
<li><p><code>reference_year</code>: 1996</p></li>
<li><p><code>scenario_type</code>: ‘relative’</p></li>
<li><p><code>labels</code>: ‘running mean scenario’</p></li>
</ul>
<p>The relative change scenario can now be applied similarly to previous scenarios:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="historic-temperature-scenarios.html#cb207-1" tabindex="-1"></a>temps_1980<span class="ot">&lt;-</span><span class="fu">temperature_generation</span>(<span class="at">weather =</span> Bonn_temps,</span>
<span id="cb207-2"><a href="historic-temperature-scenarios.html#cb207-2" tabindex="-1"></a>                                   <span class="at">years =</span> <span class="fu">c</span>(<span class="dv">1973</span>,<span class="dv">2019</span>),</span>
<span id="cb207-3"><a href="historic-temperature-scenarios.html#cb207-3" tabindex="-1"></a>                                   <span class="at">sim_years =</span> <span class="fu">c</span>(<span class="dv">2001</span>,<span class="dv">2100</span>),</span>
<span id="cb207-4"><a href="historic-temperature-scenarios.html#cb207-4" tabindex="-1"></a>                                   <span class="at">temperature_scenario =</span> relative_scenario)</span></code></pre></div>
<p>This time, no warning message appeared because all the necessary information was provided to the <code>temperature_generation</code> function. Now, all the intended scenarios can be created easily, as most functions support vectors and lists, not just single values or data frames.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="historic-temperature-scenarios.html#cb208-1" tabindex="-1"></a>all_past_scenarios <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_from_records</span>(</span>
<span id="cb208-2"><a href="historic-temperature-scenarios.html#cb208-2" tabindex="-1"></a>  <span class="at">weather =</span> Bonn_temps,</span>
<span id="cb208-3"><a href="historic-temperature-scenarios.html#cb208-3" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">c</span>(<span class="dv">1980</span>,</span>
<span id="cb208-4"><a href="historic-temperature-scenarios.html#cb208-4" tabindex="-1"></a>           <span class="dv">1990</span>,</span>
<span id="cb208-5"><a href="historic-temperature-scenarios.html#cb208-5" tabindex="-1"></a>           <span class="dv">2000</span>,</span>
<span id="cb208-6"><a href="historic-temperature-scenarios.html#cb208-6" tabindex="-1"></a>           <span class="dv">2010</span>))</span>
<span id="cb208-7"><a href="historic-temperature-scenarios.html#cb208-7" tabindex="-1"></a></span>
<span id="cb208-8"><a href="historic-temperature-scenarios.html#cb208-8" tabindex="-1"></a>adjusted_scenarios <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_baseline_adjustment</span>(</span>
<span id="cb208-9"><a href="historic-temperature-scenarios.html#cb208-9" tabindex="-1"></a>  <span class="at">baseline =</span> scenario_1996,</span>
<span id="cb208-10"><a href="historic-temperature-scenarios.html#cb208-10" tabindex="-1"></a>  <span class="at">temperature_scenario =</span> all_past_scenarios)</span>
<span id="cb208-11"><a href="historic-temperature-scenarios.html#cb208-11" tabindex="-1"></a></span>
<span id="cb208-12"><a href="historic-temperature-scenarios.html#cb208-12" tabindex="-1"></a>all_past_scenario_temps <span class="ot">&lt;-</span> <span class="fu">temperature_generation</span>(</span>
<span id="cb208-13"><a href="historic-temperature-scenarios.html#cb208-13" tabindex="-1"></a>  <span class="at">weather =</span> Bonn_temps,</span>
<span id="cb208-14"><a href="historic-temperature-scenarios.html#cb208-14" tabindex="-1"></a>  <span class="at">years =</span> <span class="fu">c</span>(<span class="dv">1973</span>,<span class="dv">2019</span>),</span>
<span id="cb208-15"><a href="historic-temperature-scenarios.html#cb208-15" tabindex="-1"></a>  <span class="at">sim_years =</span> <span class="fu">c</span>(<span class="dv">2001</span>,<span class="dv">2100</span>),</span>
<span id="cb208-16"><a href="historic-temperature-scenarios.html#cb208-16" tabindex="-1"></a>  <span class="at">temperature_scenario =</span> adjusted_scenarios)</span>
<span id="cb208-17"><a href="historic-temperature-scenarios.html#cb208-17" tabindex="-1"></a></span>
<span id="cb208-18"><a href="historic-temperature-scenarios.html#cb208-18" tabindex="-1"></a><span class="fu">save_temperature_scenarios</span>(all_past_scenario_temps, <span class="st">&quot;data&quot;</span>, <span class="st">&quot;Bonn_hist_scenarios&quot;</span>)</span></code></pre></div>
<p>To calculate chill accumulation, instead of manually applying each function to the four generated temperature scenarios, the <code>tempResponse_daily_list</code> function from <code>chillR</code> can be used, as it automates the process. Additionally, a simple frost model will be created, with the Dynamic Model and GDH Model selected for evaluation.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="historic-temperature-scenarios.html#cb209-1" tabindex="-1"></a>frost_model <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb209-2"><a href="historic-temperature-scenarios.html#cb209-2" tabindex="-1"></a>  <span class="fu">step_model</span>(x,</span>
<span id="cb209-3"><a href="historic-temperature-scenarios.html#cb209-3" tabindex="-1"></a>             <span class="fu">data.frame</span>(</span>
<span id="cb209-4"><a href="historic-temperature-scenarios.html#cb209-4" tabindex="-1"></a>               <span class="at">lower=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000</span>,<span class="dv">0</span>),</span>
<span id="cb209-5"><a href="historic-temperature-scenarios.html#cb209-5" tabindex="-1"></a>               <span class="at">upper=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1000</span>),</span>
<span id="cb209-6"><a href="historic-temperature-scenarios.html#cb209-6" tabindex="-1"></a>               <span class="at">weight=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)))</span>
<span id="cb209-7"><a href="historic-temperature-scenarios.html#cb209-7" tabindex="-1"></a></span>
<span id="cb209-8"><a href="historic-temperature-scenarios.html#cb209-8" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Chill_Portions =</span> Dynamic_Model,</span>
<span id="cb209-9"><a href="historic-temperature-scenarios.html#cb209-9" tabindex="-1"></a>               <span class="at">GDH =</span> GDH,</span>
<span id="cb209-10"><a href="historic-temperature-scenarios.html#cb209-10" tabindex="-1"></a>               <span class="at">Frost_H =</span> frost_model)</span></code></pre></div>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="historic-temperature-scenarios.html#cb210-1" tabindex="-1"></a>chill_hist_scenario_list <span class="ot">&lt;-</span> <span class="fu">tempResponse_daily_list</span>(all_past_scenario_temps,</span>
<span id="cb210-2"><a href="historic-temperature-scenarios.html#cb210-2" tabindex="-1"></a>                                                    <span class="at">latitude =</span> <span class="fl">50.9</span>,</span>
<span id="cb210-3"><a href="historic-temperature-scenarios.html#cb210-3" tabindex="-1"></a>                                                    <span class="at">Start_JDay =</span> <span class="dv">305</span>,</span>
<span id="cb210-4"><a href="historic-temperature-scenarios.html#cb210-4" tabindex="-1"></a>                                                    <span class="at">End_JDay =</span> <span class="dv">59</span>,</span>
<span id="cb210-5"><a href="historic-temperature-scenarios.html#cb210-5" tabindex="-1"></a>                                                    <span class="at">models =</span> models)</span></code></pre></div>
<p>To ensure the scenarios are available for later use in the lessons on <strong>Making CMPI6 scenarios</strong> and <strong>Making CMIP5 scenarios with the ClimateWizard</strong>, they should be saved with a clear file name that includes the place name and the start and end dates of the considered period. Before saving, any incomplete winters will be removed from the record to ensure the data is accurate and complete.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="historic-temperature-scenarios.html#cb211-1" tabindex="-1"></a>chill_hist_scenario_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(chill_hist_scenario_list,</span>
<span id="cb211-2"><a href="historic-temperature-scenarios.html#cb211-2" tabindex="-1"></a>                                   <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span></span>
<span id="cb211-3"><a href="historic-temperature-scenarios.html#cb211-3" tabindex="-1"></a>                                     <span class="fu">filter</span>(Perc_complete <span class="sc">==</span> <span class="dv">100</span>))</span>
<span id="cb211-4"><a href="historic-temperature-scenarios.html#cb211-4" tabindex="-1"></a></span>
<span id="cb211-5"><a href="historic-temperature-scenarios.html#cb211-5" tabindex="-1"></a><span class="fu">save_temperature_scenarios</span>(chill_hist_scenario_list, <span class="st">&quot;data&quot;</span>,<span class="st">&quot;Bonn_hist_chill_305_59&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="historic-temperature-scenarios.html#cb212-1" tabindex="-1"></a>scenarios <span class="ot">&lt;-</span> <span class="fu">names</span>(chill_hist_scenario_list)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb212-2"><a href="historic-temperature-scenarios.html#cb212-2" tabindex="-1"></a></span>
<span id="cb212-3"><a href="historic-temperature-scenarios.html#cb212-3" tabindex="-1"></a>all_scenarios <span class="ot">&lt;-</span> chill_hist_scenario_list[[scenarios[<span class="dv">1</span>]]] <span class="sc">%&gt;%</span></span>
<span id="cb212-4"><a href="historic-temperature-scenarios.html#cb212-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scenario =</span> <span class="fu">as.numeric</span>(scenarios[<span class="dv">1</span>]))</span>
<span id="cb212-5"><a href="historic-temperature-scenarios.html#cb212-5" tabindex="-1"></a></span>
<span id="cb212-6"><a href="historic-temperature-scenarios.html#cb212-6" tabindex="-1"></a><span class="cf">for</span> (sc <span class="cf">in</span> scenarios[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb212-7"><a href="historic-temperature-scenarios.html#cb212-7" tabindex="-1"></a> all_scenarios <span class="ot">&lt;-</span> all_scenarios <span class="sc">%&gt;%</span></span>
<span id="cb212-8"><a href="historic-temperature-scenarios.html#cb212-8" tabindex="-1"></a>  <span class="fu">rbind</span>(chill_hist_scenario_list[[sc]] <span class="sc">%&gt;%</span></span>
<span id="cb212-9"><a href="historic-temperature-scenarios.html#cb212-9" tabindex="-1"></a>          <span class="fu">cbind</span>(</span>
<span id="cb212-10"><a href="historic-temperature-scenarios.html#cb212-10" tabindex="-1"></a>            <span class="at">scenario=</span><span class="fu">as.numeric</span>(sc))</span>
<span id="cb212-11"><a href="historic-temperature-scenarios.html#cb212-11" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb212-12"><a href="historic-temperature-scenarios.html#cb212-12" tabindex="-1"></a>  <span class="fu">filter</span>(Perc_complete <span class="sc">==</span> <span class="dv">100</span>)</span>
<span id="cb212-13"><a href="historic-temperature-scenarios.html#cb212-13" tabindex="-1"></a></span>
<span id="cb212-14"><a href="historic-temperature-scenarios.html#cb212-14" tabindex="-1"></a><span class="co"># Let&#39;s compute the actual &#39;observed&#39; chill for comparison</span></span>
<span id="cb212-15"><a href="historic-temperature-scenarios.html#cb212-15" tabindex="-1"></a>actual_chill <span class="ot">&lt;-</span> <span class="fu">tempResponse_daily_list</span>(Bonn_temps,</span>
<span id="cb212-16"><a href="historic-temperature-scenarios.html#cb212-16" tabindex="-1"></a>                                        <span class="at">latitude=</span><span class="fl">50.9</span>,</span>
<span id="cb212-17"><a href="historic-temperature-scenarios.html#cb212-17" tabindex="-1"></a>                                        <span class="at">Start_JDay =</span> <span class="dv">305</span>,</span>
<span id="cb212-18"><a href="historic-temperature-scenarios.html#cb212-18" tabindex="-1"></a>                                        <span class="at">End_JDay =</span> <span class="dv">59</span>,</span>
<span id="cb212-19"><a href="historic-temperature-scenarios.html#cb212-19" tabindex="-1"></a>                                        models)[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb212-20"><a href="historic-temperature-scenarios.html#cb212-20" tabindex="-1"></a>  <span class="fu">filter</span>(Perc_complete <span class="sc">==</span> <span class="dv">100</span>)</span>
<span id="cb212-21"><a href="historic-temperature-scenarios.html#cb212-21" tabindex="-1"></a></span>
<span id="cb212-22"><a href="historic-temperature-scenarios.html#cb212-22" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> all_scenarios,</span>
<span id="cb212-23"><a href="historic-temperature-scenarios.html#cb212-23" tabindex="-1"></a>       <span class="fu">aes</span>(scenario,</span>
<span id="cb212-24"><a href="historic-temperature-scenarios.html#cb212-24" tabindex="-1"></a>           Chill_Portions,</span>
<span id="cb212-25"><a href="historic-temperature-scenarios.html#cb212-25" tabindex="-1"></a>           <span class="at">fill =</span> <span class="fu">factor</span>(scenario))) <span class="sc">+</span></span>
<span id="cb212-26"><a href="historic-temperature-scenarios.html#cb212-26" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb212-27"><a href="historic-temperature-scenarios.html#cb212-27" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Chill accumulation (Chill Portions)&quot;</span>) <span class="sc">+</span></span>
<span id="cb212-28"><a href="historic-temperature-scenarios.html#cb212-28" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Scenario year&quot;</span>) <span class="sc">+</span></span>
<span id="cb212-29"><a href="historic-temperature-scenarios.html#cb212-29" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb212-30"><a href="historic-temperature-scenarios.html#cb212-30" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb212-31"><a href="historic-temperature-scenarios.html#cb212-31" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> actual_chill,</span>
<span id="cb212-32"><a href="historic-temperature-scenarios.html#cb212-32" tabindex="-1"></a>             <span class="fu">aes</span>(End_year,</span>
<span id="cb212-33"><a href="historic-temperature-scenarios.html#cb212-33" tabindex="-1"></a>                 Chill_Portions,</span>
<span id="cb212-34"><a href="historic-temperature-scenarios.html#cb212-34" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb212-35"><a href="historic-temperature-scenarios.html#cb212-35" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb212-36"><a href="historic-temperature-scenarios.html#cb212-36" tabindex="-1"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb212-37"><a href="historic-temperature-scenarios.html#cb212-37" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Scenario&quot;</span>,</span>
<span id="cb212-38"><a href="historic-temperature-scenarios.html#cb212-38" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">unique</span>(all_scenarios<span class="sc">$</span>scenario)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/condense_chill_list-1.png" width="672" /></p>
<p>The observed chill data should also be saved for later use in the lessons on <strong>Making CMPI6 scenarios</strong> and <strong>Making CMIP5 scenarios with the ClimateWizard</strong>. This will allow for easy access and comparison when working with those scenarios in the future.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="historic-temperature-scenarios.html#cb213-1" tabindex="-1"></a><span class="fu">write.csv</span>(actual_chill,<span class="st">&quot;data/Bonn_observed_chill_305_59.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>The chill distribution scenarios for 1980, 1990, 2000, and 2010 show minimal change, suggesting that chill deficiencies in Bonn are unlikely in the near future.</p>
<p>So far, all annual scenarios were based on running means of <strong>Tmin</strong> and <strong>Tmax</strong>, which is a reasonable approach given the challenges of estimating temperatures in times of accelerating climate change. However, <code>chillR</code> also offers the option of using linear regression to determine representative temperatures for a specific historical scenario. A quick comparison will reveal how this method affects the scenarios.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="historic-temperature-scenarios.html#cb214-1" tabindex="-1"></a>temperature_means <span class="ot">&lt;-</span> </span>
<span id="cb214-2"><a href="historic-temperature-scenarios.html#cb214-2" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Year =</span> <span class="fu">min</span>(Bonn_temps<span class="sc">$</span>Year)<span class="sc">:</span><span class="fu">max</span>(Bonn_temps<span class="sc">$</span>Year),</span>
<span id="cb214-3"><a href="historic-temperature-scenarios.html#cb214-3" tabindex="-1"></a>             <span class="at">Tmin =</span> <span class="fu">aggregate</span>(Bonn_temps<span class="sc">$</span>Tmin,</span>
<span id="cb214-4"><a href="historic-temperature-scenarios.html#cb214-4" tabindex="-1"></a>                              <span class="at">FUN =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb214-5"><a href="historic-temperature-scenarios.html#cb214-5" tabindex="-1"></a>                              <span class="at">by =</span> <span class="fu">list</span>(Bonn_temps<span class="sc">$</span>Year))[,<span class="dv">2</span>],</span>
<span id="cb214-6"><a href="historic-temperature-scenarios.html#cb214-6" tabindex="-1"></a>             <span class="at">Tmax=</span><span class="fu">aggregate</span>(Bonn_temps<span class="sc">$</span>Tmax,</span>
<span id="cb214-7"><a href="historic-temperature-scenarios.html#cb214-7" tabindex="-1"></a>                            <span class="at">FUN =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb214-8"><a href="historic-temperature-scenarios.html#cb214-8" tabindex="-1"></a>                            <span class="at">by =</span> <span class="fu">list</span>(Bonn_temps<span class="sc">$</span>Year))[,<span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb214-9"><a href="historic-temperature-scenarios.html#cb214-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">runn_mean_Tmin =</span> <span class="fu">runn_mean</span>(Tmin,<span class="dv">15</span>),</span>
<span id="cb214-10"><a href="historic-temperature-scenarios.html#cb214-10" tabindex="-1"></a>         <span class="at">runn_mean_Tmax =</span> <span class="fu">runn_mean</span>(Tmax,<span class="dv">15</span>))</span>
<span id="cb214-11"><a href="historic-temperature-scenarios.html#cb214-11" tabindex="-1"></a></span>
<span id="cb214-12"><a href="historic-temperature-scenarios.html#cb214-12" tabindex="-1"></a></span>
<span id="cb214-13"><a href="historic-temperature-scenarios.html#cb214-13" tabindex="-1"></a>Tmin_regression <span class="ot">&lt;-</span> <span class="fu">lm</span>(Tmin<span class="sc">~</span>Year,</span>
<span id="cb214-14"><a href="historic-temperature-scenarios.html#cb214-14" tabindex="-1"></a>                      temperature_means)</span>
<span id="cb214-15"><a href="historic-temperature-scenarios.html#cb214-15" tabindex="-1"></a></span>
<span id="cb214-16"><a href="historic-temperature-scenarios.html#cb214-16" tabindex="-1"></a>Tmax_regression <span class="ot">&lt;-</span> <span class="fu">lm</span>(Tmax<span class="sc">~</span>Year,</span>
<span id="cb214-17"><a href="historic-temperature-scenarios.html#cb214-17" tabindex="-1"></a>                      temperature_means)</span>
<span id="cb214-18"><a href="historic-temperature-scenarios.html#cb214-18" tabindex="-1"></a></span>
<span id="cb214-19"><a href="historic-temperature-scenarios.html#cb214-19" tabindex="-1"></a>temperature_means <span class="ot">&lt;-</span> temperature_means <span class="sc">%&gt;%</span></span>
<span id="cb214-20"><a href="historic-temperature-scenarios.html#cb214-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">regression_Tmin =</span> Tmin_regression<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span></span>
<span id="cb214-21"><a href="historic-temperature-scenarios.html#cb214-21" tabindex="-1"></a>           Tmin_regression<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>temperature_means<span class="sc">$</span>Year,</span>
<span id="cb214-22"><a href="historic-temperature-scenarios.html#cb214-22" tabindex="-1"></a>           <span class="at">regression_Tmax =</span> Tmax_regression<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span></span>
<span id="cb214-23"><a href="historic-temperature-scenarios.html#cb214-23" tabindex="-1"></a>           Tmax_regression<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>temperature_means<span class="sc">$</span>Year</span>
<span id="cb214-24"><a href="historic-temperature-scenarios.html#cb214-24" tabindex="-1"></a>         )</span>
<span id="cb214-25"><a href="historic-temperature-scenarios.html#cb214-25" tabindex="-1"></a></span>
<span id="cb214-26"><a href="historic-temperature-scenarios.html#cb214-26" tabindex="-1"></a><span class="fu">ggplot</span>(temperature_means,</span>
<span id="cb214-27"><a href="historic-temperature-scenarios.html#cb214-27" tabindex="-1"></a>       <span class="fu">aes</span>(Year,</span>
<span id="cb214-28"><a href="historic-temperature-scenarios.html#cb214-28" tabindex="-1"></a>           Tmin)) <span class="sc">+</span> </span>
<span id="cb214-29"><a href="historic-temperature-scenarios.html#cb214-29" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb214-30"><a href="historic-temperature-scenarios.html#cb214-30" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> temperature_means,</span>
<span id="cb214-31"><a href="historic-temperature-scenarios.html#cb214-31" tabindex="-1"></a>            <span class="fu">aes</span>(Year,</span>
<span id="cb214-32"><a href="historic-temperature-scenarios.html#cb214-32" tabindex="-1"></a>                runn_mean_Tmin),</span>
<span id="cb214-33"><a href="historic-temperature-scenarios.html#cb214-33" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb214-34"><a href="historic-temperature-scenarios.html#cb214-34" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb214-35"><a href="historic-temperature-scenarios.html#cb214-35" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> temperature_means,</span>
<span id="cb214-36"><a href="historic-temperature-scenarios.html#cb214-36" tabindex="-1"></a>            <span class="fu">aes</span>(Year,</span>
<span id="cb214-37"><a href="historic-temperature-scenarios.html#cb214-37" tabindex="-1"></a>                regression_Tmin),</span>
<span id="cb214-38"><a href="historic-temperature-scenarios.html#cb214-38" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb214-39"><a href="historic-temperature-scenarios.html#cb214-39" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb214-40"><a href="historic-temperature-scenarios.html#cb214-40" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb214-41"><a href="historic-temperature-scenarios.html#cb214-41" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Mean monthly minimum temperature (°C)&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/runn_mean_vs_regression-1.png" width="672" /></p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="historic-temperature-scenarios.html#cb215-1" tabindex="-1"></a><span class="fu">ggplot</span>(temperature_means,</span>
<span id="cb215-2"><a href="historic-temperature-scenarios.html#cb215-2" tabindex="-1"></a>       <span class="fu">aes</span>(Year,</span>
<span id="cb215-3"><a href="historic-temperature-scenarios.html#cb215-3" tabindex="-1"></a>           Tmax)) <span class="sc">+</span> </span>
<span id="cb215-4"><a href="historic-temperature-scenarios.html#cb215-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb215-5"><a href="historic-temperature-scenarios.html#cb215-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> temperature_means,</span>
<span id="cb215-6"><a href="historic-temperature-scenarios.html#cb215-6" tabindex="-1"></a>            <span class="fu">aes</span>(Year,</span>
<span id="cb215-7"><a href="historic-temperature-scenarios.html#cb215-7" tabindex="-1"></a>                runn_mean_Tmax),</span>
<span id="cb215-8"><a href="historic-temperature-scenarios.html#cb215-8" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb215-9"><a href="historic-temperature-scenarios.html#cb215-9" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb215-10"><a href="historic-temperature-scenarios.html#cb215-10" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> temperature_means,</span>
<span id="cb215-11"><a href="historic-temperature-scenarios.html#cb215-11" tabindex="-1"></a>            <span class="fu">aes</span>(Year, </span>
<span id="cb215-12"><a href="historic-temperature-scenarios.html#cb215-12" tabindex="-1"></a>                regression_Tmax),</span>
<span id="cb215-13"><a href="historic-temperature-scenarios.html#cb215-13" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb215-14"><a href="historic-temperature-scenarios.html#cb215-14" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb215-15"><a href="historic-temperature-scenarios.html#cb215-15" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb215-16"><a href="historic-temperature-scenarios.html#cb215-16" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Mean monthly maximum temperature (°C)&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/runn_mean_vs_regression-2.png" width="672" /></p>
<p>There is a noticeable difference between the running mean function (blue) and the linear regression line (red). While the running mean provides a smoother approximation, the linear regression line offers a more direct trend. This difference can be significant, and it is expected to become more pronounced as climate change continues to affect temperature patterns.</p>
</div>
<div id="exercises-on-generating-historic-temperature-scenarios" class="section level2 hasAnchor" number="14.4">
<h2><span class="header-section-number">14.4</span> <code>Exercises</code> on generating historic temperature scenarios<a href="historic-temperature-scenarios.html#exercises-on-generating-historic-temperature-scenarios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Please document all results of the following assignments in your <code>learning logbook</code>.</p>
<ol style="list-style-type: decimal">
<li><em>For the location you chose for previous exercises, produce historic temperature scenarios representing several years of the historic record (your choice).</em></li>
</ol>
<pre><code>##    YEARMODA                DATE                Date Year Month Day    Tmin   Tmax   Tmean
## 1  19730101 1973-01-01 12:00:00 1973-01-01 12:00:00 1973     1   1  -3.000  6.111   0.000
## 2  19730102 1973-01-02 12:00:00 1973-01-02 12:00:00 1973     1   2  -1.111  8.278   2.611
## 3  19730103 1973-01-03 12:00:00 1973-01-03 12:00:00 1973     1   3  -5.000  3.000  -1.278
## 4  19730104 1973-01-04 12:00:00 1973-01-04 12:00:00 1973     1   4 -12.222 -0.611  -6.389
## 5  19730105 1973-01-05 12:00:00 1973-01-05 12:00:00 1973     1   5 -10.000 -3.278  -6.667
## 6  19730106 1973-01-06 12:00:00 1973-01-06 12:00:00 1973     1   6 -17.222 -5.000  -9.944
## 7  19730107 1973-01-07 12:00:00 1973-01-07 12:00:00 1973     1   7 -17.000 -6.000 -12.333
## 8  19730108 1973-01-08 12:00:00 1973-01-08 12:00:00 1973     1   8 -17.000 -5.000 -11.167
## 9  19730109 1973-01-09 12:00:00 1973-01-09 12:00:00 1973     1   9 -13.889 -4.000  -7.389
## 10 19730110 1973-01-10 12:00:00 1973-01-10 12:00:00 1973     1  10  -9.000 -2.778  -5.056
## 11 19730111 1973-01-11 12:00:00 1973-01-11 12:00:00 1973     1  11  -6.111 -2.722  -4.556
## 12 19730112 1973-01-12 12:00:00 1973-01-12 12:00:00 1973     1  12  -8.278 -1.611  -4.000
## 13 19730113 1973-01-13 12:00:00 1973-01-13 12:00:00 1973     1  13  -1.111  2.222   0.667
## 14 19730114 1973-01-14 12:00:00 1973-01-14 12:00:00 1973     1  14  -2.222  1.111  -0.222
## 15 19730115 1973-01-15 12:00:00 1973-01-15 12:00:00 1973     1  15  -3.278  3.778  -0.444
## 16 19730116 1973-01-16 12:00:00 1973-01-16 12:00:00 1973     1  16   1.111  5.000   2.889
## 17 19730117 1973-01-17 12:00:00 1973-01-17 12:00:00 1973     1  17  -2.778  6.611   1.333
## 18 19730118 1973-01-18 12:00:00 1973-01-18 12:00:00 1973     1  18  -1.722  6.111   0.778
## 19 19730119 1973-01-19 12:00:00 1973-01-19 12:00:00 1973     1  19  -3.889  4.389   1.056
## 20 19730120 1973-01-20 12:00:00 1973-01-20 12:00:00 1973     1  20  -6.611  4.389  -2.278
## 21 19730121 1973-01-21 12:00:00 1973-01-21 12:00:00 1973     1  21  -7.222  4.389  -3.111
## 22 19730122 1973-01-22 12:00:00 1973-01-22 12:00:00 1973     1  22  -7.722  3.278  -4.167
## 23 19730123 1973-01-23 12:00:00 1973-01-23 12:00:00 1973     1  23  -5.000  2.222  -1.889
## 24 19730124 1973-01-24 12:00:00 1973-01-24 12:00:00 1973     1  24  -5.500  6.111  -1.111
## 25 19730125 1973-01-25 12:00:00 1973-01-25 12:00:00 1973     1  25  -0.611  7.778   3.333
## 26 19730126 1973-01-26 12:00:00 1973-01-26 12:00:00 1973     1  26  -7.722  3.778  -2.444
## 27 19730127 1973-01-27 12:00:00 1973-01-27 12:00:00 1973     1  27  -5.000  2.778  -2.222
## 28 19730128 1973-01-28 12:00:00 1973-01-28 12:00:00 1973     1  28  -3.889  2.222  -0.611
## 29 19730129 1973-01-29 12:00:00 1973-01-29 12:00:00 1973     1  29  -4.389  2.778  -1.556
## 30 19730130 1973-01-30 12:00:00 1973-01-30 12:00:00 1973     1  30  -5.611  1.722  -1.778
## 31 19730131 1973-01-31 12:00:00 1973-01-31 12:00:00 1973     1  31  -6.222  2.222  -1.500
## 32 19730201 1973-02-01 12:00:00 1973-02-01 12:00:00 1973     2   1  -5.611  3.278  -1.944
## 33 19730202 1973-02-02 12:00:00 1973-02-02 12:00:00 1973     2   2  -2.722  6.111   0.778
## 34 19730203 1973-02-03 12:00:00 1973-02-03 12:00:00 1973     2   3  -0.500  8.278   2.444
## 35 19730204 1973-02-04 12:00:00 1973-02-04 12:00:00 1973     2   4  -1.111  7.778   3.111
## 36 19730205 1973-02-05 12:00:00 1973-02-05 12:00:00 1973     2   5  -5.000  7.222   0.000
## 37 19730206 1973-02-06 12:00:00 1973-02-06 12:00:00 1973     2   6   0.500  6.722   1.778
## 38 19730207 1973-02-07 12:00:00 1973-02-07 12:00:00 1973     2   7   0.000  5.500   1.722
## 39 19730208 1973-02-08 12:00:00 1973-02-08 12:00:00 1973     2   8  -5.611  6.111  -0.611
## 40 19730209 1973-02-09 12:00:00 1973-02-09 12:00:00 1973     2   9  -3.278  5.000   0.444
## 41 19730210 1973-02-10 12:00:00 1973-02-10 12:00:00 1973     2  10  -0.611  2.778   0.944
## 42 19730211 1973-02-11 12:00:00 1973-02-11 12:00:00 1973     2  11  -2.722  1.722   0.056
## 43 19730212 1973-02-12 12:00:00 1973-02-12 12:00:00 1973     2  12  -1.111  1.111  -0.056
## 44 19730213 1973-02-13 12:00:00 1973-02-13 12:00:00 1973     2  13   0.000  3.278   0.833
## 45 19730214 1973-02-14 12:00:00 1973-02-14 12:00:00 1973     2  14   0.500  4.389   1.611
## 46 19730215 1973-02-15 12:00:00 1973-02-15 12:00:00 1973     2  15   1.111  3.278   1.889
## 47 19730216 1973-02-16 12:00:00 1973-02-16 12:00:00 1973     2  16  -0.500  3.278   1.278
## 48 19730217 1973-02-17 12:00:00 1973-02-17 12:00:00 1973     2  17   1.111  6.111   2.167
## 49 19730218 1973-02-18 12:00:00 1973-02-18 12:00:00 1973     2  18  -2.778 11.611   3.444
## 50 19730219 1973-02-19 12:00:00 1973-02-19 12:00:00 1973     2  19  -2.778 10.611   2.278
## 51 19730220 1973-02-20 12:00:00 1973-02-20 12:00:00 1973     2  20  -3.278 12.722   2.944
## 52 19730221 1973-02-21 12:00:00 1973-02-21 12:00:00 1973     2  21  -3.278 13.278   3.556
## 53 19730222 1973-02-22 12:00:00 1973-02-22 12:00:00 1973     2  22  -3.278 12.722   3.278
## 54 19730223 1973-02-23 12:00:00 1973-02-23 12:00:00 1973     2  23  -2.222 13.778   4.389
## 55 19730224 1973-02-24 12:00:00 1973-02-24 12:00:00 1973     2  24  -2.778 13.778   4.667
## 56 19730225 1973-02-25 12:00:00 1973-02-25 12:00:00 1973     2  25   1.111 14.389   7.167
## 57 19730226 1973-02-26 12:00:00 1973-02-26 12:00:00 1973     2  26   2.722 13.278   7.389
## 58 19730227 1973-02-27 12:00:00 1973-02-27 12:00:00 1973     2  27   0.000 14.389   6.333
## 59 19730228 1973-02-28 12:00:00 1973-02-28 12:00:00 1973     2  28   3.278 15.000   7.500
## 60 19730301 1973-03-01 12:00:00 1973-03-01 12:00:00 1973     3   1   6.111 13.278   9.722
## 61 19730302 1973-03-02 12:00:00 1973-03-02 12:00:00 1973     3   2  -1.611 13.278   6.111
## 62 19730303 1973-03-03 12:00:00 1973-03-03 12:00:00 1973     3   3  -0.611 12.778   4.611
## 63 19730304 1973-03-04 12:00:00 1973-03-04 12:00:00 1973     3   4  -2.778 14.389   6.056
## 64 19730305 1973-03-05 12:00:00 1973-03-05 12:00:00 1973     3   5  -2.722 13.778   5.222
## 65 19730306 1973-03-06 12:00:00 1973-03-06 12:00:00 1973     3   6  -1.111 15.000   6.500
## 66 19730307 1973-03-07 12:00:00 1973-03-07 12:00:00 1973     3   7   4.389 16.111   9.611
## 67 19730308 1973-03-08 12:00:00 1973-03-08 12:00:00 1973     3   8   3.278 16.111   9.278
## 68 19730309 1973-03-09 12:00:00 1973-03-09 12:00:00 1973     3   9   2.722 15.611  10.000
## 69 19730310 1973-03-10 12:00:00 1973-03-10 12:00:00 1973     3  10   7.222 14.389  10.556
## 70 19730311 1973-03-11 12:00:00 1973-03-11 12:00:00 1973     3  11  -3.889 15.500   4.500
## 71 19730312 1973-03-12 12:00:00 1973-03-12 12:00:00 1973     3  12  -2.722 14.389   4.889
## 72 19730313 1973-03-13 12:00:00 1973-03-13 12:00:00 1973     3  13  -1.111 13.889   5.167
## 73 19730314 1973-03-14 12:00:00 1973-03-14 12:00:00 1973     3  14  -5.000 14.389   3.556
## 74 19730315 1973-03-15 12:00:00 1973-03-15 12:00:00 1973     3  15  -0.500 14.389   6.833
## 75 19730316 1973-03-16 12:00:00 1973-03-16 12:00:00 1973     3  16   2.222 17.778   8.667
## 76 19730317 1973-03-17 12:00:00 1973-03-17 12:00:00 1973     3  17  -3.778 12.222   4.944
## 77 19730318 1973-03-18 12:00:00 1973-03-18 12:00:00 1973     3  18   1.611 13.778   5.611
## 78 19730319 1973-03-19 12:00:00 1973-03-19 12:00:00 1973     3  19   5.611 12.222   8.111
## 79 19730320 1973-03-20 12:00:00 1973-03-20 12:00:00 1973     3  20   3.778 15.000   8.500
## 80 19730321 1973-03-21 12:00:00 1973-03-21 12:00:00 1973     3  21  -1.611 15.000   7.056
## 81 19730322 1973-03-22 12:00:00 1973-03-22 12:00:00 1973     3  22   2.722 15.000   9.611
## 82 19730323 1973-03-23 12:00:00 1973-03-23 12:00:00 1973     3  23  -2.722 18.278   7.778
## 83 19730324 1973-03-24 12:00:00 1973-03-24 12:00:00 1973     3  24  -2.778 18.278   7.333
##       Prec Tmin_source Tmax_source
## 1    0.000        &lt;NA&gt;        &lt;NA&gt;
## 2    0.000        &lt;NA&gt;        &lt;NA&gt;
## 3    0.000        &lt;NA&gt;        &lt;NA&gt;
## 4    0.000        &lt;NA&gt;        &lt;NA&gt;
## 5    1.016        &lt;NA&gt;        &lt;NA&gt;
## 6    0.000        &lt;NA&gt;        &lt;NA&gt;
## 7    0.000        &lt;NA&gt;        &lt;NA&gt;
## 8    0.000        &lt;NA&gt;        &lt;NA&gt;
## 9   44.958        &lt;NA&gt;        &lt;NA&gt;
## 10  50.038        &lt;NA&gt;        &lt;NA&gt;
## 11   4.064        &lt;NA&gt;        &lt;NA&gt;
## 12   7.112        &lt;NA&gt;        &lt;NA&gt;
## 13   6.096        &lt;NA&gt;        &lt;NA&gt;
## 14   0.000        &lt;NA&gt;        &lt;NA&gt;
## 15 136.906        &lt;NA&gt;        &lt;NA&gt;
## 16   1.016        &lt;NA&gt;        &lt;NA&gt;
## 17   1.016        &lt;NA&gt;        &lt;NA&gt;
## 18   0.000        &lt;NA&gt;        &lt;NA&gt;
## 19   7.874        &lt;NA&gt;        &lt;NA&gt;
## 20   0.000        &lt;NA&gt;        &lt;NA&gt;
## 21  35.052        &lt;NA&gt;        &lt;NA&gt;
## 22   0.000        &lt;NA&gt;        &lt;NA&gt;
## 23   0.000        &lt;NA&gt;        &lt;NA&gt;
## 24      NA        &lt;NA&gt;        &lt;NA&gt;
## 25  41.910        &lt;NA&gt;        &lt;NA&gt;
## 26  42.926        &lt;NA&gt;        &lt;NA&gt;
## 27   0.000        &lt;NA&gt;        &lt;NA&gt;
## 28  37.084        &lt;NA&gt;        &lt;NA&gt;
## 29   0.000        &lt;NA&gt;        &lt;NA&gt;
## 30   0.000        &lt;NA&gt;        &lt;NA&gt;
## 31   0.000        &lt;NA&gt;        &lt;NA&gt;
## 32   0.000        &lt;NA&gt;        &lt;NA&gt;
## 33  39.116        &lt;NA&gt;        &lt;NA&gt;
## 34   0.000        &lt;NA&gt;        &lt;NA&gt;
## 35  39.878        &lt;NA&gt;        &lt;NA&gt;
## 36  46.990        &lt;NA&gt;        &lt;NA&gt;
## 37   0.000        &lt;NA&gt;        &lt;NA&gt;
## 38   0.000        &lt;NA&gt;        &lt;NA&gt;
## 39  41.910        &lt;NA&gt;        &lt;NA&gt;
## 40  77.978        &lt;NA&gt;        &lt;NA&gt;
## 41  34.036        &lt;NA&gt;        &lt;NA&gt;
## 42   1.016        &lt;NA&gt;        &lt;NA&gt;
## 43  35.052        &lt;NA&gt;        &lt;NA&gt;
## 44   1.016        &lt;NA&gt;        &lt;NA&gt;
## 45   0.000        &lt;NA&gt;        &lt;NA&gt;
## 46   0.000        &lt;NA&gt;        &lt;NA&gt;
## 47   0.000        &lt;NA&gt;        &lt;NA&gt;
## 48   0.000        &lt;NA&gt;        &lt;NA&gt;
## 49  43.942        &lt;NA&gt;        &lt;NA&gt;
## 50   0.000        &lt;NA&gt;        &lt;NA&gt;
## 51 102.108        &lt;NA&gt;        &lt;NA&gt;
## 52  44.958        &lt;NA&gt;        &lt;NA&gt;
## 53   0.000        &lt;NA&gt;        &lt;NA&gt;
## 54  59.944        &lt;NA&gt;        &lt;NA&gt;
## 55   0.000        &lt;NA&gt;        &lt;NA&gt;
## 56   0.000        &lt;NA&gt;        &lt;NA&gt;
## 57   0.000        &lt;NA&gt;        &lt;NA&gt;
## 58 119.888        &lt;NA&gt;        &lt;NA&gt;
## 59   0.000        &lt;NA&gt;        &lt;NA&gt;
## 60   0.000        &lt;NA&gt;        &lt;NA&gt;
## 61   0.000        &lt;NA&gt;        &lt;NA&gt;
## 62   0.000        &lt;NA&gt;        &lt;NA&gt;
## 63   0.000        &lt;NA&gt;        &lt;NA&gt;
## 64   0.000        &lt;NA&gt;        &lt;NA&gt;
## 65   0.000        &lt;NA&gt;        &lt;NA&gt;
## 66  54.102        &lt;NA&gt;        &lt;NA&gt;
## 67 130.048        &lt;NA&gt;        &lt;NA&gt;
## 68   0.000        &lt;NA&gt;        &lt;NA&gt;
## 69   0.000        &lt;NA&gt;        &lt;NA&gt;
## 70  89.916        &lt;NA&gt;        &lt;NA&gt;
## 71 144.018        &lt;NA&gt;        &lt;NA&gt;
## 72 109.982        &lt;NA&gt;        &lt;NA&gt;
## 73   0.000        &lt;NA&gt;        &lt;NA&gt;
## 74   0.000        &lt;NA&gt;        &lt;NA&gt;
## 75 109.982        &lt;NA&gt;        &lt;NA&gt;
## 76   0.000        &lt;NA&gt;        &lt;NA&gt;
## 77   0.000        &lt;NA&gt;        &lt;NA&gt;
## 78  49.022        &lt;NA&gt;        &lt;NA&gt;
## 79   0.000        &lt;NA&gt;        &lt;NA&gt;
## 80   0.000        &lt;NA&gt;        &lt;NA&gt;
## 81   0.000        &lt;NA&gt;        &lt;NA&gt;
## 82   0.000        &lt;NA&gt;        &lt;NA&gt;
## 83  54.102        &lt;NA&gt;        &lt;NA&gt;
##  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 18544 rows ]</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="historic-temperature-scenarios.html#cb217-1" tabindex="-1"></a><span class="co">#get a list of close-by weather stations</span></span>
<span id="cb217-2"><a href="historic-temperature-scenarios.html#cb217-2" tabindex="-1"></a>station_list <span class="ot">&lt;-</span> <span class="fu">handle_gsod</span>(<span class="at">action =</span> <span class="st">&quot;list_stations&quot;</span>,</span>
<span id="cb217-3"><a href="historic-temperature-scenarios.html#cb217-3" tabindex="-1"></a>                            <span class="at">location =</span> <span class="fu">c</span>(<span class="at">long =</span> <span class="sc">-</span><span class="fl">120.5</span>, <span class="at">lat =</span> <span class="fl">46.6</span>),</span>
<span id="cb217-4"><a href="historic-temperature-scenarios.html#cb217-4" tabindex="-1"></a>                            <span class="at">time_interval =</span> <span class="fu">c</span>(<span class="dv">1973</span>, <span class="dv">2023</span>))</span>
<span id="cb217-5"><a href="historic-temperature-scenarios.html#cb217-5" tabindex="-1"></a></span>
<span id="cb217-6"><a href="historic-temperature-scenarios.html#cb217-6" tabindex="-1"></a></span>
<span id="cb217-7"><a href="historic-temperature-scenarios.html#cb217-7" tabindex="-1"></a><span class="co">#download data</span></span>
<span id="cb217-8"><a href="historic-temperature-scenarios.html#cb217-8" tabindex="-1"></a>Yakima_weather <span class="ot">&lt;-</span> <span class="fu">handle_gsod</span>(<span class="at">action =</span> <span class="st">&quot;download_weather&quot;</span>,</span>
<span id="cb217-9"><a href="historic-temperature-scenarios.html#cb217-9" tabindex="-1"></a>                            <span class="at">location =</span> station_list<span class="sc">$</span>chillR_code[<span class="dv">1</span>],</span>
<span id="cb217-10"><a href="historic-temperature-scenarios.html#cb217-10" tabindex="-1"></a>                            <span class="at">time_interval =</span> <span class="fu">c</span>(<span class="dv">1973</span>, <span class="dv">2023</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb217-11"><a href="historic-temperature-scenarios.html#cb217-11" tabindex="-1"></a>  <span class="fu">handle_gsod</span>()</span></code></pre></div>
<pre><code>## Loading data for 51 years from station &#39;YAKIMA AIR TERMINAL/MCALSR FIELD AP&#39;
## ===============================================================================================</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="historic-temperature-scenarios.html#cb219-1" tabindex="-1"></a><span class="co"># check record for missing data</span></span>
<span id="cb219-2"><a href="historic-temperature-scenarios.html#cb219-2" tabindex="-1"></a><span class="fu">fix_weather</span>(Yakima_weather<span class="sc">$</span><span class="st">`</span><span class="at">YAKIMA AIR TERMINAL/MCALSR FIELD AP</span><span class="st">`</span>)<span class="sc">$</span>QC</span></code></pre></div>
<pre><code>##       Season End_year Season_days Data_days Missing_Tmin Missing_Tmax Incomplete_days
## 1  1972/1973     1973         365       365            0            0               0
## 2  1973/1974     1974         365       365            0            0               0
## 3  1974/1975     1975         365       365            0            0               0
## 4  1975/1976     1976         366       366            0            0               0
## 5  1976/1977     1977         365       365            0            0               0
## 6  1977/1978     1978         365       365            0            0               0
## 7  1978/1979     1979         365       365            0            0               0
## 8  1979/1980     1980         366       366            0            0               0
## 9  1980/1981     1981         365       365            0            0               0
## 10 1981/1982     1982         365       365            0            0               0
## 11 1982/1983     1983         365       365            0            0               0
## 12 1983/1984     1984         366       366            0            0               0
## 13 1984/1985     1985         365       365            0            0               0
## 14 1985/1986     1986         365       365            0            0               0
## 15 1986/1987     1987         365       365            0            0               0
## 16 1987/1988     1988         366       366            0            0               0
## 17 1988/1989     1989         365       365            0            0               0
## 18 1989/1990     1990         365       365            0            0               0
## 19 1990/1991     1991         365       365            0            0               0
## 20 1991/1992     1992         366       366            0            0               0
## 21 1992/1993     1993         365       365            0            0               0
## 22 1993/1994     1994         365       365            0            0               0
## 23 1994/1995     1995         365       365            0            0               0
## 24 1995/1996     1996         366       366            0            0               0
## 25 1996/1997     1997         365       365            0            0               0
## 26 1997/1998     1998         365       365            0            0               0
## 27 1998/1999     1999         365       365            0            0               0
## 28 1999/2000     2000         366       366            0            0               0
## 29 2000/2001     2001         365       365            0            0               0
## 30 2001/2002     2002         365       365            0            0               0
## 31 2002/2003     2003         365       365            0            0               0
## 32 2003/2004     2004         366       366            0            0               0
## 33 2004/2005     2005         365       365            0            0               0
## 34 2005/2006     2006         365       365            0            0               0
## 35 2006/2007     2007         365       365            0            0               0
## 36 2007/2008     2008         366       366            0            0               0
## 37 2008/2009     2009         365       365            0            0               0
## 38 2009/2010     2010         365       365            0            0               0
## 39 2010/2011     2011         365       365            0            0               0
## 40 2011/2012     2012         366       366            0            0               0
## 41 2012/2013     2013         365       365            0            0               0
## 42 2013/2014     2014         365       365            0            0               0
## 43 2014/2015     2015         365       365            0            0               0
## 44 2015/2016     2016         366       366            0            0               0
## 45 2016/2017     2017         365       365            0            0               0
## 46 2017/2018     2018         365       365            0            0               0
## 47 2018/2019     2019         365       365            0            0               0
## 48 2019/2020     2020         366       366            0            0               0
## 49 2020/2021     2021         365       365            0            0               0
## 50 2021/2022     2022         365       365            0            0               0
## 51 2022/2023     2023         365       365            0            0               0
##    Perc_complete
## 1            100
## 2            100
## 3            100
## 4            100
## 5            100
## 6            100
## 7            100
## 8            100
## 9            100
## 10           100
## 11           100
## 12           100
## 13           100
## 14           100
## 15           100
## 16           100
## 17           100
## 18           100
## 19           100
## 20           100
## 21           100
## 22           100
## 23           100
## 24           100
## 25           100
## 26           100
## 27           100
## 28           100
## 29           100
## 30           100
## 31           100
## 32           100
## 33           100
## 34           100
## 35           100
## 36           100
## 37           100
## 38           100
## 39           100
## 40           100
## 41           100
## 42           100
## 43           100
## 44           100
## 45           100
## 46           100
## 47           100
## 48           100
## 49           100
## 50           100
## 51           100</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="historic-temperature-scenarios.html#cb221-1" tabindex="-1"></a><span class="co"># filling gaps</span></span>
<span id="cb221-2"><a href="historic-temperature-scenarios.html#cb221-2" tabindex="-1"></a>patch_weather <span class="ot">&lt;-</span></span>
<span id="cb221-3"><a href="historic-temperature-scenarios.html#cb221-3" tabindex="-1"></a>  <span class="fu">handle_gsod</span>(<span class="at">action =</span> <span class="st">&quot;download_weather&quot;</span>,</span>
<span id="cb221-4"><a href="historic-temperature-scenarios.html#cb221-4" tabindex="-1"></a>              <span class="at">location =</span> <span class="fu">as.character</span>(station_list<span class="sc">$</span>chillR_code[<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>)]),</span>
<span id="cb221-5"><a href="historic-temperature-scenarios.html#cb221-5" tabindex="-1"></a>              <span class="at">time_interval =</span> <span class="fu">c</span>(<span class="dv">1973</span>, <span class="dv">2023</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb221-6"><a href="historic-temperature-scenarios.html#cb221-6" tabindex="-1"></a>  <span class="fu">handle_gsod</span>()</span></code></pre></div>
<pre><code>## Loading data for 51 years from station &#39;RANGE OP 13 / YAKIMA TRAINING CENTER&#39;
## ===============================================================================================
## 
## Loading data for 51 years from station &#39;BOWERS FIELD AIRPORT&#39;
## ===============================================================================================</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="historic-temperature-scenarios.html#cb223-1" tabindex="-1"></a>Yakima_patched <span class="ot">&lt;-</span> <span class="fu">patch_daily_temperatures</span>(</span>
<span id="cb223-2"><a href="historic-temperature-scenarios.html#cb223-2" tabindex="-1"></a>  <span class="at">weather =</span> Yakima_weather<span class="sc">$</span><span class="st">`</span><span class="at">YAKIMA AIR TERMINAL/MCALSR FIELD AP</span><span class="st">`</span>,</span>
<span id="cb223-3"><a href="historic-temperature-scenarios.html#cb223-3" tabindex="-1"></a>  <span class="at">patch_weather =</span> patch_weather)</span>
<span id="cb223-4"><a href="historic-temperature-scenarios.html#cb223-4" tabindex="-1"></a></span>
<span id="cb223-5"><a href="historic-temperature-scenarios.html#cb223-5" tabindex="-1"></a></span>
<span id="cb223-6"><a href="historic-temperature-scenarios.html#cb223-6" tabindex="-1"></a><span class="fu">fix_weather</span>(Yakima_patched)<span class="sc">$</span>QC</span></code></pre></div>
<pre><code>##       Season End_year Season_days Data_days Missing_Tmin Missing_Tmax Incomplete_days
## 1  1972/1973     1973         365       365            0            0               0
## 2  1973/1974     1974         365       365            0            0               0
## 3  1974/1975     1975         365       365            0            0               0
## 4  1975/1976     1976         366       366            0            0               0
## 5  1976/1977     1977         365       365            0            0               0
## 6  1977/1978     1978         365       365            0            0               0
## 7  1978/1979     1979         365       365            0            0               0
## 8  1979/1980     1980         366       366            0            0               0
## 9  1980/1981     1981         365       365            0            0               0
## 10 1981/1982     1982         365       365            0            0               0
## 11 1982/1983     1983         365       365            0            0               0
## 12 1983/1984     1984         366       366            0            0               0
## 13 1984/1985     1985         365       365            0            0               0
## 14 1985/1986     1986         365       365            0            0               0
## 15 1986/1987     1987         365       365            0            0               0
## 16 1987/1988     1988         366       366            0            0               0
## 17 1988/1989     1989         365       365            0            0               0
## 18 1989/1990     1990         365       365            0            0               0
## 19 1990/1991     1991         365       365            0            0               0
## 20 1991/1992     1992         366       366            0            0               0
## 21 1992/1993     1993         365       365            0            0               0
## 22 1993/1994     1994         365       365            0            0               0
## 23 1994/1995     1995         365       365            0            0               0
## 24 1995/1996     1996         366       366            0            0               0
## 25 1996/1997     1997         365       365            0            0               0
## 26 1997/1998     1998         365       365            0            0               0
## 27 1998/1999     1999         365       365            0            0               0
## 28 1999/2000     2000         366       366            0            0               0
## 29 2000/2001     2001         365       365            0            0               0
## 30 2001/2002     2002         365       365            0            0               0
## 31 2002/2003     2003         365       365            0            0               0
## 32 2003/2004     2004         366       366            0            0               0
## 33 2004/2005     2005         365       365            0            0               0
## 34 2005/2006     2006         365       365            0            0               0
## 35 2006/2007     2007         365       365            0            0               0
## 36 2007/2008     2008         366       366            0            0               0
## 37 2008/2009     2009         365       365            0            0               0
## 38 2009/2010     2010         365       365            0            0               0
## 39 2010/2011     2011         365       365            0            0               0
## 40 2011/2012     2012         366       366            0            0               0
## 41 2012/2013     2013         365       365            0            0               0
## 42 2013/2014     2014         365       365            0            0               0
## 43 2014/2015     2015         365       365            0            0               0
## 44 2015/2016     2016         366       366            0            0               0
## 45 2016/2017     2017         365       365            0            0               0
## 46 2017/2018     2018         365       365            0            0               0
## 47 2018/2019     2019         365       365            0            0               0
## 48 2019/2020     2020         366       366            0            0               0
## 49 2020/2021     2021         365       365            0            0               0
## 50 2021/2022     2022         365       365            0            0               0
## 51 2022/2023     2023         365       365            0            0               0
##    Perc_complete
## 1            100
## 2            100
## 3            100
## 4            100
## 5            100
## 6            100
## 7            100
## 8            100
## 9            100
## 10           100
## 11           100
## 12           100
## 13           100
## 14           100
## 15           100
## 16           100
## 17           100
## 18           100
## 19           100
## 20           100
## 21           100
## 22           100
## 23           100
## 24           100
## 25           100
## 26           100
## 27           100
## 28           100
## 29           100
## 30           100
## 31           100
## 32           100
## 33           100
## 34           100
## 35           100
## 36           100
## 37           100
## 38           100
## 39           100
## 40           100
## 41           100
## 42           100
## 43           100
## 44           100
## 45           100
## 46           100
## 47           100
## 48           100
## 49           100
## 50           100
## 51           100</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="historic-temperature-scenarios.html#cb225-1" tabindex="-1"></a>Yakima_temps <span class="ot">&lt;-</span> Yakima_patched<span class="sc">$</span>weather</span></code></pre></div>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="historic-temperature-scenarios.html#cb226-1" tabindex="-1"></a>temperature_means <span class="ot">&lt;-</span> </span>
<span id="cb226-2"><a href="historic-temperature-scenarios.html#cb226-2" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Year =</span> <span class="fu">min</span>(Yakima_temps<span class="sc">$</span>Year)<span class="sc">:</span><span class="fu">max</span>(Yakima_temps<span class="sc">$</span>Year),</span>
<span id="cb226-3"><a href="historic-temperature-scenarios.html#cb226-3" tabindex="-1"></a>             <span class="at">Tmin =</span> <span class="fu">aggregate</span>(Yakima_temps<span class="sc">$</span>Tmin,</span>
<span id="cb226-4"><a href="historic-temperature-scenarios.html#cb226-4" tabindex="-1"></a>                              <span class="at">FUN =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb226-5"><a href="historic-temperature-scenarios.html#cb226-5" tabindex="-1"></a>                              <span class="at">by =</span> <span class="fu">list</span>(Yakima_temps<span class="sc">$</span>Year))[,<span class="dv">2</span>],</span>
<span id="cb226-6"><a href="historic-temperature-scenarios.html#cb226-6" tabindex="-1"></a>             <span class="at">Tmax=</span><span class="fu">aggregate</span>(Yakima_temps<span class="sc">$</span>Tmax,</span>
<span id="cb226-7"><a href="historic-temperature-scenarios.html#cb226-7" tabindex="-1"></a>                            <span class="at">FUN =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb226-8"><a href="historic-temperature-scenarios.html#cb226-8" tabindex="-1"></a>                            <span class="at">by =</span> <span class="fu">list</span>(Yakima_temps<span class="sc">$</span>Year))[,<span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb226-9"><a href="historic-temperature-scenarios.html#cb226-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">runn_mean_Tmin =</span> <span class="fu">runn_mean</span>(Tmin,<span class="dv">15</span>),</span>
<span id="cb226-10"><a href="historic-temperature-scenarios.html#cb226-10" tabindex="-1"></a>         <span class="at">runn_mean_Tmax =</span> <span class="fu">runn_mean</span>(Tmax,<span class="dv">15</span>))</span>
<span id="cb226-11"><a href="historic-temperature-scenarios.html#cb226-11" tabindex="-1"></a></span>
<span id="cb226-12"><a href="historic-temperature-scenarios.html#cb226-12" tabindex="-1"></a></span>
<span id="cb226-13"><a href="historic-temperature-scenarios.html#cb226-13" tabindex="-1"></a>Tmin_regression <span class="ot">&lt;-</span> <span class="fu">lm</span>(Tmin<span class="sc">~</span>Year,</span>
<span id="cb226-14"><a href="historic-temperature-scenarios.html#cb226-14" tabindex="-1"></a>                      temperature_means)</span>
<span id="cb226-15"><a href="historic-temperature-scenarios.html#cb226-15" tabindex="-1"></a></span>
<span id="cb226-16"><a href="historic-temperature-scenarios.html#cb226-16" tabindex="-1"></a>Tmax_regression <span class="ot">&lt;-</span> <span class="fu">lm</span>(Tmax<span class="sc">~</span>Year,</span>
<span id="cb226-17"><a href="historic-temperature-scenarios.html#cb226-17" tabindex="-1"></a>                      temperature_means)</span>
<span id="cb226-18"><a href="historic-temperature-scenarios.html#cb226-18" tabindex="-1"></a></span>
<span id="cb226-19"><a href="historic-temperature-scenarios.html#cb226-19" tabindex="-1"></a>temperature_means <span class="ot">&lt;-</span> temperature_means <span class="sc">%&gt;%</span></span>
<span id="cb226-20"><a href="historic-temperature-scenarios.html#cb226-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">regression_Tmin =</span> Tmin_regression<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span></span>
<span id="cb226-21"><a href="historic-temperature-scenarios.html#cb226-21" tabindex="-1"></a>           Tmin_regression<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>temperature_means<span class="sc">$</span>Year,</span>
<span id="cb226-22"><a href="historic-temperature-scenarios.html#cb226-22" tabindex="-1"></a>         <span class="at">regression_Tmax =</span> Tmax_regression<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span></span>
<span id="cb226-23"><a href="historic-temperature-scenarios.html#cb226-23" tabindex="-1"></a>           Tmax_regression<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>temperature_means<span class="sc">$</span>Year</span>
<span id="cb226-24"><a href="historic-temperature-scenarios.html#cb226-24" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="historic-temperature-scenarios.html#cb227-1" tabindex="-1"></a><span class="co"># plot mean monthly minimum temperature of 1973 to 2023</span></span>
<span id="cb227-2"><a href="historic-temperature-scenarios.html#cb227-2" tabindex="-1"></a><span class="fu">ggplot</span>(temperature_means,</span>
<span id="cb227-3"><a href="historic-temperature-scenarios.html#cb227-3" tabindex="-1"></a>       <span class="fu">aes</span>(Year,</span>
<span id="cb227-4"><a href="historic-temperature-scenarios.html#cb227-4" tabindex="-1"></a>           Tmin)) <span class="sc">+</span> </span>
<span id="cb227-5"><a href="historic-temperature-scenarios.html#cb227-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb227-6"><a href="historic-temperature-scenarios.html#cb227-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> temperature_means,</span>
<span id="cb227-7"><a href="historic-temperature-scenarios.html#cb227-7" tabindex="-1"></a>            <span class="fu">aes</span>(Year,</span>
<span id="cb227-8"><a href="historic-temperature-scenarios.html#cb227-8" tabindex="-1"></a>                runn_mean_Tmin),</span>
<span id="cb227-9"><a href="historic-temperature-scenarios.html#cb227-9" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb227-10"><a href="historic-temperature-scenarios.html#cb227-10" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb227-11"><a href="historic-temperature-scenarios.html#cb227-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> temperature_means,</span>
<span id="cb227-12"><a href="historic-temperature-scenarios.html#cb227-12" tabindex="-1"></a>            <span class="fu">aes</span>(Year,</span>
<span id="cb227-13"><a href="historic-temperature-scenarios.html#cb227-13" tabindex="-1"></a>                regression_Tmin),</span>
<span id="cb227-14"><a href="historic-temperature-scenarios.html#cb227-14" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb227-15"><a href="historic-temperature-scenarios.html#cb227-15" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb227-16"><a href="historic-temperature-scenarios.html#cb227-16" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb227-17"><a href="historic-temperature-scenarios.html#cb227-17" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Mean monthly minimum temperature (°C)&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-258-1.png" width="672" /></p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="historic-temperature-scenarios.html#cb228-1" tabindex="-1"></a><span class="co"># plot mean monthly maximum temperature of 1973 to 2023</span></span>
<span id="cb228-2"><a href="historic-temperature-scenarios.html#cb228-2" tabindex="-1"></a><span class="fu">ggplot</span>(temperature_means,</span>
<span id="cb228-3"><a href="historic-temperature-scenarios.html#cb228-3" tabindex="-1"></a>       <span class="fu">aes</span>(Year,</span>
<span id="cb228-4"><a href="historic-temperature-scenarios.html#cb228-4" tabindex="-1"></a>           Tmax)) <span class="sc">+</span> </span>
<span id="cb228-5"><a href="historic-temperature-scenarios.html#cb228-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb228-6"><a href="historic-temperature-scenarios.html#cb228-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> temperature_means,</span>
<span id="cb228-7"><a href="historic-temperature-scenarios.html#cb228-7" tabindex="-1"></a>            <span class="fu">aes</span>(Year,</span>
<span id="cb228-8"><a href="historic-temperature-scenarios.html#cb228-8" tabindex="-1"></a>                runn_mean_Tmax),</span>
<span id="cb228-9"><a href="historic-temperature-scenarios.html#cb228-9" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb228-10"><a href="historic-temperature-scenarios.html#cb228-10" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb228-11"><a href="historic-temperature-scenarios.html#cb228-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> temperature_means,</span>
<span id="cb228-12"><a href="historic-temperature-scenarios.html#cb228-12" tabindex="-1"></a>            <span class="fu">aes</span>(Year, </span>
<span id="cb228-13"><a href="historic-temperature-scenarios.html#cb228-13" tabindex="-1"></a>                regression_Tmax),</span>
<span id="cb228-14"><a href="historic-temperature-scenarios.html#cb228-14" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb228-15"><a href="historic-temperature-scenarios.html#cb228-15" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb228-16"><a href="historic-temperature-scenarios.html#cb228-16" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb228-17"><a href="historic-temperature-scenarios.html#cb228-17" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Mean monthly maximum temperature (°C)&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-259-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li><em>Produce chill distributions for these scenarios and plot them.</em></li>
</ol>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="historic-temperature-scenarios.html#cb229-1" tabindex="-1"></a>scenario_1980 <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_from_records</span>(<span class="at">weather =</span> Yakima_temps,</span>
<span id="cb229-2"><a href="historic-temperature-scenarios.html#cb229-2" tabindex="-1"></a>                                                   <span class="at">year =</span> <span class="dv">1980</span>)</span>
<span id="cb229-3"><a href="historic-temperature-scenarios.html#cb229-3" tabindex="-1"></a></span>
<span id="cb229-4"><a href="historic-temperature-scenarios.html#cb229-4" tabindex="-1"></a></span>
<span id="cb229-5"><a href="historic-temperature-scenarios.html#cb229-5" tabindex="-1"></a></span>
<span id="cb229-6"><a href="historic-temperature-scenarios.html#cb229-6" tabindex="-1"></a>temps_1980 <span class="ot">&lt;-</span> <span class="fu">temperature_generation</span>(<span class="at">weather =</span> Yakima_temps,</span>
<span id="cb229-7"><a href="historic-temperature-scenarios.html#cb229-7" tabindex="-1"></a>                                     <span class="at">years =</span> <span class="fu">c</span>(<span class="dv">1973</span>, <span class="dv">2023</span>),</span>
<span id="cb229-8"><a href="historic-temperature-scenarios.html#cb229-8" tabindex="-1"></a>                                     <span class="at">sim_years =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">2100</span>),</span>
<span id="cb229-9"><a href="historic-temperature-scenarios.html#cb229-9" tabindex="-1"></a>                                     <span class="at">temperature_scenario =</span> scenario_1980)</span></code></pre></div>
<pre><code>## Warning: Absolute temperature scenario specified - calibration weather record only used for
## simulating temperature variation, but not for the means</code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="historic-temperature-scenarios.html#cb231-1" tabindex="-1"></a>scenario_1998 <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_from_records</span>(<span class="at">weather =</span> Yakima_temps,</span>
<span id="cb231-2"><a href="historic-temperature-scenarios.html#cb231-2" tabindex="-1"></a>                                                   <span class="at">year =</span> <span class="dv">1998</span>)</span>
<span id="cb231-3"><a href="historic-temperature-scenarios.html#cb231-3" tabindex="-1"></a></span>
<span id="cb231-4"><a href="historic-temperature-scenarios.html#cb231-4" tabindex="-1"></a>relative_scenario <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_baseline_adjustment</span>(</span>
<span id="cb231-5"><a href="historic-temperature-scenarios.html#cb231-5" tabindex="-1"></a>  <span class="at">baseline =</span> scenario_1998,</span>
<span id="cb231-6"><a href="historic-temperature-scenarios.html#cb231-6" tabindex="-1"></a>  <span class="at">temperature_scenario =</span> scenario_1980)</span>
<span id="cb231-7"><a href="historic-temperature-scenarios.html#cb231-7" tabindex="-1"></a></span>
<span id="cb231-8"><a href="historic-temperature-scenarios.html#cb231-8" tabindex="-1"></a>temps_1980 <span class="ot">&lt;-</span> <span class="fu">temperature_generation</span>(<span class="at">weather =</span> Yakima_temps,</span>
<span id="cb231-9"><a href="historic-temperature-scenarios.html#cb231-9" tabindex="-1"></a>                                   <span class="at">years =</span> <span class="fu">c</span>(<span class="dv">1973</span>, <span class="dv">2023</span>),</span>
<span id="cb231-10"><a href="historic-temperature-scenarios.html#cb231-10" tabindex="-1"></a>                                   <span class="at">sim_years =</span> <span class="fu">c</span>(<span class="dv">2001</span>,<span class="dv">2100</span>),</span>
<span id="cb231-11"><a href="historic-temperature-scenarios.html#cb231-11" tabindex="-1"></a>                                   <span class="at">temperature_scenario =</span> relative_scenario)</span>
<span id="cb231-12"><a href="historic-temperature-scenarios.html#cb231-12" tabindex="-1"></a></span>
<span id="cb231-13"><a href="historic-temperature-scenarios.html#cb231-13" tabindex="-1"></a>all_past_scenarios <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_from_records</span>(</span>
<span id="cb231-14"><a href="historic-temperature-scenarios.html#cb231-14" tabindex="-1"></a>  <span class="at">weather =</span> Yakima_temps,</span>
<span id="cb231-15"><a href="historic-temperature-scenarios.html#cb231-15" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">c</span>(<span class="dv">1980</span>,</span>
<span id="cb231-16"><a href="historic-temperature-scenarios.html#cb231-16" tabindex="-1"></a>           <span class="dv">1990</span>,</span>
<span id="cb231-17"><a href="historic-temperature-scenarios.html#cb231-17" tabindex="-1"></a>           <span class="dv">2000</span>,</span>
<span id="cb231-18"><a href="historic-temperature-scenarios.html#cb231-18" tabindex="-1"></a>           <span class="dv">2010</span>, </span>
<span id="cb231-19"><a href="historic-temperature-scenarios.html#cb231-19" tabindex="-1"></a>           <span class="dv">2020</span>))</span>
<span id="cb231-20"><a href="historic-temperature-scenarios.html#cb231-20" tabindex="-1"></a></span>
<span id="cb231-21"><a href="historic-temperature-scenarios.html#cb231-21" tabindex="-1"></a>adjusted_scenarios <span class="ot">&lt;-</span> <span class="fu">temperature_scenario_baseline_adjustment</span>(</span>
<span id="cb231-22"><a href="historic-temperature-scenarios.html#cb231-22" tabindex="-1"></a>  <span class="at">baseline =</span> scenario_1998,</span>
<span id="cb231-23"><a href="historic-temperature-scenarios.html#cb231-23" tabindex="-1"></a>  <span class="at">temperature_scenario =</span> all_past_scenarios)</span>
<span id="cb231-24"><a href="historic-temperature-scenarios.html#cb231-24" tabindex="-1"></a></span>
<span id="cb231-25"><a href="historic-temperature-scenarios.html#cb231-25" tabindex="-1"></a>all_past_scenario_temps <span class="ot">&lt;-</span> <span class="fu">temperature_generation</span>(</span>
<span id="cb231-26"><a href="historic-temperature-scenarios.html#cb231-26" tabindex="-1"></a>  <span class="at">weather =</span> Yakima_temps,</span>
<span id="cb231-27"><a href="historic-temperature-scenarios.html#cb231-27" tabindex="-1"></a>  <span class="at">years =</span> <span class="fu">c</span>(<span class="dv">1973</span>, <span class="dv">2023</span>),</span>
<span id="cb231-28"><a href="historic-temperature-scenarios.html#cb231-28" tabindex="-1"></a>  <span class="at">sim_years =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">2100</span>),</span>
<span id="cb231-29"><a href="historic-temperature-scenarios.html#cb231-29" tabindex="-1"></a>  <span class="at">temperature_scenario =</span> adjusted_scenarios)</span>
<span id="cb231-30"><a href="historic-temperature-scenarios.html#cb231-30" tabindex="-1"></a></span>
<span id="cb231-31"><a href="historic-temperature-scenarios.html#cb231-31" tabindex="-1"></a><span class="fu">save_temperature_scenarios</span>(all_past_scenario_temps, <span class="st">&quot;Yakima&quot;</span>, <span class="st">&quot;Yakima_hist_scenarios&quot;</span>)</span>
<span id="cb231-32"><a href="historic-temperature-scenarios.html#cb231-32" tabindex="-1"></a></span>
<span id="cb231-33"><a href="historic-temperature-scenarios.html#cb231-33" tabindex="-1"></a>frost_model <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb231-34"><a href="historic-temperature-scenarios.html#cb231-34" tabindex="-1"></a>  <span class="fu">step_model</span>(x,</span>
<span id="cb231-35"><a href="historic-temperature-scenarios.html#cb231-35" tabindex="-1"></a>             <span class="fu">data.frame</span>(</span>
<span id="cb231-36"><a href="historic-temperature-scenarios.html#cb231-36" tabindex="-1"></a>               <span class="at">lower =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000</span>,<span class="dv">0</span>),</span>
<span id="cb231-37"><a href="historic-temperature-scenarios.html#cb231-37" tabindex="-1"></a>               <span class="at">upper  =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1000</span>),</span>
<span id="cb231-38"><a href="historic-temperature-scenarios.html#cb231-38" tabindex="-1"></a>               <span class="at">weight =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)))</span>
<span id="cb231-39"><a href="historic-temperature-scenarios.html#cb231-39" tabindex="-1"></a></span>
<span id="cb231-40"><a href="historic-temperature-scenarios.html#cb231-40" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Chill_Portions =</span> Dynamic_Model,</span>
<span id="cb231-41"><a href="historic-temperature-scenarios.html#cb231-41" tabindex="-1"></a>               <span class="at">GDH =</span> GDH,</span>
<span id="cb231-42"><a href="historic-temperature-scenarios.html#cb231-42" tabindex="-1"></a>               <span class="at">Frost_H =</span> frost_model)</span>
<span id="cb231-43"><a href="historic-temperature-scenarios.html#cb231-43" tabindex="-1"></a></span>
<span id="cb231-44"><a href="historic-temperature-scenarios.html#cb231-44" tabindex="-1"></a>chill_hist_scenario_list <span class="ot">&lt;-</span> <span class="fu">tempResponse_daily_list</span>(all_past_scenario_temps,</span>
<span id="cb231-45"><a href="historic-temperature-scenarios.html#cb231-45" tabindex="-1"></a>                                                    <span class="at">latitude =</span> <span class="fl">46.6</span>,</span>
<span id="cb231-46"><a href="historic-temperature-scenarios.html#cb231-46" tabindex="-1"></a>                                                    <span class="at">Start_JDay =</span> <span class="dv">305</span>,</span>
<span id="cb231-47"><a href="historic-temperature-scenarios.html#cb231-47" tabindex="-1"></a>                                                    <span class="at">End_JDay =</span> <span class="dv">59</span>,</span>
<span id="cb231-48"><a href="historic-temperature-scenarios.html#cb231-48" tabindex="-1"></a>                                                    <span class="at">models =</span> models)</span>
<span id="cb231-49"><a href="historic-temperature-scenarios.html#cb231-49" tabindex="-1"></a></span>
<span id="cb231-50"><a href="historic-temperature-scenarios.html#cb231-50" tabindex="-1"></a>chill_hist_scenario_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(chill_hist_scenario_list,</span>
<span id="cb231-51"><a href="historic-temperature-scenarios.html#cb231-51" tabindex="-1"></a>                                   <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span></span>
<span id="cb231-52"><a href="historic-temperature-scenarios.html#cb231-52" tabindex="-1"></a>                                     <span class="fu">filter</span>(Perc_complete <span class="sc">==</span> <span class="dv">100</span>))</span>
<span id="cb231-53"><a href="historic-temperature-scenarios.html#cb231-53" tabindex="-1"></a></span>
<span id="cb231-54"><a href="historic-temperature-scenarios.html#cb231-54" tabindex="-1"></a><span class="fu">save_temperature_scenarios</span>(chill_hist_scenario_list, <span class="st">&quot;Yakima&quot;</span>,<span class="st">&quot;Yakima_hist_chill_305_59&quot;</span>)</span>
<span id="cb231-55"><a href="historic-temperature-scenarios.html#cb231-55" tabindex="-1"></a></span>
<span id="cb231-56"><a href="historic-temperature-scenarios.html#cb231-56" tabindex="-1"></a>scenarios <span class="ot">&lt;-</span> <span class="fu">names</span>(chill_hist_scenario_list)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb231-57"><a href="historic-temperature-scenarios.html#cb231-57" tabindex="-1"></a></span>
<span id="cb231-58"><a href="historic-temperature-scenarios.html#cb231-58" tabindex="-1"></a>all_scenarios <span class="ot">&lt;-</span> chill_hist_scenario_list[[scenarios[<span class="dv">1</span>]]] <span class="sc">%&gt;%</span></span>
<span id="cb231-59"><a href="historic-temperature-scenarios.html#cb231-59" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scenario =</span> <span class="fu">as.numeric</span>(scenarios[<span class="dv">1</span>]))</span>
<span id="cb231-60"><a href="historic-temperature-scenarios.html#cb231-60" tabindex="-1"></a></span>
<span id="cb231-61"><a href="historic-temperature-scenarios.html#cb231-61" tabindex="-1"></a><span class="cf">for</span> (sc <span class="cf">in</span> scenarios[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb231-62"><a href="historic-temperature-scenarios.html#cb231-62" tabindex="-1"></a>  all_scenarios <span class="ot">&lt;-</span> all_scenarios <span class="sc">%&gt;%</span></span>
<span id="cb231-63"><a href="historic-temperature-scenarios.html#cb231-63" tabindex="-1"></a>  <span class="fu">rbind</span>(chill_hist_scenario_list[[sc]] <span class="sc">%&gt;%</span></span>
<span id="cb231-64"><a href="historic-temperature-scenarios.html#cb231-64" tabindex="-1"></a>          <span class="fu">cbind</span>(</span>
<span id="cb231-65"><a href="historic-temperature-scenarios.html#cb231-65" tabindex="-1"></a>            <span class="at">scenario=</span><span class="fu">as.numeric</span>(sc))</span>
<span id="cb231-66"><a href="historic-temperature-scenarios.html#cb231-66" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb231-67"><a href="historic-temperature-scenarios.html#cb231-67" tabindex="-1"></a>  <span class="fu">filter</span>(Perc_complete <span class="sc">==</span> <span class="dv">100</span>)</span>
<span id="cb231-68"><a href="historic-temperature-scenarios.html#cb231-68" tabindex="-1"></a></span>
<span id="cb231-69"><a href="historic-temperature-scenarios.html#cb231-69" tabindex="-1"></a><span class="co"># Let&#39;s compute the actual &#39;observed&#39; chill for comparison</span></span>
<span id="cb231-70"><a href="historic-temperature-scenarios.html#cb231-70" tabindex="-1"></a>actual_chill <span class="ot">&lt;-</span> <span class="fu">tempResponse_daily_list</span>(Yakima_temps,</span>
<span id="cb231-71"><a href="historic-temperature-scenarios.html#cb231-71" tabindex="-1"></a>                                        <span class="at">latitude=</span><span class="fl">46.6</span>,</span>
<span id="cb231-72"><a href="historic-temperature-scenarios.html#cb231-72" tabindex="-1"></a>                                        <span class="at">Start_JDay =</span> <span class="dv">305</span>,</span>
<span id="cb231-73"><a href="historic-temperature-scenarios.html#cb231-73" tabindex="-1"></a>                                        <span class="at">End_JDay =</span> <span class="dv">59</span>,</span>
<span id="cb231-74"><a href="historic-temperature-scenarios.html#cb231-74" tabindex="-1"></a>                                        models)[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb231-75"><a href="historic-temperature-scenarios.html#cb231-75" tabindex="-1"></a>  <span class="fu">filter</span>(Perc_complete <span class="sc">==</span> <span class="dv">100</span>)</span></code></pre></div>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="historic-temperature-scenarios.html#cb232-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> all_scenarios,</span>
<span id="cb232-2"><a href="historic-temperature-scenarios.html#cb232-2" tabindex="-1"></a>       <span class="fu">aes</span>(scenario,</span>
<span id="cb232-3"><a href="historic-temperature-scenarios.html#cb232-3" tabindex="-1"></a>           Chill_Portions,</span>
<span id="cb232-4"><a href="historic-temperature-scenarios.html#cb232-4" tabindex="-1"></a>           <span class="at">fill =</span> <span class="fu">factor</span>(scenario))) <span class="sc">+</span></span>
<span id="cb232-5"><a href="historic-temperature-scenarios.html#cb232-5" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb232-6"><a href="historic-temperature-scenarios.html#cb232-6" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Chill accumulation (Chill Portions)&quot;</span>) <span class="sc">+</span></span>
<span id="cb232-7"><a href="historic-temperature-scenarios.html#cb232-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Scenario year&quot;</span>) <span class="sc">+</span></span>
<span id="cb232-8"><a href="historic-temperature-scenarios.html#cb232-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb232-9"><a href="historic-temperature-scenarios.html#cb232-9" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb232-10"><a href="historic-temperature-scenarios.html#cb232-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> actual_chill,</span>
<span id="cb232-11"><a href="historic-temperature-scenarios.html#cb232-11" tabindex="-1"></a>             <span class="fu">aes</span>(End_year,</span>
<span id="cb232-12"><a href="historic-temperature-scenarios.html#cb232-12" tabindex="-1"></a>                 Chill_Portions,</span>
<span id="cb232-13"><a href="historic-temperature-scenarios.html#cb232-13" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb232-14"><a href="historic-temperature-scenarios.html#cb232-14" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb232-15"><a href="historic-temperature-scenarios.html#cb232-15" tabindex="-1"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb232-16"><a href="historic-temperature-scenarios.html#cb232-16" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Scenario&quot;</span>,</span>
<span id="cb232-17"><a href="historic-temperature-scenarios.html#cb232-17" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">unique</span>(all_scenarios<span class="sc">$</span>scenario)) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-261-1.png" width="672" /></p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="historic-temperature-scenarios.html#cb233-1" tabindex="-1"></a><span class="fu">write.csv</span>(actual_chill,<span class="st">&quot;Yakima/Yakima_observed_chill_305_59.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="saving-and-loading-data-and-hiding-this-in-markdown.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="future-temperature-scenarios.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jacqwng/Logbook/edit/main/14-historic.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jacqwng/Logbook/blob/main/14-historic.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
