<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Generating temperature scenarios | Tree phenology Analysis with R</title>
  <meta name="description" content="Chapter 12 Generating temperature scenarios | Tree phenology Analysis with R" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Generating temperature scenarios | Tree phenology Analysis with R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Generating temperature scenarios | Tree phenology Analysis with R" />
  
  
  

<meta name="author" content="Jacqueline Wingen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="filling-gaps-in-temperature-records.html"/>
<link rel="next" href="saving-and-loading-data-and-hiding-this-in-markdown.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tree phenology Analysis with R</a></li>
<li><a href="index.html"><img src="images/chillR_hexSticker.png" width="75%"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#learning-goals"><i class="fa fa-check"></i><b>1.1</b> Learning goals</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tools.html"><a href="tools.html"><i class="fa fa-check"></i><b>2</b> Tools</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tools.html"><a href="tools.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="tools.html"><a href="tools.html#git-and-github"><i class="fa fa-check"></i><b>2.2</b> Git and Github</a></li>
<li class="chapter" data-level="2.3" data-path="tools.html"><a href="tools.html#rmarkdown"><i class="fa fa-check"></i><b>2.3</b> Rmarkdown</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tree-dormancy.html"><a href="tree-dormancy.html"><i class="fa fa-check"></i><b>3</b> Tree dormancy</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tree-dormancy.html"><a href="tree-dormancy.html#learning-goals-1"><i class="fa fa-check"></i><b>3.1</b> Learning goals</a></li>
<li class="chapter" data-level="3.2" data-path="tree-dormancy.html"><a href="tree-dormancy.html#introduction-to-dormancy"><i class="fa fa-check"></i><b>3.2</b> Introduction to dormancy</a></li>
<li class="chapter" data-level="3.3" data-path="tree-dormancy.html"><a href="tree-dormancy.html#dormancy-physiology"><i class="fa fa-check"></i><b>3.3</b> Dormancy physiology</a></li>
<li class="chapter" data-level="3.4" data-path="tree-dormancy.html"><a href="tree-dormancy.html#experimental-and-statistical-determination-of-chilling-and-forcing-periods"><i class="fa fa-check"></i><b>3.4</b> Experimental and statistical determination of chilling and forcing periods</a></li>
<li class="chapter" data-level="3.5" data-path="tree-dormancy.html"><a href="tree-dormancy.html#phenology-record-and-bbch-scale"><i class="fa fa-check"></i><b>3.5</b> Phenology record and BBCH scale</a></li>
<li class="chapter" data-level="3.6" data-path="tree-dormancy.html"><a href="tree-dormancy.html#excercises-on-tree-dormancy"><i class="fa fa-check"></i><b>3.6</b> <code>Excercises</code> on tree dormancy</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html"><i class="fa fa-check"></i><b>4</b> Climate change and impact projection</a>
<ul>
<li class="chapter" data-level="4.1" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#the-drivers-of-climate-change"><i class="fa fa-check"></i><b>4.1</b> The drivers of climate change</a></li>
<li class="chapter" data-level="4.2" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#whats-already-known"><i class="fa fa-check"></i><b>4.2</b> What’s already known</a></li>
<li class="chapter" data-level="4.3" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#future-scenarios"><i class="fa fa-check"></i><b>4.3</b> Future scenarios</a></li>
<li class="chapter" data-level="4.4" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#impact-projections-approaches"><i class="fa fa-check"></i><b>4.4</b> Impact projections approaches</a></li>
<li class="chapter" data-level="4.5" data-path="climate-change-and-impact-projection.html"><a href="climate-change-and-impact-projection.html#exercises-on-climate-change"><i class="fa fa-check"></i><b>4.5</b> <code>Exercises</code> on climate change</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html"><i class="fa fa-check"></i><b>5</b> Winter chill projections</a>
<ul>
<li class="chapter" data-level="5.1" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-oman"><i class="fa fa-check"></i><b>5.2</b> Winter chill in Oman</a></li>
<li class="chapter" data-level="5.3" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-sensitivity"><i class="fa fa-check"></i><b>5.3</b> Chill model sensitivity</a></li>
<li class="chapter" data-level="5.4" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-california"><i class="fa fa-check"></i><b>5.4</b> Winter chill in California</a></li>
<li class="chapter" data-level="5.5" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-ratios"><i class="fa fa-check"></i><b>5.5</b> Winter chill ratios</a></li>
<li class="chapter" data-level="5.6" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#a-global-projection-of-future-winter-chill"><i class="fa fa-check"></i><b>5.6</b> A global projection of future winter chill</a></li>
<li class="chapter" data-level="5.7" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-germany"><i class="fa fa-check"></i><b>5.7</b> Winter chill in Germany</a></li>
<li class="chapter" data-level="5.8" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-tunisia"><i class="fa fa-check"></i><b>5.8</b> Winter chill in Tunisia</a></li>
<li class="chapter" data-level="5.9" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#winter-chill-in-chile"><i class="fa fa-check"></i><b>5.9</b> Winter chill in Chile</a></li>
<li class="chapter" data-level="5.10" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-patagonia"><i class="fa fa-check"></i><b>5.10</b> Chill projection for Patagonia</a></li>
<li class="chapter" data-level="5.11" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-model-comparison"><i class="fa fa-check"></i><b>5.11</b> Chill model comparison</a></li>
<li class="chapter" data-level="5.12" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#chill-projection-for-all-of-tunisia"><i class="fa fa-check"></i><b>5.12</b> Chill projection for all of Tunisia</a></li>
<li class="chapter" data-level="5.13" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#revisiting-chill-accumulation-in-oman"><i class="fa fa-check"></i><b>5.13</b> Revisiting chill accumulation in Oman</a></li>
<li class="chapter" data-level="5.14" data-path="winter-chill-projections.html"><a href="winter-chill-projections.html#exercises-on-past-chill-projections"><i class="fa fa-check"></i><b>5.14</b> <code>Exercises</code> on past chill projections</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="manual-chill.html"><a href="manual-chill.html"><i class="fa fa-check"></i><b>6</b> Manual chill</a>
<ul>
<li class="chapter" data-level="6.1" data-path="manual-chill.html"><a href="manual-chill.html#learning-goals-3"><i class="fa fa-check"></i><b>6.1</b> Learning goals</a></li>
<li class="chapter" data-level="6.2" data-path="manual-chill.html"><a href="manual-chill.html#chilling-hours-calculation-using-chillr"><i class="fa fa-check"></i><b>6.2</b> Chilling hours calculation using chillR</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="manual-chill.html"><a href="manual-chill.html#data-requirements"><i class="fa fa-check"></i><b>6.2.1</b> <strong>Data Requirements</strong></a></li>
<li class="chapter" data-level="6.2.2" data-path="manual-chill.html"><a href="manual-chill.html#loading-and-preparing-data"><i class="fa fa-check"></i><b>6.2.2</b> Loading and Preparing Data</a></li>
<li class="chapter" data-level="6.2.3" data-path="manual-chill.html"><a href="manual-chill.html#manual-calculation-of-chilling-hours"><i class="fa fa-check"></i><b>6.2.3</b> <strong>Manual Calculation of Chilling Hours</strong></a></li>
<li class="chapter" data-level="6.2.4" data-path="manual-chill.html"><a href="manual-chill.html#automation-with-functions"><i class="fa fa-check"></i><b>6.2.4</b> Automation with Functions</a></li>
<li class="chapter" data-level="6.2.5" data-path="manual-chill.html"><a href="manual-chill.html#application-example"><i class="fa fa-check"></i><b>6.2.5</b> Application Example</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="manual-chill.html"><a href="manual-chill.html#exercises-on-basic-chill-modeling"><i class="fa fa-check"></i><b>6.3</b> <code>Exercises</code> on basic chill modeling</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chill.html"><a href="chill.html"><i class="fa fa-check"></i><b>7</b> Chill</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chill.html"><a href="chill.html#learning-goals-4"><i class="fa fa-check"></i><b>7.1</b> Learning goals</a></li>
<li class="chapter" data-level="7.2" data-path="chill.html"><a href="chill.html#chilling_hours-function"><i class="fa fa-check"></i><b>7.2</b> <code>Chilling_Hours()</code> function</a></li>
<li class="chapter" data-level="7.3" data-path="chill.html"><a href="chill.html#utah-model"><i class="fa fa-check"></i><b>7.3</b> Utah Model</a></li>
<li class="chapter" data-level="7.4" data-path="chill.html"><a href="chill.html#creating-custom-chill-models-with-step_model"><i class="fa fa-check"></i><b>7.4</b> Creating Custom Chill Models with <code>step_model()</code></a></li>
<li class="chapter" data-level="7.5" data-path="chill.html"><a href="chill.html#dynamic-model"><i class="fa fa-check"></i><b>7.5</b> Dynamic model</a></li>
<li class="chapter" data-level="7.6" data-path="chill.html"><a href="chill.html#chilling-and-tempresponse-functions"><i class="fa fa-check"></i><b>7.6</b> <code>Chilling</code> and <code>tempResponse</code> functions</a></li>
<li class="chapter" data-level="7.7" data-path="chill.html"><a href="chill.html#exercises-on-chill-models"><i class="fa fa-check"></i><b>7.7</b> <code>Exercises</code> on chill models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html"><i class="fa fa-check"></i><b>8</b> Making hourly temperatures</a>
<ul>
<li class="chapter" data-level="8.1" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#learning-goals-5"><i class="fa fa-check"></i><b>8.1</b> Learning goals</a></li>
<li class="chapter" data-level="8.2" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#generating-hourly-temperatures"><i class="fa fa-check"></i><b>8.2</b> Generating hourly temperatures</a></li>
<li class="chapter" data-level="8.3" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#idealized-daily-temperature-curves"><i class="fa fa-check"></i><b>8.3</b> Idealized daily temperature curves</a></li>
<li class="chapter" data-level="8.4" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#empirical-daily-temperature-curves"><i class="fa fa-check"></i><b>8.4</b> Empirical daily temperature curves</a></li>
<li class="chapter" data-level="8.5" data-path="making-hourly-temperatures.html"><a href="making-hourly-temperatures.html#exercises-on-hourly-temperatures"><i class="fa fa-check"></i><b>8.5</b> <code>Exercises</code> on hourly temperatures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html"><i class="fa fa-check"></i><b>9</b> Some useful tools in R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#learning-goals-6"><i class="fa fa-check"></i><b>9.1</b> Learning goals</a></li>
<li class="chapter" data-level="9.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#an-evolving-language---and-a-lifelong-learning-process"><i class="fa fa-check"></i><b>9.2</b> An evolving language - and a lifelong learning process</a></li>
<li class="chapter" data-level="9.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyverse"><i class="fa fa-check"></i><b>9.3</b> The <code>tidyverse</code></a></li>
<li class="chapter" data-level="9.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-ggplot2-package"><i class="fa fa-check"></i><b>9.4</b> The <code>ggplot2</code> package</a></li>
<li class="chapter" data-level="9.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tibble-package"><i class="fa fa-check"></i><b>9.5</b> The <code>tibble</code> package</a></li>
<li class="chapter" data-level="9.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-magrittr-package---pipes"><i class="fa fa-check"></i><b>9.6</b> The <code>magrittr</code> package - pipes</a></li>
<li class="chapter" data-level="9.7" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#the-tidyr-package"><i class="fa fa-check"></i><b>9.7</b> The <code>tidyr</code> package</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_longer"><i class="fa fa-check"></i><b>9.7.1</b> <code>pivot_longer</code></a></li>
<li class="chapter" data-level="9.7.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#pivot_wider"><i class="fa fa-check"></i><b>9.7.2</b> <code>pivot_wider</code></a></li>
<li class="chapter" data-level="9.7.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#select"><i class="fa fa-check"></i><b>9.7.3</b> <code>select</code></a></li>
<li class="chapter" data-level="9.7.4" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#filter"><i class="fa fa-check"></i><b>9.7.4</b> <code>filter</code></a></li>
<li class="chapter" data-level="9.7.5" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#mutate"><i class="fa fa-check"></i><b>9.7.5</b> <code>mutate</code></a></li>
<li class="chapter" data-level="9.7.6" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#arrange"><i class="fa fa-check"></i><b>9.7.6</b> <code>arrange</code></a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#loops"><i class="fa fa-check"></i><b>9.8</b> Loops</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#for-loops"><i class="fa fa-check"></i><b>9.8.1</b> <em>For</em> loops</a></li>
<li class="chapter" data-level="9.8.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#while-loops"><i class="fa fa-check"></i><b>9.8.2</b> <em>While</em> loops</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply-functions"><i class="fa fa-check"></i><b>9.9</b> <code>apply</code> functions</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#sapply"><i class="fa fa-check"></i><b>9.9.1</b> <code>sapply</code></a></li>
<li class="chapter" data-level="9.9.2" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#lapply"><i class="fa fa-check"></i><b>9.9.2</b> <code>lapply</code></a></li>
<li class="chapter" data-level="9.9.3" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#apply"><i class="fa fa-check"></i><b>9.9.3</b> <code>apply</code></a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="some-useful-tools-in-r.html"><a href="some-useful-tools-in-r.html#exercises-on-useful-r-tools"><i class="fa fa-check"></i><b>9.10</b> <code>Exercises</code> on useful R tools</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html"><i class="fa fa-check"></i><b>10</b> Getting temperature data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#learning-goals-for-this-lesson"><i class="fa fa-check"></i><b>10.1</b> Learning goals for this lesson</a></li>
<li class="chapter" data-level="10.2" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#temperature-data-needs"><i class="fa fa-check"></i><b>10.2</b> Temperature data needs</a></li>
<li class="chapter" data-level="10.3" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#the-global-summary-of-the-day-database"><i class="fa fa-check"></i><b>10.3</b> The Global Summary of the Day database</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#actionlist_stations"><i class="fa fa-check"></i><b>10.3.1</b> <code>action=list_stations</code></a></li>
<li class="chapter" data-level="10.3.2" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#actiondownload_weather"><i class="fa fa-check"></i><b>10.3.2</b> <code>action="download_weather"</code></a></li>
<li class="chapter" data-level="10.3.3" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#downloaded-weather-as-action-argument"><i class="fa fa-check"></i><b>10.3.3</b> downloaded weather as <code>action</code> argument</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="getting-temperature-data.html"><a href="getting-temperature-data.html#exercises-on-getting-temperature-data"><i class="fa fa-check"></i><b>10.4</b> <code>Exercises</code> on getting temperature data</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tree phenology Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="generating-temperature-scenarios" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Chapter 12</span> Generating temperature scenarios<a href="generating-temperature-scenarios.html#generating-temperature-scenarios" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-goals-8" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Learning goals<a href="generating-temperature-scenarios.html#learning-goals-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Understand what a weather generator is, (roughly) how it works and why it is useful for planning</li>
<li>Learn how to run the <code>temperature_generation</code> function included in <code>chillR</code></li>
<li>Be able to produce chill profiles for a place of interest using histograms and cumulative distributions</li>
<li>Understand what Safe Winter Chill is and be able to calculate it</li>
</ul>
</div>
<div id="chill-scenarios" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Chill scenarios<a href="generating-temperature-scenarios.html#chill-scenarios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The main goal so far has been to understand chill availability and other agroclimatic conditions at specific sites, which is essential for orchard managers choosing tree species and cultivars. While historical data has been helpful, growers need more tailored, site-specific information. They need a forecast of likely conditions - such as expected chill or heat levels - to make better planting decisions.</p>
</div>
<div id="risk-assessment-in-orchard-planning" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Risk assessment in orchard planning<a href="generating-temperature-scenarios.html#risk-assessment-in-orchard-planning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Because trees are long-lived, they encounter varied temperature patterns throughout their productive years. For optimal yields, trees must meet their climatic requirements every year. Therefore, selecting suitable trees requires understanding the plausible range of weather conditions at a site, helping managers choose trees that reliably meet chill needs or balance early flowering with frost risk. This range is determined by the local climate - essentially, the average of yearly weather patterns, representing all potential weather scenarios from which each year is a random outcome.</p>
<p>Annual weather can be interpreted as a random sample from the full distribution of possible weather conditions. For planning, however, it is more useful to understand this entire distribution rather than relying solely on the randomly observed years. So far, only these samples from historical chill data have been available. In this lesson, the goal is to determine the actual climate pattern to develop temperature profiles for specific locations that support orchard planning.</p>
</div>
<div id="weather-generators" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Weather generators<a href="generating-temperature-scenarios.html#weather-generators" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The best way to characterize the climate of a specific location is through long-term weather records collected there. Such records allow calculation of average monthly temperatures, rainfall extremes, frost frequency, and other metrics. The detail level for describing local climate can vary, and producing realistic weather data requires a certain sophistication.</p>
<p>Weather generators differ significantly in how they model climate, and understanding their methods would help in choosing the best option. For <code>chillR</code>, the weather generator must be R-compatible and align with <code>chillR</code>’s structure. Currently, only one generator <a href="https://cran.r-project.org/web/packages/RMAWGEN/index.html">RMAWGEN</a> meets these requirements, limiting choice. Previously, tools like <a href="https://sites.google.com/view/lars-wg/">LARS-WG</a>, which uses both temperature and rainfall data to model distinct dry and wet spell profiles, were used in analyses (<a href="https://link.springer.com/article/10.1007/s00484-010-0352-y">Luedeling et al., 2011a</a>, <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0020155">2011b</a>). The <code>chillR</code> tool doesn’t need precipitation data but performs well overall. However, evaluating these tools remains challenging, indicating potential for further improvement.</p>
</div>
<div id="weather-generation-in-chillr" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> Weather generation in <code>chillR</code><a href="generating-temperature-scenarios.html#weather-generation-in-chillr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>chillR</code> uses the <a href="https://cran.r-project.org/web/packages/RMAWGEN/index.html">RMAWGEN</a> weather generator, currently the only R-based option found, and has shown to be reliable after initial setup challenges. However, <code>chillR</code> currently generates only temperature data, without comprehensive weather simulation capabilities—a limitation that is being addressed by further development, initiated by <a href="https://inresgb-lehre.iaas.uni-bonn.de/author/lars-caspersen/">Lars Caspersen</a>.</p>
<p>The function <code>temperature_generation</code> in <code>chillR</code> requires calibration using long-term temperature data in <code>chillR</code> format, enabling it to calculate parameters that define the local climate. These parameters are then applied to simulate synthetic temperature data over a specified number of years.</p>
<p>For practice, the Klein-Altendorf dataset (<code>KA_weather</code>) is used as an example. To use <code>temperature_generation</code>, a few key inputs are needed:</p>
<ul>
<li><strong>years</strong>: a vector specifying the years from observed data to characterize the climate.</li>
<li><strong>sim_years</strong>: the years to simulate, used only for labeling purposes in the output dataset.</li>
</ul>
<p>An additional option, <code>temperature_scenario</code>, will be discussed later; initially, its default zero values trigger a warning, which can be ignored for now. The next step is to run the weather generator to compare simulated data with observed records.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="generating-temperature-scenarios.html#cb171-1" tabindex="-1"></a>Temp <span class="ot">&lt;-</span> KA_weather <span class="sc">%&gt;%</span></span>
<span id="cb171-2"><a href="generating-temperature-scenarios.html#cb171-2" tabindex="-1"></a>  <span class="fu">temperature_generation</span>(<span class="at">years =</span> <span class="fu">c</span>(<span class="dv">1998</span>, <span class="dv">2009</span>),</span>
<span id="cb171-3"><a href="generating-temperature-scenarios.html#cb171-3" tabindex="-1"></a>                         <span class="at">sim_years =</span> <span class="fu">c</span>(<span class="dv">2001</span>,<span class="dv">2100</span>))</span>
<span id="cb171-4"><a href="generating-temperature-scenarios.html#cb171-4" tabindex="-1"></a></span>
<span id="cb171-5"><a href="generating-temperature-scenarios.html#cb171-5" tabindex="-1"></a></span>
<span id="cb171-6"><a href="generating-temperature-scenarios.html#cb171-6" tabindex="-1"></a>Temperatures <span class="ot">&lt;-</span> KA_weather <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Year <span class="sc">%in%</span> <span class="dv">1998</span><span class="sc">:</span><span class="dv">2009</span>) <span class="sc">%&gt;%</span></span>
<span id="cb171-7"><a href="generating-temperature-scenarios.html#cb171-7" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">Data_source =</span> <span class="st">&quot;observed&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb171-8"><a href="generating-temperature-scenarios.html#cb171-8" tabindex="-1"></a>  <span class="fu">rbind</span>(</span>
<span id="cb171-9"><a href="generating-temperature-scenarios.html#cb171-9" tabindex="-1"></a>    Temp[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(Year,</span>
<span id="cb171-10"><a href="generating-temperature-scenarios.html#cb171-10" tabindex="-1"></a>                           Month,</span>
<span id="cb171-11"><a href="generating-temperature-scenarios.html#cb171-11" tabindex="-1"></a>                           Day,</span>
<span id="cb171-12"><a href="generating-temperature-scenarios.html#cb171-12" tabindex="-1"></a>                           Tmin,</span>
<span id="cb171-13"><a href="generating-temperature-scenarios.html#cb171-13" tabindex="-1"></a>                           Tmax)) <span class="sc">%&gt;%</span></span>
<span id="cb171-14"><a href="generating-temperature-scenarios.html#cb171-14" tabindex="-1"></a>      <span class="fu">cbind</span>(<span class="at">Data_source =</span> <span class="st">&quot;simulated&quot;</span>)</span>
<span id="cb171-15"><a href="generating-temperature-scenarios.html#cb171-15" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb171-16"><a href="generating-temperature-scenarios.html#cb171-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">ISOdate</span>(<span class="dv">2000</span>,</span>
<span id="cb171-17"><a href="generating-temperature-scenarios.html#cb171-17" tabindex="-1"></a>                                Month,</span>
<span id="cb171-18"><a href="generating-temperature-scenarios.html#cb171-18" tabindex="-1"></a>                                Day)))</span></code></pre></div>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="generating-temperature-scenarios.html#cb172-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Temperatures,</span>
<span id="cb172-2"><a href="generating-temperature-scenarios.html#cb172-2" tabindex="-1"></a>       <span class="fu">aes</span>(Date, Tmin)) <span class="sc">+</span></span>
<span id="cb172-3"><a href="generating-temperature-scenarios.html#cb172-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(Year))) <span class="sc">+</span></span>
<span id="cb172-4"><a href="generating-temperature-scenarios.html#cb172-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Data_source)) <span class="sc">+</span></span>
<span id="cb172-5"><a href="generating-temperature-scenarios.html#cb172-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb172-6"><a href="generating-temperature-scenarios.html#cb172-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb172-7"><a href="generating-temperature-scenarios.html#cb172-7" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">&quot;%b&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-227-1.png" width="672" /></p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="generating-temperature-scenarios.html#cb173-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Temperatures,</span>
<span id="cb173-2"><a href="generating-temperature-scenarios.html#cb173-2" tabindex="-1"></a>       <span class="fu">aes</span>(Date,Tmax)) <span class="sc">+</span></span>
<span id="cb173-3"><a href="generating-temperature-scenarios.html#cb173-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(Year))) <span class="sc">+</span></span>
<span id="cb173-4"><a href="generating-temperature-scenarios.html#cb173-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Data_source)) <span class="sc">+</span></span>
<span id="cb173-5"><a href="generating-temperature-scenarios.html#cb173-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb173-6"><a href="generating-temperature-scenarios.html#cb173-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb173-7"><a href="generating-temperature-scenarios.html#cb173-7" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">&quot;%b&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-228-1.png" width="672" /></p>
<p>The previous plot was created using <code>geom_smooth</code> in <code>ggplot</code>, rather than <code>geom_line</code>, which reduced noise in the dataset and made the figure easier to interpret.</p>
<p>Overall, the temperature trends were captured well, though some local weather nuances may have been missed. The simulated dataset now contains 100 years of data, even though only 8 years were used for calibration. This expanded dataset allows for a clearer understanding of the frequency of specific temperature-related events. Next, the distribution of winter chill for Klein-Altendorf will be examined based on this analysis.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="generating-temperature-scenarios.html#cb174-1" tabindex="-1"></a>chill_observed <span class="ot">&lt;-</span> Temperatures <span class="sc">%&gt;%</span></span>
<span id="cb174-2"><a href="generating-temperature-scenarios.html#cb174-2" tabindex="-1"></a>  <span class="fu">filter</span>(Data_source <span class="sc">==</span> <span class="st">&quot;observed&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb174-3"><a href="generating-temperature-scenarios.html#cb174-3" tabindex="-1"></a>  <span class="fu">stack_hourly_temps</span>(<span class="at">latitude =</span> <span class="fl">50.4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb174-4"><a href="generating-temperature-scenarios.html#cb174-4" tabindex="-1"></a>  <span class="fu">chilling</span>(<span class="at">Start_JDay =</span> <span class="dv">305</span>,</span>
<span id="cb174-5"><a href="generating-temperature-scenarios.html#cb174-5" tabindex="-1"></a>           <span class="at">End_JDay =</span> <span class="dv">59</span>)</span>
<span id="cb174-6"><a href="generating-temperature-scenarios.html#cb174-6" tabindex="-1"></a>  </span>
<span id="cb174-7"><a href="generating-temperature-scenarios.html#cb174-7" tabindex="-1"></a>chill_simulated <span class="ot">&lt;-</span> Temperatures <span class="sc">%&gt;%</span></span>
<span id="cb174-8"><a href="generating-temperature-scenarios.html#cb174-8" tabindex="-1"></a>  <span class="fu">filter</span>(Data_source <span class="sc">==</span> <span class="st">&quot;simulated&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb174-9"><a href="generating-temperature-scenarios.html#cb174-9" tabindex="-1"></a>  <span class="fu">stack_hourly_temps</span>(<span class="at">latitude =</span> <span class="fl">50.4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb174-10"><a href="generating-temperature-scenarios.html#cb174-10" tabindex="-1"></a>  <span class="fu">chilling</span>(<span class="at">Start_JDay =</span> <span class="dv">305</span>,</span>
<span id="cb174-11"><a href="generating-temperature-scenarios.html#cb174-11" tabindex="-1"></a>           <span class="at">End_JDay =</span> <span class="dv">59</span>)</span>
<span id="cb174-12"><a href="generating-temperature-scenarios.html#cb174-12" tabindex="-1"></a>  </span>
<span id="cb174-13"><a href="generating-temperature-scenarios.html#cb174-13" tabindex="-1"></a>chill_comparison <span class="ot">&lt;-</span></span>
<span id="cb174-14"><a href="generating-temperature-scenarios.html#cb174-14" tabindex="-1"></a>  <span class="fu">cbind</span>(chill_observed,</span>
<span id="cb174-15"><a href="generating-temperature-scenarios.html#cb174-15" tabindex="-1"></a>        <span class="at">Data_source =</span> <span class="st">&quot;observed&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb174-16"><a href="generating-temperature-scenarios.html#cb174-16" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">cbind</span>(chill_simulated,</span>
<span id="cb174-17"><a href="generating-temperature-scenarios.html#cb174-17" tabindex="-1"></a>              <span class="at">Data_source =</span> <span class="st">&quot;simulated&quot;</span>))</span>
<span id="cb174-18"><a href="generating-temperature-scenarios.html#cb174-18" tabindex="-1"></a>  </span>
<span id="cb174-19"><a href="generating-temperature-scenarios.html#cb174-19" tabindex="-1"></a>chill_comparison_full_seasons <span class="ot">&lt;-</span> </span>
<span id="cb174-20"><a href="generating-temperature-scenarios.html#cb174-20" tabindex="-1"></a>  chill_comparison <span class="sc">%&gt;%</span></span>
<span id="cb174-21"><a href="generating-temperature-scenarios.html#cb174-21" tabindex="-1"></a>  <span class="fu">filter</span>(Perc_complete <span class="sc">==</span> <span class="dv">100</span>)</span></code></pre></div>
<p>The data can now be easily visualized using <code>ggplot</code>:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="generating-temperature-scenarios.html#cb175-1" tabindex="-1"></a><span class="fu">ggplot</span>(chill_comparison_full_seasons,</span>
<span id="cb175-2"><a href="generating-temperature-scenarios.html#cb175-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Chill_portions)) <span class="sc">+</span> </span>
<span id="cb175-3"><a href="generating-temperature-scenarios.html#cb175-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>,</span>
<span id="cb175-4"><a href="generating-temperature-scenarios.html#cb175-4" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(Data_source))) <span class="sc">+</span></span>
<span id="cb175-5"><a href="generating-temperature-scenarios.html#cb175-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb175-6"><a href="generating-temperature-scenarios.html#cb175-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Data source&quot;</span>) <span class="sc">+</span></span>
<span id="cb175-7"><a href="generating-temperature-scenarios.html#cb175-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Chill accumulation (Chill Portions)&quot;</span>) <span class="sc">+</span></span>
<span id="cb175-8"><a href="generating-temperature-scenarios.html#cb175-8" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-230-1.png" width="672" /></p>
<p>In the previous code, incomplete winter seasons were manually removed. The resulting histogram shows the distribution of chill that would have been reasonable to expect in Klein-Altendorf between 1998 and 2005. With more observations, these distributions would improve.</p>
<p>These data can also be plotted as a cumulative distribution function, which helps assess the risk of falling below a certain level of chill accumulation. This can also be directly calculated using the <code>quantile</code> function.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="generating-temperature-scenarios.html#cb176-1" tabindex="-1"></a>chill_simulations <span class="ot">&lt;-</span></span>
<span id="cb176-2"><a href="generating-temperature-scenarios.html#cb176-2" tabindex="-1"></a>  chill_comparison_full_seasons <span class="sc">%&gt;%</span></span>
<span id="cb176-3"><a href="generating-temperature-scenarios.html#cb176-3" tabindex="-1"></a>  <span class="fu">filter</span>(Data_source <span class="sc">==</span> <span class="st">&quot;simulated&quot;</span>)</span>
<span id="cb176-4"><a href="generating-temperature-scenarios.html#cb176-4" tabindex="-1"></a>  </span>
<span id="cb176-5"><a href="generating-temperature-scenarios.html#cb176-5" tabindex="-1"></a><span class="fu">ggplot</span>(chill_simulations,</span>
<span id="cb176-6"><a href="generating-temperature-scenarios.html#cb176-6" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Chill_portions)) <span class="sc">+</span></span>
<span id="cb176-7"><a href="generating-temperature-scenarios.html#cb176-7" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">&quot;step&quot;</span>,</span>
<span id="cb176-8"><a href="generating-temperature-scenarios.html#cb176-8" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="fl">1.5</span>,</span>
<span id="cb176-9"><a href="generating-temperature-scenarios.html#cb176-9" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb176-10"><a href="generating-temperature-scenarios.html#cb176-10" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Cumulative probability&quot;</span>) <span class="sc">+</span></span>
<span id="cb176-11"><a href="generating-temperature-scenarios.html#cb176-11" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Chill accumulation (in Chill Portions)&quot;</span>) <span class="sc">+</span></span>
<span id="cb176-12"><a href="generating-temperature-scenarios.html#cb176-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-231-1.png" width="672" /></p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="generating-temperature-scenarios.html#cb177-1" tabindex="-1"></a><span class="co"># Here&#39;s the amount of chill that is exceeded in 90% of all years.</span></span>
<span id="cb177-2"><a href="generating-temperature-scenarios.html#cb177-2" tabindex="-1"></a><span class="fu">quantile</span>(chill_simulations<span class="sc">$</span>Chill_portions,<span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>##      10% 
## 77.21767</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="generating-temperature-scenarios.html#cb179-1" tabindex="-1"></a><span class="co"># and here&#39;s the 50% confidence interval (25th to 75th percentile)</span></span>
<span id="cb179-2"><a href="generating-temperature-scenarios.html#cb179-2" tabindex="-1"></a><span class="fu">quantile</span>(chill_simulations<span class="sc">$</span>Chill_portions, <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.75</span>))</span></code></pre></div>
<pre><code>##      25%      75% 
## 79.68650 84.76564</code></pre>
<p>The 10% quantile calculated above represents what is referred to as “Safe Winter Chill.” This concept is illustrated in the following figure:</p>
<p><img src="images/Figure_2_Boxplots_Davis_chilling_hours_a2.jpg" /></p>
<p>The process for generating the data for this figure is similar to the one used previously, although different tools were employed at the time. The concept of Safe Winter Chill is based on the idea that a grower might tolerate a small risk of not meeting a tree’s chilling requirement. If a tree’s chilling requirement exactly matches the Safe Winter Chill for a site, chill-related issues can be expected roughly one in every ten years. Whether this level of risk is acceptable depends on the grower’s tolerance, but it provides a reasonable threshold. A similar metric can be calculated for growers with different risk tolerances.</p>
</div>
<div id="exercises-on-temperature-generation" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> <code>Exercises</code> on temperature generation<a href="generating-temperature-scenarios.html#exercises-on-temperature-generation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><em>For the location you chose for your earlier analyses, use chillR’s weather generator to produce 100 years of synthetic temperature data.</em></li>
</ol>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="generating-temperature-scenarios.html#cb181-1" tabindex="-1"></a>Yakima <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Yakima/Yakima_weather.csv&quot;</span>)</span>
<span id="cb181-2"><a href="generating-temperature-scenarios.html#cb181-2" tabindex="-1"></a></span>
<span id="cb181-3"><a href="generating-temperature-scenarios.html#cb181-3" tabindex="-1"></a>Temp <span class="ot">&lt;-</span> Yakima <span class="sc">%&gt;%</span> </span>
<span id="cb181-4"><a href="generating-temperature-scenarios.html#cb181-4" tabindex="-1"></a>  <span class="fu">temperature_generation</span>(<span class="at">years =</span> <span class="fu">c</span>(<span class="dv">1998</span>, <span class="dv">2009</span>),</span>
<span id="cb181-5"><a href="generating-temperature-scenarios.html#cb181-5" tabindex="-1"></a>                         <span class="at">sim_years =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">2100</span>))</span>
<span id="cb181-6"><a href="generating-temperature-scenarios.html#cb181-6" tabindex="-1"></a></span>
<span id="cb181-7"><a href="generating-temperature-scenarios.html#cb181-7" tabindex="-1"></a></span>
<span id="cb181-8"><a href="generating-temperature-scenarios.html#cb181-8" tabindex="-1"></a>Temperatures <span class="ot">&lt;-</span> Yakima <span class="sc">%&gt;%</span> </span>
<span id="cb181-9"><a href="generating-temperature-scenarios.html#cb181-9" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, Day, Tmin, Tmax) <span class="sc">%&gt;%</span>  </span>
<span id="cb181-10"><a href="generating-temperature-scenarios.html#cb181-10" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">%in%</span> <span class="dv">1998</span><span class="sc">:</span><span class="dv">2009</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-11"><a href="generating-temperature-scenarios.html#cb181-11" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">Data_source =</span> <span class="st">&quot;observed&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-12"><a href="generating-temperature-scenarios.html#cb181-12" tabindex="-1"></a>  <span class="fu">rbind</span>(</span>
<span id="cb181-13"><a href="generating-temperature-scenarios.html#cb181-13" tabindex="-1"></a>    Temp[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(Year, Month, Day, Tmin, Tmax)) <span class="sc">%&gt;%</span> </span>
<span id="cb181-14"><a href="generating-temperature-scenarios.html#cb181-14" tabindex="-1"></a>      <span class="fu">cbind</span>(<span class="at">Data_source =</span> <span class="st">&quot;simulated&quot;</span>)</span>
<span id="cb181-15"><a href="generating-temperature-scenarios.html#cb181-15" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb181-16"><a href="generating-temperature-scenarios.html#cb181-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">ISOdate</span>(<span class="dv">2000</span>, Month, Day)))</span></code></pre></div>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="generating-temperature-scenarios.html#cb182-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Temperatures,</span>
<span id="cb182-2"><a href="generating-temperature-scenarios.html#cb182-2" tabindex="-1"></a>       <span class="fu">aes</span>(Date,</span>
<span id="cb182-3"><a href="generating-temperature-scenarios.html#cb182-3" tabindex="-1"></a>           Tmin)) <span class="sc">+</span></span>
<span id="cb182-4"><a href="generating-temperature-scenarios.html#cb182-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(Year))) <span class="sc">+</span></span>
<span id="cb182-5"><a href="generating-temperature-scenarios.html#cb182-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Data_source)) <span class="sc">+</span></span>
<span id="cb182-6"><a href="generating-temperature-scenarios.html#cb182-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb182-7"><a href="generating-temperature-scenarios.html#cb182-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb182-8"><a href="generating-temperature-scenarios.html#cb182-8" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">&quot;%b&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-235-1.png" width="672" /></p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="generating-temperature-scenarios.html#cb183-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Temperatures,</span>
<span id="cb183-2"><a href="generating-temperature-scenarios.html#cb183-2" tabindex="-1"></a>       <span class="fu">aes</span>(Date,</span>
<span id="cb183-3"><a href="generating-temperature-scenarios.html#cb183-3" tabindex="-1"></a>           Tmax)) <span class="sc">+</span></span>
<span id="cb183-4"><a href="generating-temperature-scenarios.html#cb183-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(Year))) <span class="sc">+</span></span>
<span id="cb183-5"><a href="generating-temperature-scenarios.html#cb183-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Data_source)) <span class="sc">+</span></span>
<span id="cb183-6"><a href="generating-temperature-scenarios.html#cb183-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb183-7"><a href="generating-temperature-scenarios.html#cb183-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb183-8"><a href="generating-temperature-scenarios.html#cb183-8" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">&quot;%b&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-236-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li><em>Calculate winter chill (in Chill Portions) for your synthetic weather, and illustrate your results as histograms and cumulative distributions.</em></li>
</ol>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="generating-temperature-scenarios.html#cb184-1" tabindex="-1"></a>chill_observed <span class="ot">&lt;-</span> Temperatures <span class="sc">%&gt;%</span></span>
<span id="cb184-2"><a href="generating-temperature-scenarios.html#cb184-2" tabindex="-1"></a>  <span class="fu">filter</span>(Data_source <span class="sc">==</span> <span class="st">&quot;observed&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb184-3"><a href="generating-temperature-scenarios.html#cb184-3" tabindex="-1"></a>  <span class="fu">stack_hourly_temps</span>(<span class="at">latitude =</span> <span class="fl">46.6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb184-4"><a href="generating-temperature-scenarios.html#cb184-4" tabindex="-1"></a>  <span class="fu">chilling</span>(<span class="at">Start_JDay =</span> <span class="dv">305</span>,</span>
<span id="cb184-5"><a href="generating-temperature-scenarios.html#cb184-5" tabindex="-1"></a>           <span class="at">End_JDay =</span> <span class="dv">59</span>)</span>
<span id="cb184-6"><a href="generating-temperature-scenarios.html#cb184-6" tabindex="-1"></a>  </span>
<span id="cb184-7"><a href="generating-temperature-scenarios.html#cb184-7" tabindex="-1"></a>chill_simulated <span class="ot">&lt;-</span> Temperatures <span class="sc">%&gt;%</span></span>
<span id="cb184-8"><a href="generating-temperature-scenarios.html#cb184-8" tabindex="-1"></a>  <span class="fu">filter</span>(Data_source <span class="sc">==</span> <span class="st">&quot;simulated&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb184-9"><a href="generating-temperature-scenarios.html#cb184-9" tabindex="-1"></a>  <span class="fu">stack_hourly_temps</span>(<span class="at">latitude =</span> <span class="fl">46.6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb184-10"><a href="generating-temperature-scenarios.html#cb184-10" tabindex="-1"></a>  <span class="fu">chilling</span>(<span class="at">Start_JDay =</span> <span class="dv">305</span>,</span>
<span id="cb184-11"><a href="generating-temperature-scenarios.html#cb184-11" tabindex="-1"></a>           <span class="at">End_JDay =</span> <span class="dv">59</span>)</span>
<span id="cb184-12"><a href="generating-temperature-scenarios.html#cb184-12" tabindex="-1"></a>  </span>
<span id="cb184-13"><a href="generating-temperature-scenarios.html#cb184-13" tabindex="-1"></a>chill_comparison <span class="ot">&lt;-</span></span>
<span id="cb184-14"><a href="generating-temperature-scenarios.html#cb184-14" tabindex="-1"></a>  <span class="fu">cbind</span>(chill_observed,</span>
<span id="cb184-15"><a href="generating-temperature-scenarios.html#cb184-15" tabindex="-1"></a>        <span class="at">Data_source =</span> <span class="st">&quot;observed&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb184-16"><a href="generating-temperature-scenarios.html#cb184-16" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">cbind</span>(chill_simulated,</span>
<span id="cb184-17"><a href="generating-temperature-scenarios.html#cb184-17" tabindex="-1"></a>              <span class="at">Data_source =</span> <span class="st">&quot;simulated&quot;</span>))</span>
<span id="cb184-18"><a href="generating-temperature-scenarios.html#cb184-18" tabindex="-1"></a>  </span>
<span id="cb184-19"><a href="generating-temperature-scenarios.html#cb184-19" tabindex="-1"></a>chill_comparison_full_seasons <span class="ot">&lt;-</span> </span>
<span id="cb184-20"><a href="generating-temperature-scenarios.html#cb184-20" tabindex="-1"></a>  chill_comparison <span class="sc">%&gt;%</span></span>
<span id="cb184-21"><a href="generating-temperature-scenarios.html#cb184-21" tabindex="-1"></a>  <span class="fu">filter</span>(Perc_complete <span class="sc">==</span> <span class="dv">100</span>)</span></code></pre></div>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="generating-temperature-scenarios.html#cb185-1" tabindex="-1"></a><span class="fu">ggplot</span>(chill_comparison_full_seasons,</span>
<span id="cb185-2"><a href="generating-temperature-scenarios.html#cb185-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Chill_portions)) <span class="sc">+</span> </span>
<span id="cb185-3"><a href="generating-temperature-scenarios.html#cb185-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>,</span>
<span id="cb185-4"><a href="generating-temperature-scenarios.html#cb185-4" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(Data_source))) <span class="sc">+</span></span>
<span id="cb185-5"><a href="generating-temperature-scenarios.html#cb185-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb185-6"><a href="generating-temperature-scenarios.html#cb185-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Data source&quot;</span>) <span class="sc">+</span></span>
<span id="cb185-7"><a href="generating-temperature-scenarios.html#cb185-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Chill accumulation (Chill Portions)&quot;</span>) <span class="sc">+</span></span>
<span id="cb185-8"><a href="generating-temperature-scenarios.html#cb185-8" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-238-1.png" width="672" /></p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="generating-temperature-scenarios.html#cb186-1" tabindex="-1"></a>chill_simulations <span class="ot">&lt;-</span></span>
<span id="cb186-2"><a href="generating-temperature-scenarios.html#cb186-2" tabindex="-1"></a>  chill_comparison_full_seasons <span class="sc">%&gt;%</span></span>
<span id="cb186-3"><a href="generating-temperature-scenarios.html#cb186-3" tabindex="-1"></a>  <span class="fu">filter</span>(Data_source <span class="sc">==</span> <span class="st">&quot;simulated&quot;</span>)</span>
<span id="cb186-4"><a href="generating-temperature-scenarios.html#cb186-4" tabindex="-1"></a>  </span>
<span id="cb186-5"><a href="generating-temperature-scenarios.html#cb186-5" tabindex="-1"></a><span class="fu">ggplot</span>(chill_simulations,</span>
<span id="cb186-6"><a href="generating-temperature-scenarios.html#cb186-6" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Chill_portions)) <span class="sc">+</span></span>
<span id="cb186-7"><a href="generating-temperature-scenarios.html#cb186-7" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">&quot;step&quot;</span>,</span>
<span id="cb186-8"><a href="generating-temperature-scenarios.html#cb186-8" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="fl">1.5</span>,</span>
<span id="cb186-9"><a href="generating-temperature-scenarios.html#cb186-9" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb186-10"><a href="generating-temperature-scenarios.html#cb186-10" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Cumulative probability&quot;</span>) <span class="sc">+</span></span>
<span id="cb186-11"><a href="generating-temperature-scenarios.html#cb186-11" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Chill accumulation (in Chill Portions)&quot;</span>) <span class="sc">+</span></span>
<span id="cb186-12"><a href="generating-temperature-scenarios.html#cb186-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-239-1.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li><em>Produce similar plots for the number of freezing hours (&lt;0°C) in April (or October, if your site is in the Southern Hemisphere) for your location of interest</em></li>
</ol>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="generating-temperature-scenarios.html#cb187-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb187-2"><a href="generating-temperature-scenarios.html#cb187-2" tabindex="-1"></a>  <span class="at">lower =</span>  <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000</span>,    <span class="dv">0</span>),</span>
<span id="cb187-3"><a href="generating-temperature-scenarios.html#cb187-3" tabindex="-1"></a>  <span class="at">upper =</span>  <span class="fu">c</span>(    <span class="dv">0</span>, <span class="dv">1000</span>),</span>
<span id="cb187-4"><a href="generating-temperature-scenarios.html#cb187-4" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">c</span>(    <span class="dv">1</span>,    <span class="dv">0</span>))</span>
<span id="cb187-5"><a href="generating-temperature-scenarios.html#cb187-5" tabindex="-1"></a></span>
<span id="cb187-6"><a href="generating-temperature-scenarios.html#cb187-6" tabindex="-1"></a>freezing_hours <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">step_model</span>(x,df)</span>
<span id="cb187-7"><a href="generating-temperature-scenarios.html#cb187-7" tabindex="-1"></a></span>
<span id="cb187-8"><a href="generating-temperature-scenarios.html#cb187-8" tabindex="-1"></a>chill_observed <span class="ot">&lt;-</span> Temperatures <span class="sc">%&gt;%</span></span>
<span id="cb187-9"><a href="generating-temperature-scenarios.html#cb187-9" tabindex="-1"></a>  <span class="fu">filter</span>(Data_source <span class="sc">==</span> <span class="st">&quot;observed&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb187-10"><a href="generating-temperature-scenarios.html#cb187-10" tabindex="-1"></a>  <span class="fu">stack_hourly_temps</span>(<span class="at">latitude =</span> <span class="fl">46.6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb187-11"><a href="generating-temperature-scenarios.html#cb187-11" tabindex="-1"></a>  <span class="fu">tempResponse</span>(<span class="at">Start_JDay =</span> <span class="dv">91</span>,</span>
<span id="cb187-12"><a href="generating-temperature-scenarios.html#cb187-12" tabindex="-1"></a>               <span class="at">End_JDay =</span> <span class="dv">120</span>,</span>
<span id="cb187-13"><a href="generating-temperature-scenarios.html#cb187-13" tabindex="-1"></a>               <span class="at">models =</span> <span class="fu">list</span>(<span class="at">Frost =</span> freezing_hours,</span>
<span id="cb187-14"><a href="generating-temperature-scenarios.html#cb187-14" tabindex="-1"></a>                             <span class="at">Chill_portions =</span> Dynamic_Model,</span>
<span id="cb187-15"><a href="generating-temperature-scenarios.html#cb187-15" tabindex="-1"></a>                             <span class="at">GDH =</span> GDH))</span>
<span id="cb187-16"><a href="generating-temperature-scenarios.html#cb187-16" tabindex="-1"></a></span>
<span id="cb187-17"><a href="generating-temperature-scenarios.html#cb187-17" tabindex="-1"></a>chill_simulated <span class="ot">&lt;-</span> Temperatures <span class="sc">%&gt;%</span></span>
<span id="cb187-18"><a href="generating-temperature-scenarios.html#cb187-18" tabindex="-1"></a>  <span class="fu">filter</span>(Data_source <span class="sc">==</span> <span class="st">&quot;simulated&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb187-19"><a href="generating-temperature-scenarios.html#cb187-19" tabindex="-1"></a>  <span class="fu">stack_hourly_temps</span>(<span class="at">latitude =</span> <span class="fl">46.6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb187-20"><a href="generating-temperature-scenarios.html#cb187-20" tabindex="-1"></a>  <span class="fu">tempResponse</span>(<span class="at">Start_JDay =</span> <span class="dv">91</span>,</span>
<span id="cb187-21"><a href="generating-temperature-scenarios.html#cb187-21" tabindex="-1"></a>               <span class="at">End_JDay =</span> <span class="dv">120</span>,</span>
<span id="cb187-22"><a href="generating-temperature-scenarios.html#cb187-22" tabindex="-1"></a>               <span class="at">models=</span><span class="fu">list</span>(<span class="at">Frost =</span> freezing_hours,</span>
<span id="cb187-23"><a href="generating-temperature-scenarios.html#cb187-23" tabindex="-1"></a>                           <span class="at">Chill_portions =</span> Dynamic_Model,</span>
<span id="cb187-24"><a href="generating-temperature-scenarios.html#cb187-24" tabindex="-1"></a>                           <span class="at">GDH =</span> GDH))</span>
<span id="cb187-25"><a href="generating-temperature-scenarios.html#cb187-25" tabindex="-1"></a></span>
<span id="cb187-26"><a href="generating-temperature-scenarios.html#cb187-26" tabindex="-1"></a>chill_comparison <span class="ot">&lt;-</span></span>
<span id="cb187-27"><a href="generating-temperature-scenarios.html#cb187-27" tabindex="-1"></a>  <span class="fu">cbind</span>(chill_observed,</span>
<span id="cb187-28"><a href="generating-temperature-scenarios.html#cb187-28" tabindex="-1"></a>        <span class="at">Data_source =</span> <span class="st">&quot;observed&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb187-29"><a href="generating-temperature-scenarios.html#cb187-29" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">cbind</span>(chill_simulated,</span>
<span id="cb187-30"><a href="generating-temperature-scenarios.html#cb187-30" tabindex="-1"></a>              <span class="at">Data_source =</span> <span class="st">&quot;simulated&quot;</span>))</span>
<span id="cb187-31"><a href="generating-temperature-scenarios.html#cb187-31" tabindex="-1"></a></span>
<span id="cb187-32"><a href="generating-temperature-scenarios.html#cb187-32" tabindex="-1"></a>chill_comparison_full_seasons <span class="ot">&lt;-</span></span>
<span id="cb187-33"><a href="generating-temperature-scenarios.html#cb187-33" tabindex="-1"></a>  chill_comparison <span class="sc">%&gt;%</span></span>
<span id="cb187-34"><a href="generating-temperature-scenarios.html#cb187-34" tabindex="-1"></a>  <span class="fu">filter</span>(Perc_complete <span class="sc">==</span> <span class="dv">100</span>)</span></code></pre></div>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="generating-temperature-scenarios.html#cb188-1" tabindex="-1"></a><span class="fu">ggplot</span>(chill_comparison_full_seasons,</span>
<span id="cb188-2"><a href="generating-temperature-scenarios.html#cb188-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Frost)) <span class="sc">+</span> </span>
<span id="cb188-3"><a href="generating-temperature-scenarios.html#cb188-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">25</span>,</span>
<span id="cb188-4"><a href="generating-temperature-scenarios.html#cb188-4" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(Data_source))) <span class="sc">+</span></span>
<span id="cb188-5"><a href="generating-temperature-scenarios.html#cb188-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb188-6"><a href="generating-temperature-scenarios.html#cb188-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Data source&quot;</span>) <span class="sc">+</span></span>
<span id="cb188-7"><a href="generating-temperature-scenarios.html#cb188-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Frost incidence during April (hours)&quot;</span>) <span class="sc">+</span></span>
<span id="cb188-8"><a href="generating-temperature-scenarios.html#cb188-8" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-241-1.png" width="672" /></p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="generating-temperature-scenarios.html#cb189-1" tabindex="-1"></a>chill_simulations <span class="ot">&lt;-</span></span>
<span id="cb189-2"><a href="generating-temperature-scenarios.html#cb189-2" tabindex="-1"></a>  chill_comparison_full_seasons <span class="sc">%&gt;%</span></span>
<span id="cb189-3"><a href="generating-temperature-scenarios.html#cb189-3" tabindex="-1"></a>  <span class="fu">filter</span>(Data_source <span class="sc">==</span> <span class="st">&quot;simulated&quot;</span>)</span>
<span id="cb189-4"><a href="generating-temperature-scenarios.html#cb189-4" tabindex="-1"></a></span>
<span id="cb189-5"><a href="generating-temperature-scenarios.html#cb189-5" tabindex="-1"></a><span class="fu">ggplot</span>(chill_simulations,</span>
<span id="cb189-6"><a href="generating-temperature-scenarios.html#cb189-6" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Frost)) <span class="sc">+</span></span>
<span id="cb189-7"><a href="generating-temperature-scenarios.html#cb189-7" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">&quot;step&quot;</span>,</span>
<span id="cb189-8"><a href="generating-temperature-scenarios.html#cb189-8" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="fl">1.5</span>,</span>
<span id="cb189-9"><a href="generating-temperature-scenarios.html#cb189-9" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb189-10"><a href="generating-temperature-scenarios.html#cb189-10" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Cumulative probability&quot;</span>) <span class="sc">+</span></span>
<span id="cb189-11"><a href="generating-temperature-scenarios.html#cb189-11" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Frost incidence during April (hours)&quot;</span>) <span class="sc">+</span></span>
<span id="cb189-12"><a href="generating-temperature-scenarios.html#cb189-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-242-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="filling-gaps-in-temperature-records.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="saving-and-loading-data-and-hiding-this-in-markdown.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jacqwng/Logbook/edit/main/12-generate-temp.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jacqwng/Logbook/blob/main/12-generate-temp.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
